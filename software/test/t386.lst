Sections:
00: ".pgtbl" (0-A)
01: ".bss" (0-A)
02: ".data" (0-A)
03: ".rodata" (0-6)
04: ".text" (0-185A)


Source: "t386.asm"
                      	     1: # t386.asm rf386 cpu test
                      	     2: # Port to vasm standard syntax including mods.
                      	     3: # (c) 2024 Robert Finch <robfinch@finitron.ca>
                      	     4: #
                      	     5: # Original work from test386.asm
                      	     6: #   Copyright (C) 2012-2015 Jeff Parsons <Jeff@pcjs.org>
                      	     7: #   Copyright (C) 2017-2021 Marco Bortolin <barotto@gmail.com>
                      	     8: #
                      	     9: #   This file is a derivative work of PCjs
                      	    10: #   https://www.pcjs.org/software/pcx86/test/cpu/80386/test386.asm
                      	    11: #
                      	    12: #   test386.asm is free software: you can redistribute it and/or modify it under
                      	    13: #   the terms of the GNU General Public License as published by the Free
                      	    14: #   Software Foundation, either version 3 of the License, or (at your option)
                      	    15: #   any later version.
                      	    16: #
                      	    17: #   test386.asm is distributed in the hope that it will be useful, but WITHOUT ANY
                      	    18: #   WARRANTY without even the implied warranty of MERCHANTABILITY or FITNESS
                      	    19: #   FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
                      	    20: #   details.
                      	    21: #
                      	    22: #   You should have received a copy of the GNU General Public License along with
                      	    23: #   test386.asm.  If not see <http://www.gnu.org/licenses/gpl.html>.
                      	    24: #
                      	    25: #   This program was originally developed for IBMulator
                      	    26: #   https://barotto.github.io/IBMulator
                      	    27: #
                      	    28: #   Overview
                      	    29: #   --------
                      	    30: #   This file is designed to run as a test ROM, loaded in place of the BIOS.
                      	    31: #   Its pourpose is to test the CPU, reporting its status to the POST port and
                      	    32: #   its computational results in ASCII form to various configurable ports.
                      	    33: #   A 80386 or later CPU is required. This ROM is designed to test an emulator
                      	    34: #   CPU and was never tested on real hardware.
                      	    35: #
                      	    36: #   It must be installed at physical address 0xffff0000 and aliased at physical
                      	    37: #   address 0xffff0000.  The jump at resetVector should align with the CPU reset
                      	    38: #   address 0xfffffff0, which will transfer control to f000:0045.  From that
                      	    39: #   point on, all memory accesses should remain within the first 1MB.
                      	    40: #
                      	    41: 
                      	    42: #
                      	    43: # WARNING
                      	    44: #
                      	    45: #   A word of caution before you start developing.
                      	    46: #   NASM (2.11.08) generates [ebp + ebp] for [ebp*2] (i.e. no base register),
                      	    47: #   which are not the same thing: [ebp+ebp] references the SS segment, [ebp*2]
                      	    48: #   references the DS segment.
                      	    49: #   NASM developers think [ebp*2] and [ebp+ebp] are the same, but that is true
                      	    50: #   only assuming a flat memory model. Until the time NASM authors realize their
                      	    51: #   mistake (any assumption of a flat memory model should be optional), you can
                      	    52: #   disable this behaviour by writing: [nosplit ebp*2].
                      	    53: #
                      	    54: #	NASM Assembly            Translated               Assembled
                      	    55: #	mov eax,[ebp*2]          mov eax,[ebp+ebp*1+0x0]  8B442D00
                      	    56: #	mov eax,[nosplit ebp*2]  mov eax,[ebp*2+0x0]      8B046D00000000
                      	    57: #
                      	    58: 
                      	    59: .macro cpyright
                      	    60: 	.ascii "t386.asm (c) 2024 Robert Finch (C) 2012-2015 Jeff Parsons, (C) 2017-2021 Marco Bortolin ",0
                      	    61: .endm
                      	    62: .macro RELEASE
                      	    63: 	.ascii "??/??/24",0
                      	    64: .endm
                      	    65: 
                      	    66: 	.set POST_PORT,0x190
                      	    67: 
                      	    68: #
                      	    69: # memory map:
                      	    70: #  FFF80000-FFF8FFFF page table
                      	    71: #  FFF90000-FFF903FF real mode IDT
                      	    72: #  FFF90400-FFF904FF protected mode IDT
                      	    73: #  FFF90500-FFF9077F protected mode GDT
                      	    74: #  FFF90800-FFF90FFF protected mode LDT
                      	    75: #  FFFA0000-FFFAFFFF read only data
                      	    76: #  FFFC0000-FFFCFFFF stack
                      	    77: #  FFF01000-FFF01FFF page directory
                      	    78: #  FFF94000-FFF94FFF TSS
                      	    79: #  20000-9FFFF tests
                      	    80: #
                      	    81: 
                      	    82: .set realmd_mask,0x0000ffff
                      	    83: .set rodata_seg,0x0fffa000
                      	    84: .set start_rodata,0xfffa0000
                      	    85: .set TEST_BASE,0xFFFC0000
                      	    86: .set TEST_BASE1,TEST_BASE+0x0000
                      	    87: .set TEST_BASE2,TEST_BASE+0x2000
                      	    88: 
                      	    89: 	.section .pgtbl
00:00000000 00        	    90: 	.space 10
00:00000001 *
                      	    91: 
                      	    92: 	.bss
01:00000000 00        	    93: 	.space	10
01:00000001 *
                      	    94: 
                      	    95: 	.data
02:00000000 00        	    96: 	.space	10
02:00000001 *
                      	    97: 
                      	    98: 	.rodata
                      	    99: idt_addr:
03:00000000 0004      	   100: 	.2byte 0x400
03:00000002 0000F9FF  	   101: 	.4byte 0xFFF90000		# Linear address of table
                      	   102: 
                      	   103: #	.org	0xF0000
                      	   104: 	.text
                      	   105: 	.code16
                      	   106: #	.align	0
                      	   107: .extern	_bootrom
                      	   108: .extern _Fibonacci
                      	   109: 
                      	   110: #
                      	   111: #   Real mode segments
                      	   112: #
                      	   113: .set C_SEG_REAL,0x0000
                      	   114: .set S_SEG_REAL,0xC000
                      	   115: .set IDT_SEG_REAL,0x9000
                      	   116: .set IDT_SEG_PROT,0x9040
                      	   117: .set GDT_SEG_REAL,0x9050
                      	   118: .set GDT_SEG_LIMIT,0x2FF
                      	   119: .set D1_SEG_REAL,TEST_BASE1 >> 4
                      	   120: .set D2_SEG_REAL,TEST_BASE2 >> 4
                      	   121: 
                      	   122: .set ESP_REAL,0x7ffc
                      	   123: 
                      	   124: 
                      	   125: .include "x86_e.asm"

Source: "x86_e.asm"
                      	     1: .set PS_CF,0x0001
                      	     2: .set PS_PF,0x0004
                      	     3: .set PS_AF,0x0010
                      	     4: .set PS_ZF,0x0040
                      	     5: .set PS_SF,0x0080
                      	     6: .set PS_TF,0x0100
                      	     7: .set PS_IF,0x0200
                      	     8: .set PS_DF,0x0400
                      	     9: .set PS_OF,0x0800
                      	    10: .set PS_ARITH,(PS_CF | PS_PF | PS_AF | PS_ZF | PS_SF | PS_OF)
                      	    11: .set PS_LOGIC,(PS_CF | PS_PF | PS_ZF | PS_SF | PS_OF)
                      	    12: .set PS_MULTIPLY,(PS_CF | PS_OF) # only CF and OF are "defined" following MUL or IMUL
                      	    13: .set PS_DIVIDE,0 # none of the Processor Status flags are "defined" following DIV or IDIV
                      	    14: .set PS_SHIFTS_1,(PS_CF | PS_SF | PS_ZF | PS_PF | PS_OF)
                      	    15: .set PS_SHIFTS_R,(PS_CF | PS_SF | PS_ZF | PS_PF)
                      	    16: 
                      	    17: .set CR0_MSW_PE,0x0001
                      	    18: .set CR0_PG,0x80000000	# set if paging enabled
                      	    19: 
                      	    20: .set ACC_TYPE_GATE386_INT,0x0E00
                      	    21: .set ACC_TYPE_GATE386_CALL,0x0C00
                      	    22: .set ACC_TYPE_SEG,0x1000
                      	    23: .set ACC_PRESENT,0x8000
                      	    24: .set ACC_TYPE_CODE_R,0x1a00
                      	    25: .set ACC_TYPE_CONFORMING,0x0400
                      	    26: .set ACC_TYPE_DATA_R,0x1000
                      	    27: .set ACC_TYPE_DATA_W,0x1200
                      	    28: .set ACC_TYPE_LDT,0x0200
                      	    29: .set ACC_TYPE_TSS,0x0900
                      	    30: 
                      	    31: .set ACC_DPL_0,0x0000
                      	    32: .set ACC_DPL_1,0x2000
                      	    33: .set ACC_DPL_2,0x4000
                      	    34: .set ACC_DPL_3,0x6000
                      	    35: 
                      	    36: .set EXT_NONE,0x0000
                      	    37: .set EXT_16BIT,EXT_NONE
                      	    38: .set EXT_32BIT,0x0040 # size bit
                      	    39: .set EXT_PAGE,0x0080 # granularity bit
                      	    40: 
                      	    41: #PTE_FRAME     equ 0xfffff000
                      	    42: #PTE_DIRTY     equ 0x00000040 ; page has been modified
                      	    43: #PTE_ACCESSED  equ 0x00000020 ; page has been accessed
                      	    44: #PTE_USER      equ 0x00000004 ; set for user level (CPL 3), clear for supervisor level (CPL 0-2)
                      	    45: #PTE_WRITE     equ 0x00000002 ; set for read/write, clear for read-only (affects CPL 3 only)
                      	    46: #PTE_PRESENT   equ 0x00000001 ; set for present page, clear for not-present page
                      	    47: 
                      	    48: #PTE_PRESENT_BIT   equ 0000001b
                      	    49: #PTE_WRITE_BIT     equ 0000010b
                      	    50: #PTE_USER_BIT      equ 0000100b
                      	    51: #PTE_ACCESSED_BIT  equ 0100000b
                      	    52: #PTE_DIRTY_BIT     equ 1000000b
                      	    53: 
                      	    54: .set EX_DE,0
                      	    55: .set EX_DB,1
                      	    56: .set EX_BP,3
                      	    57: .set EX_OF,4
                      	    58: .set EX_BR,5
                      	    59: .set EX_UD,6
                      	    60: .set EX_NM,7
                      	    61: .set EX_DF,8
                      	    62: .set EX_MP,9
                      	    63: .set EX_TS,10
                      	    64: .set EX_NP,11
                      	    65: .set EX_SS,12
                      	    66: .set EX_GP,13
                      	    67: .set EX_PF,14
                      	    68: .set EX_MF,15
                      	    69: 

Source: "t386.asm"
                      	   126: .include "macros_m.asm"

Source: "macros_m.asm"
                      	     1: #
                      	     2: #   Output a byte to the POST port, destroys al and dx
                      	     3: #
                      	     4: .macro POST arg1
                      	     5: 	movb \arg1,%al
                      	     6: 	movw $POST_PORT,%dx
                      	     7: 	out %al,%dx
                      	     8: .endm
                      	     9: 
                      	    10: #
                      	    11: # Initializes an interrupt gate in system memory.
                      	    12: # This is the body of procedures used in 16 and 32-bit code segments.
                      	    13: #
                      	    14: #    7                             0 7                             0
                      	    15: #   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•â•â
                      	    16: # +7â•‘                          OFFSET 31-16                         â•‘+6
                      	    17: #   â•Ÿâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â
                      	    18: # +5â•‘ P â”‚  DPL  â”‚ 0 â”‚ 1   1   1   0 â”‚            UNUSED             â•‘+4
                      	    19: #   â•Ÿâ”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â
                      	    20: # +3â•‘                           SELECTOR                            â•‘+2
                      	    21: #   â•Ÿâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â
                      	    22: # +1â•‘                          OFFSET 15-0                          â•‘ 0
                      	    23: #   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â
                      	    24: #    15                                                            0
                      	    25: #
                      	    26: # DS:EBX pointer to IDT
                      	    27: # EAX vector
                      	    28: # ESI selector
                      	    29: # EDI offset
                      	    30: # DX DPL (use ACC_DPL_* equs)
                      	    31: #
                      	    32: .macro initIntGate
                      	    33: 	shl $3,%eax
                      	    34: 	add	%eax,%ebx
                      	    35: 	movw %di,(%ebx)
                      	    36: 	movw %si,2(%ebx)
                      	    37: 	orw $ACC_TYPE_GATE386_INT | ACC_PRESENT, %dx
                      	    38: 	movw %dx,4(%ebx)
                      	    39: 	shr $16,%edi
                      	    40: 	movw %di,6(%ebx)
                      	    41: .endm
                      	    42: 
                      	    43: #
                      	    44: # Set a descriptor in system memory.
                      	    45: # This is the body of procedures used in 16 and 32-bit code segments.
                      	    46: #
                      	    47: #    7                             0 7                             0
                      	    48: #   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¤â•â•â•â•¤â•â
                      	    49: # +7â•‘            BASE 31-24         â”‚ G â”‚B/Dâ”‚ 0 â”‚AVLâ”‚  LIMIT 19-16  â•‘+6
                      	    50: #   â•Ÿâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¼â”€â”€â”€â”´â”€â
                      	    51: # +5â•‘ P â”‚  DPL  â”‚ S â”‚    TYPE    (A)â”‚          BASE 23-16           â•‘+4
                      	    52: #   â•Ÿâ”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â
                      	    53: # +3â•‘                           BASE 15-0                           â•‘+2
                      	    54: #   â•Ÿâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â
                      	    55: # +1â•‘                           LIMIT 15-0                          â•‘ 0
                      	    56: #   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â
                      	    57: #    15                                                            0
                      	    58: #
                      	    59: # DS:EBX pointer to the descriptor table
                      	    60: # EAX segment selector
                      	    61: # ESI base
                      	    62: # EDI limit
                      	    63: # DL ext nibble (upper 4 bits)
                      	    64: # DH acc byte (P|DPL|S|TYPE|A)
                      	    65: #
                      	    66: .macro initDescriptor
                      	    67: 	and $0xFFF8,%eax
                      	    68: 	add %eax,%ebx
                      	    69: 	movw %di,(%ebx)						# LIMIT 15-0
                      	    70: 	movw %si,2(%ebx)					# BASE 15-0
                      	    71: 	shr $16,%esi
                      	    72: 	mov %si,%ax								# AX := BASE 31-16
                      	    73: 	movb %al,4(%ebx)					# BASE 23-16
                      	    74: 	movb %dh,5(%ebx)					# acc byte
                      	    75: 	shr $16,%edi
                      	    76: 	mov %di,%cx
                      	    77: 	and $0x0f,%cl
                      	    78: 	movb %cl,6(%ebx)					# LIMIT 19-16
                      	    79: 	and $0xf0,%dl
                      	    80: 	orb %dl,6(%ebx)						# ext nybble
                      	    81: 	movb %ah,7(%ebx)					# BASE 31-24
                      	    82: .endm
                      	    83: 
                      	    84: 
                      	    85: .macro advTestBase
                      	    86: 	.set TEST_BASE1,TEST_BASE1+0x1000
                      	    87: 	.set TEST_BASE2,TEST_BASE2+0x1000
                      	    88: .endm
                      	    89: 

Source: "t386.asm"
                      	   127: .include "shift_m.asm"

Source: "shift_m.asm"
                      	     1: #
                      	     2: #   Executes a byte shift operation and checks the resulting flags.
                      	     3: #
                      	     4: #   %1 operation
                      	     5: #   %2 al: byte operand
                      	     6: #   %3 cl: shift count
                      	     7: #   %4 flags: value of flags before %1 execution
                      	     8: #   %5 flags: expected value of flags after %1 execution (cmp with PS_ARITH mask)
                      	     9: #
                      	    10: #   Uses: AX, CL, Flags
                      	    11: #
                      	    12: 
                      	    13: .macro testShiftBFlags arg1,arg2,arg3,arg4,arg5
                      	    14: 	mov \arg4,%ax
                      	    15: 	push %ax
                      	    16: 	popf
                      	    17: 	mov $0xff,%ah
                      	    18: 	mov \arg2,%al
                      	    19: 	mov \arg3,%cl
                      	    20: 	\arg1 %cl,%al
                      	    21: 	pushf
                      	    22: 	pop %ax
                      	    23: 	and $PS_ARITH,%ax
                      	    24: 	cmp \arg5,%ax
                      	    25: 	jne error
                      	    26: .endm
                      	    27: 
                      	    28: #
                      	    29: #   Executes a word shift operation and checks the resulting flags.
                      	    30: #
                      	    31: #   %1 operation
                      	    32: #   %2 ax: word operand
                      	    33: #   %3 cl: shift count
                      	    34: #   %4 flags: value of flags before %1 execution
                      	    35: #   %5 flags: expected value of flags after %1 execution (cmp with PS_ARITH mask)
                      	    36: #
                      	    37: #   Uses: AX, CL, Flags
                      	    38: #
                      	    39: .macro testShiftWFlags arg1,arg2,arg3,arg4,arg5
                      	    40: 	mov \arg4,%ax
                      	    41: 	push %ax
                      	    42: 	popf
                      	    43: 	mov \arg2,%ax
                      	    44: 	mov \arg3,%cl
                      	    45: 	\arg1 %cl,%ax
                      	    46: 	pushf
                      	    47: 	pop %ax
                      	    48: 	and $PS_ARITH,%ax
                      	    49: 	cmp \arg5,%ax
                      	    50: 	jne error
                      	    51: .endm
                      	    52: 

Source: "t386.asm"
                      	   128: 
                      	   129: _start:
04:00000000 EB59      	   130: 	jmp _start1
                      	   131: header:
                      	   132: 	cpyright
04:00000002 743338362E	     1M 	.ascii "t386.asm (c) 2024 Robert Finch (C) 2012-2015 Jeff Parsons, (C) 2017-2021 Marco Bortolin ",0
04:00000007 61736D2028
04:0000000C 6329203230
04:00000011 323420526F
04:00000016 6265727420
04:0000001B 46696E6368
04:00000020 2028432920
04:00000025 323031322D
04:0000002A 3230313520
04:0000002F 4A65666620
04:00000034 506172736F
04:00000039 6E732C2028
04:0000003E 4329203230
04:00000043 31372D3230
04:00000048 3231204D61
04:0000004D 72636F2042
04:00000052 6F72746F6C
04:00000057 696E20
04:0000005A 00
                      	   133: 
                      	   134: _start1:
04:0000005B FA        	   135: 	cli	
                      	   136: # init IDT
                      	   137: #	mov $17,%cx
                      	   138: #	movl $error,%edx
                      	   139: #	movl $0xfff90000,%eax
                      	   140: #	movl $error,%edx
                      	   141: #.aloop:
                      	   142: #	movw %dx,(%eax)
                      	   143: #	movw $0xf000,2(%eax)
                      	   144: ##	movw $error,(,%eax,4)
                      	   145: ##	movw $0xf000,2(,%eax,4)
                      	   146: #	addl $4,%eax
                      	   147: #	loop .aloop
                      	   148: 
                      	   149: #	mov $ESP_REAL,%esp
                      	   150: 
                      	   151: # ==============================================================================
                      	   152: #	Real mode tests
                      	   153: # ==============================================================================
                      	   154: 
                      	   155: .include "real_m.asm"

Source: "real_m.asm"
                      	     1: #
                      	     2: # Advances the base address of data segments used by tests, D1_SEG_REAL and
                      	     3: # D2_SEG_REAL.
                      	     4: #
                      	     5: # Loads DS with D1_SEG_REAL and ES with D2_SEG_REAL.
                      	     6: #
                      	     7: .macro advTestSegReal
                      	     8: 	advTestBase
                      	     9: 	.set D1_SEG_REAL,TEST_BASE1 >> 4
                      	    10: 	.set D2_SEG_REAL,TEST_BASE2 >> 4
                      	    11: 	mov $D1_SEG_REAL,%dx
                      	    12: 	mov %dx,%ds
                      	    13: 	mov $D2_SEG_REAL,%dx
                      	    14: 	mov %dx,%es
                      	    15: .endm
                      	    16: 
                      	    17: #
                      	    18: # Initializes the real mode IDT with C_SEG_REAL:error
                      	    19: # This code is called in real mode.
                      	    20: #
                      	    21: .macro initRealModeIDT
                      	    22: 	mov $IDT_SEG_REAL,%ax
                      	    23: 	mov %ax,%ds
                      	    24: 	xor %di,%di
                      	    25: 	mov $17,%cx
                      	    26: aloop\@:
                      	    27: 	movw $error,(%di)
                      	    28: 	movw $C_SEG_REAL,2(%di)
                      	    29: 	add $4,%di
                      	    30: 	loop aloop\@
                      	    31: .endm
                      	    32: 
                      	    33: 
                      	    34: #
                      	    35: # Exception handling testing in real mode
                      	    36: #
                      	    37: 
                      	    38: # Initialises an exc handler
                      	    39: # %1: vector
                      	    40: # %2: handler IP
                      	    41: # Trashes AX,DS
                      	    42: 
                      	    43: .macro realModeExcInit arg1,arg2
                      	    44: 	mov $IDT_SEG_REAL,%ax
                      	    45: 	mov %ax,%ds
                      	    46: 	movw $\arg2,\arg1*4
                      	    47: 	movw $C_SEG_REAL,\arg1*4+2
                      	    48: .endm
                      	    49: 
                      	    50: # Checks exc result and restores the default handler
                      	    51: # %1: vector
                      	    52: # %2: expected pushed value of IP
                      	    53: # Trashes AX,DS
                      	    54: 
                      	    55: .macro realModeExcCheck arg1,arg2
                      	    56: 	cmp $ESP_REAL-6,%sp
                      	    57: 	jne error
                      	    58: 	cmpw $C_SEG_REAL,%ss:ESP_REAL-4
                      	    59: 	jne error
                      	    60: 	cmpw $\arg2,%ss:ESP_REAL-6
                      	    61: 	jne error
                      	    62: 	mov $0,%ax
                      	    63: 	mov %ax,%ds
                      	    64: 	movw $error,\arg1*4
                      	    65: 	movw $C_SEG_REAL,\arg1*4+2
                      	    66: .endm
                      	    67: 
                      	    68: 
                      	    69: # Tests a fault
                      	    70: # %1: vector
                      	    71: # %2: instruction to execute that causes a fault
                      	    72: 
                      	    73: .macro realModeFaultTest arg1,arg2,arg3
                      	    74: 	realModeExcInit \arg1,continue\@
                      	    75: 	mov $S_SEG_REAL,%ax
                      	    76: 	mov %ax,%ss
                      	    77: 	mov $ESP_REAL,%sp
                      	    78: test\@:
                      	    79: 	\arg2,%\arg3
                      	    80: 	jmp error
                      	    81: continue\@:
                      	    82: 	realModeExcCheck \arg1,test\@
                      	    83: .endm
                      	    84: 

Source: "t386.asm"
                      	   156: #-------------------------------------------------------------------------------
                      	   157: 	POST $0x00
04:0000005C B000      	     1M 	movb $0x00,%al
04:0000005E BA9001    	     2M 	movw $POST_PORT,%dx
04:00000061 EE        	     3M 	out %al,%dx
                      	   158: #-------------------------------------------------------------------------------
                      	   159: #
                      	   160: #   Real mode initialisation
                      	   161: #
04:00000062 B800A0    	   162: 	mov $rodata_seg & realmd_mask,%ax
04:00000065 8ED8      	   163: 	mov %ax,%ds
04:00000067 0F011E0000	   164: 	lidt idt_addr-start_rodata
                      	   165: 	initRealModeIDT
04:0000006C B80090    	     1M 	mov $IDT_SEG_REAL,%ax
04:0000006F 8ED8      	     2M 	mov %ax,%ds
04:00000071 31FF      	     3M 	xor %di,%di
04:00000073 B91100    	     4M 	mov $17,%cx
                      	     5M aloop7:
04:00000076 C7053F18  	     6M 	movw $error,(%di)
04:0000007A C745020000	     7M 	movw $C_SEG_REAL,2(%di)
04:0000007F 83C704    	     8M 	add $4,%di
04:00000082 E2F2      	     9M 	loop aloop7
04:00000084 B800C0    	   166: 	mov $S_SEG_REAL,%ax
04:00000087 8ED0      	   167: 	mov %ax,%ss
04:00000089 BCFC7F    	   168: 	mov $ESP_REAL,%sp
04:0000008C C7C200C0  	   169: 	mov $D1_SEG_REAL,%dx
04:00000090 8EDA      	   170: 	mov %dx,%ds
04:00000092 C7C200C2  	   171: 	mov $D2_SEG_REAL,%dx
04:00000096 8EC2      	   172: 	mov %dx,%es
                      	   173: 
                      	   174: #-------------------------------------------------------------------------------
                      	   175: 	POST $0x01
04:00000098 B001      	     1M 	movb $0x01,%al
04:0000009A BA9001    	     2M 	movw $POST_PORT,%dx
04:0000009D EE        	     3M 	out %al,%dx
                      	   176: #-------------------------------------------------------------------------------
                      	   177: #
                      	   178: #   Conditional jumps
                      	   179: #
                      	   180: .include "jcc_m.asm"

Source: "jcc_m.asm"
                      	     1: #
                      	     2: # Tests conditional relative jumps.
                      	     3: # Uses: AX, ECX, Flags
                      	     4: #
                      	     5: # Opcodes tested, with positive and negative offsets:
                      	     6: #
                      	     7: # rel8  rel16/32 mnemonic condition
                      	     8: # 70    0F80     JO       OF=1
                      	     9: # 71    0F81     JNO      OF=0
                      	    10: # 72    0F82     JC       CF=1
                      	    11: # 73    0F83     JNC      CF=0
                      	    12: # 74    0F84     JZ       ZF=1
                      	    13: # 75    0F85     JNZ      ZF=0
                      	    14: # 76    0F86     JBE      CF=1 || ZF=1
                      	    15: # 77    0F87     JA       CF=0 && ZF=0
                      	    16: # 78    0F88     JS       SF=1
                      	    17: # 79    0F89     JNS      SF=0
                      	    18: # 7A    0F8A     JP       PF=1
                      	    19: # 7B    0F8B     JNP      PF=0
                      	    20: # 7C    0F8C     JL       SF!=OF
                      	    21: # 7D    0F8D     JNL      SF=OF
                      	    22: # 7E    0F8E     JLE      ZF=1 || SF!=OF
                      	    23: # 7F    0F8F     JNLE     ZF=0 && SF=OF
                      	    24: # E3             JCXZ     CX=0
                      	    25: # E3             JECXZ    ECX=0
                      	    26: #
                      	    27: .macro testJcc arg1
                      	    28: 	mov $PS_CF,%ah
                      	    29: 	sahf         # dont use the stack (pushf/popf)
                      	    30: 	jnc err1\@ 	# 73 / 0F83   JNC  CF=0
                      	    31: 	jc jcok\@ 	# 72 / 0F82   JC   CF=1
                      	    32: 	hlt
                      	    33: jz\@:
                      	    34: 	mov $PS_ZF,%ah
                      	    35: 	sahf
                      	    36: 	jnz err1\@ 	# 75 / 0F85   JNZ  ZF=0
                      	    37: 	jz jzok\@ 	# 74 / 0F84   JZ   ZF=1
                      	    38: 	hlt
                      	    39: jp\@:
                      	    40: 	mov $PS_PF,%ah
                      	    41: 	sahf
                      	    42: 	jnp err1\@ 	# 7B / 0F8B   JNP  PF=0
                      	    43: 	jp jpok\@ 	# 7A / 0F8A   JP   PF=1
                      	    44: 	hlt
                      	    45: js\@:
                      	    46: 	mov $PS_SF,%ah
                      	    47: 	sahf
                      	    48: 	jns err1\@ 	# 79 / 0F89   JNS  SF=0
                      	    49: 	js jsok\@ 	# 78 / 0F88   JS   SF=1
                      	    50: 	hlt
                      	    51: jna\@:
                      	    52: 	mov $PS_ZF|PS_CF,%ah
                      	    53: 	sahf
                      	    54: 	ja err1\@  	# 77 / 0F87   JA   CF=0 && ZF=0
                      	    55: 	jna jnaok\@ # 76 / 0F86   JBE  CF=1 || ZF=1
                      	    56: next1\@:
                      	    57: 	jmp jnc\@
                      	    58: 
                      	    59: .if \arg1==16
                      	    60: 	.rept 128
                      	    61: 		hlt
                      	    62: 	.endr
                      	    63: .endif
                      	    64: 
                      	    65: err1\@:
                      	    66: 	hlt
                      	    67: 
                      	    68: # test negative offsets
                      	    69: jcok\@:   jc   jz\@
                      	    70: jzok\@:   jz   jp\@
                      	    71: jpok\@:   jp   js\@
                      	    72: jsok\@:   js   jna\@
                      	    73: jnaok\@:  jna  next1\@
                      	    74: 
                      	    75: 
                      	    76: jnc\@:
                      	    77: 	mov $PS_SF|PS_ZF|PS_AF|PS_PF,%ah
                      	    78: 	sahf
                      	    79: 	mov $0,%ax
                      	    80: 	sahf
                      	    81: 	jnc   jncok\@ # 73 / 0F83   JNC  CF=0
                      	    82: 	hlt
                      	    83: jnz\@:
                      	    84: 	mov $PS_SF|PS_AF|PS_PF|PS_CF,%ah
                      	    85: 	sahf
                      	    86: 	jnz   jnzok\@ # 75 / 0F85   JNZ  ZF=0
                      	    87: 	hlt
                      	    88: jnp\@:
                      	    89: 	mov $PS_SF|PS_ZF|PS_AF|PS_CF,%ah
                      	    90: 	sahf
                      	    91: 	jnp   jnpok\@ # 7B / 0F8B   JNP  PF=0
                      	    92: 	hlt
                      	    93: jns\@:
                      	    94: 	mov $PS_ZF|PS_AF|PS_PF|PS_CF,%ah
                      	    95: 	sahf
                      	    96: 	jns jnsok\@ # 79 /  0F89  JNS  SF=0
                      	    97: 	hlt
                      	    98: ja\@:
                      	    99: 	mov $PS_SF|PS_AF|PS_PF,%ah
                      	   100: 	sahf
                      	   101: 	ja    jaok\@  # 77 / 0F87   JA   CF=0 && ZF=0
                      	   102: 	hlt
                      	   103: next2\@:
                      	   104: 	jmp   jo\@
                      	   105: 
                      	   106: .if \arg1==16
                      	   107: 	.rept 128
                      	   108: 		hlt
                      	   109: 	.endr
                      	   110: .endif
                      	   111: 
                      	   112: # test negative offsets
                      	   113: jncok\@:  jnc  jnz\@
                      	   114: jnzok\@:  jnz  jnp\@
                      	   115: jnpok\@:  jnp  jns\@
                      	   116: jnsok\@:  jns  ja\@
                      	   117: jaok\@:   ja   next2\@
                      	   118: 
                      	   119: jo\@:
                      	   120: 	mov $0,%ah
                      	   121: 	sahf
                      	   122: 	mov $0b1000000,%al
                      	   123: 	shl $1,%al   	# OF = high-order bit of AL <> (CF), ZF=0,SF=1,OF=1
                      	   124: 	jno err2\@
                      	   125: 	jo jook\@
                      	   126: 	hlt
                      	   127: jnl\@:
                      	   128: 	jl err2\@   	# 7C / 0F8C   JL   SF!=OF
                      	   129: 	jnl jnlok\@  	# 7D / 0F8D   JNL  SF=OF
                      	   130: 	hlt
                      	   131: jnle\@:
                      	   132: 	jle err2\@   	# 7E / 0F8E   JLE  ZF=1 || SF!=OF
                      	   133: 	jnle jnleok\@ # 7F / 0F8F   JNLE ZF=0 && SF=OF
                      	   134: 	hlt
                      	   135: jl\@:
                      	   136: 	mov $PS_ZF,%ah
                      	   137: 	sahf          # ZF=1,SF=0,OF=1
                      	   138: 	jl jlok\@   	# 7C / 0F8C   JL   SF!=OF
                      	   139: 	hlt
                      	   140: jle\@:
                      	   141: 	jle jleok\@  	# 7E / 0F8E   JLE  ZF=1 || SF!=OF
                      	   142: 	hlt
                      	   143: jcxz\@:
                      	   144: .if \arg1==8
                      	   145: 	mov $1,%ecx
                      	   146: 	jcxz err2\@      	# E3   JCXZ  CX=0
                      	   147: 	mov $0x10000,%ecx
                      	   148: 	jcxz jcxzok\@
                      	   149: jecxz\@:
                      	   150: 	jecxz err2\@
                      	   151: 	mov $0,%ecx
                      	   152: 	jecxz jecxzok\@ 	# E3   JECXZ   ECX=0
                      	   153: jecxze\@:
                      	   154: .endif
                      	   155: 	jmp exit\@
                      	   156: 
                      	   157: .if \arg1==16
                      	   158: 	.rept 128
                      	   159: 		hlt
                      	   160: 	.endr
                      	   161: .endif
                      	   162: 
                      	   163: err2\@:
                      	   164: 	hlt
                      	   165: 
                      	   166: # test negative offsets
                      	   167: jook\@:   jo   jnl\@
                      	   168: jnlok\@:  jnl  jnle\@
                      	   169: jnleok\@: jnle jl\@
                      	   170: jlok\@:   jl   jle\@
                      	   171: jleok\@:  jle  jcxz\@
                      	   172: .if \arg1==8
                      	   173: jcxzok\@:  jcxz  jecxz\@
                      	   174: jecxzok\@: jecxz jecxze\@
                      	   175: .endif
                      	   176: 
                      	   177: exit\@:
                      	   178: .endm
                      	   179: 

Source: "t386.asm"
                      	   181: 	testJcc 8
04:0000009E B401      	     1M 	mov $PS_CF,%ah
04:000000A0 9E        	     2M 	sahf         # dont use the stack (pushf/popf)
04:000000A1 7324      	     3M 	jnc err110 	# 73 / 0F83   JNC  CF=0
04:000000A3 7223      	     4M 	jc jcok10 	# 72 / 0F82   JC   CF=1
04:000000A5 F4        	     5M 	hlt
                      	     6M jz10:
04:000000A6 B440      	     7M 	mov $PS_ZF,%ah
04:000000A8 9E        	     8M 	sahf
04:000000A9 751C      	     9M 	jnz err110 	# 75 / 0F85   JNZ  ZF=0
04:000000AB 741D      	    10M 	jz jzok10 	# 74 / 0F84   JZ   ZF=1
04:000000AD F4        	    11M 	hlt
                      	    12M jp10:
04:000000AE B404      	    13M 	mov $PS_PF,%ah
04:000000B0 9E        	    14M 	sahf
04:000000B1 7B14      	    15M 	jnp err110 	# 7B / 0F8B   JNP  PF=0
04:000000B3 7A17      	    16M 	jp jpok10 	# 7A / 0F8A   JP   PF=1
04:000000B5 F4        	    17M 	hlt
                      	    18M js10:
04:000000B6 B480      	    19M 	mov $PS_SF,%ah
04:000000B8 9E        	    20M 	sahf
04:000000B9 790C      	    21M 	jns err110 	# 79 / 0F89   JNS  SF=0
04:000000BB 7811      	    22M 	js jsok10 	# 78 / 0F88   JS   SF=1
04:000000BD F4        	    23M 	hlt
                      	    24M jna10:
04:000000BE B441      	    25M 	mov $PS_ZF|PS_CF,%ah
04:000000C0 9E        	    26M 	sahf
04:000000C1 7704      	    27M 	ja err110  	# 77 / 0F87   JA   CF=0 && ZF=0
04:000000C3 760B      	    28M 	jna jnaok10 # 76 / 0F86   JBE  CF=1 || ZF=1
                      	    29M next110:
04:000000C5 EB0B      	    30M 	jmp jnc10
                      	    31M 
                      	    32M .if 8==16
                      	    33M 	.rept 128
                      	    34M 		hlt
                      	    35M 	.endr
                      	    36M .endif
                      	    37M 
                      	    38M err110:
04:000000C7 F4        	    39M 	hlt
                      	    40M 
                      	    41M # test negative offsets
04:000000C8 72DC      	    42M jcok10:   jc   jz10
04:000000CA 74E2      	    43M jzok10:   jz   jp10
04:000000CC 7AE8      	    44M jpok10:   jp   js10
04:000000CE 78EE      	    45M jsok10:   js   jna10
04:000000D0 76F3      	    46M jnaok10:  jna  next110
                      	    47M 
                      	    48M 
                      	    49M jnc10:
04:000000D2 B4D4      	    50M 	mov $PS_SF|PS_ZF|PS_AF|PS_PF,%ah
04:000000D4 9E        	    51M 	sahf
04:000000D5 B80000    	    52M 	mov $0,%ax
04:000000D8 9E        	    53M 	sahf
04:000000D9 731B      	    54M 	jnc   jncok10 # 73 / 0F83   JNC  CF=0
04:000000DB F4        	    55M 	hlt
                      	    56M jnz10:
04:000000DC B495      	    57M 	mov $PS_SF|PS_AF|PS_PF|PS_CF,%ah
04:000000DE 9E        	    58M 	sahf
04:000000DF 7517      	    59M 	jnz   jnzok10 # 75 / 0F85   JNZ  ZF=0
04:000000E1 F4        	    60M 	hlt
                      	    61M jnp10:
04:000000E2 B4D1      	    62M 	mov $PS_SF|PS_ZF|PS_AF|PS_CF,%ah
04:000000E4 9E        	    63M 	sahf
04:000000E5 7B13      	    64M 	jnp   jnpok10 # 7B / 0F8B   JNP  PF=0
04:000000E7 F4        	    65M 	hlt
                      	    66M jns10:
04:000000E8 B455      	    67M 	mov $PS_ZF|PS_AF|PS_PF|PS_CF,%ah
04:000000EA 9E        	    68M 	sahf
04:000000EB 790F      	    69M 	jns jnsok10 # 79 /  0F89  JNS  SF=0
04:000000ED F4        	    70M 	hlt
                      	    71M ja10:
04:000000EE B494      	    72M 	mov $PS_SF|PS_AF|PS_PF,%ah
04:000000F0 9E        	    73M 	sahf
04:000000F1 770B      	    74M 	ja    jaok10  # 77 / 0F87   JA   CF=0 && ZF=0
04:000000F3 F4        	    75M 	hlt
                      	    76M next210:
04:000000F4 EB0A      	    77M 	jmp   jo10
                      	    78M 
                      	    79M .if 8==16
                      	    80M 	.rept 128
                      	    81M 		hlt
                      	    82M 	.endr
                      	    83M .endif
                      	    84M 
                      	    85M # test negative offsets
04:000000F6 73E4      	    86M jncok10:  jnc  jnz10
04:000000F8 75E8      	    87M jnzok10:  jnz  jnp10
04:000000FA 7BEC      	    88M jnpok10:  jnp  jns10
04:000000FC 79F0      	    89M jnsok10:  jns  ja10
04:000000FE 77F4      	    90M jaok10:   ja   next210
                      	    91M 
                      	    92M jo10:
04:00000100 B400      	    93M 	mov $0,%ah
04:00000102 9E        	    94M 	sahf
04:00000103 B040      	    95M 	mov $0b1000000,%al
04:00000105 C0E001    	    96M 	shl $1,%al   	# OF = high-order bit of AL <> (CF), ZF=0,SF=1,OF=1
04:00000108 7132      	    97M 	jno err210
04:0000010A 7031      	    98M 	jo jook10
04:0000010C F4        	    99M 	hlt
                      	   100M jnl10:
04:0000010D 7C2D      	   101M 	jl err210   	# 7C / 0F8C   JL   SF!=OF
04:0000010F 7D2E      	   102M 	jnl jnlok10  	# 7D / 0F8D   JNL  SF=OF
04:00000111 F4        	   103M 	hlt
                      	   104M jnle10:
04:00000112 7E28      	   105M 	jle err210   	# 7E / 0F8E   JLE  ZF=1 || SF!=OF
04:00000114 7F2B      	   106M 	jnle jnleok10 # 7F / 0F8F   JNLE ZF=0 && SF=OF
04:00000116 F4        	   107M 	hlt
                      	   108M jl10:
04:00000117 B440      	   109M 	mov $PS_ZF,%ah
04:00000119 9E        	   110M 	sahf          # ZF=1,SF=0,OF=1
04:0000011A 7C27      	   111M 	jl jlok10   	# 7C / 0F8C   JL   SF!=OF
04:0000011C F4        	   112M 	hlt
                      	   113M jle10:
04:0000011D 7E26      	   114M 	jle jleok10  	# 7E / 0F8E   JLE  ZF=1 || SF!=OF
04:0000011F F4        	   115M 	hlt
                      	   116M jcxz10:
                      	   117M .if 8==8
04:00000120 66B9010000	   118M 	mov $1,%ecx
04:00000125 00
04:00000126 E314      	   119M 	jcxz err210      	# E3   JCXZ  CX=0
04:00000128 66B9000001	   120M 	mov $0x10000,%ecx
04:0000012D 00
04:0000012E E317      	   121M 	jcxz jcxzok10
                      	   122M jecxz10:
04:00000130 E30A      	   123M 	jecxz err210
04:00000132 66B9000000	   124M 	mov $0,%ecx
04:00000137 00
04:00000138 E30F      	   125M 	jecxz jecxzok10 	# E3   JECXZ   ECX=0
                      	   126M jecxze10:
                      	   127M .endif
04:0000013A EB0F      	   128M 	jmp exit10
                      	   129M 
                      	   130M .if 8==16
                      	   131M 	.rept 128
                      	   132M 		hlt
                      	   133M 	.endr
                      	   134M .endif
                      	   135M 
                      	   136M err210:
04:0000013C F4        	   137M 	hlt
                      	   138M 
                      	   139M # test negative offsets
04:0000013D 70CE      	   140M jook10:   jo   jnl10
04:0000013F 7DD1      	   141M jnlok10:  jnl  jnle10
04:00000141 7FD4      	   142M jnleok10: jnle jl10
04:00000143 7CD8      	   143M jlok10:   jl   jle10
04:00000145 7ED9      	   144M jleok10:  jle  jcxz10
                      	   145M .if 8==8
04:00000147 E3E7      	   146M jcxzok10:  jcxz  jecxz10
04:00000149 E3EF      	   147M jecxzok10: jecxz jecxze10
                      	   148M .endif
                      	   149M 
                      	   150M exit10:
                      	   182: 	testJcc 16
04:0000014B B401      	     1M 	mov $PS_CF,%ah
04:0000014D 9E        	     2M 	sahf         # dont use the stack (pushf/popf)
04:0000014E 0F83B700  	     3M 	jnc err111 	# 73 / 0F83   JNC  CF=0
04:00000152 0F82B400  	     4M 	jc jcok11 	# 72 / 0F82   JC   CF=1
04:00000156 F4        	     5M 	hlt
                      	     6M jz11:
04:00000157 B440      	     7M 	mov $PS_ZF,%ah
04:00000159 9E        	     8M 	sahf
04:0000015A 0F85AB00  	     9M 	jnz err111 	# 75 / 0F85   JNZ  ZF=0
04:0000015E 0F84AC00  	    10M 	jz jzok11 	# 74 / 0F84   JZ   ZF=1
04:00000162 F4        	    11M 	hlt
                      	    12M jp11:
04:00000163 B404      	    13M 	mov $PS_PF,%ah
04:00000165 9E        	    14M 	sahf
04:00000166 0F8B9F00  	    15M 	jnp err111 	# 7B / 0F8B   JNP  PF=0
04:0000016A 0F8AA400  	    16M 	jp jpok11 	# 7A / 0F8A   JP   PF=1
04:0000016E F4        	    17M 	hlt
                      	    18M js11:
04:0000016F B480      	    19M 	mov $PS_SF,%ah
04:00000171 9E        	    20M 	sahf
04:00000172 0F899300  	    21M 	jns err111 	# 79 / 0F89   JNS  SF=0
04:00000176 0F889C00  	    22M 	js jsok11 	# 78 / 0F88   JS   SF=1
04:0000017A F4        	    23M 	hlt
                      	    24M jna11:
04:0000017B B441      	    25M 	mov $PS_ZF|PS_CF,%ah
04:0000017D 9E        	    26M 	sahf
04:0000017E 0F878700  	    27M 	ja err111  	# 77 / 0F87   JA   CF=0 && ZF=0
04:00000182 0F869400  	    28M 	jna jnaok11 # 76 / 0F86   JBE  CF=1 || ZF=1
                      	    29M next111:
04:00000186 E99500    	    30M 	jmp jnc11
                      	    31M 
                      	    32M .if 16==16
                      	    33M 	.rept 128
                      	    34M 		hlt
                      	    35M 	.endr
04:00000189 F4        	     1M 		hlt
                      	     2M 	
04:0000018A F4        	     1M 		hlt
                      	     2M 	
04:0000018B F4        	     1M 		hlt
                      	     2M 	
04:0000018C F4        	     1M 		hlt
                      	     2M 	
04:0000018D F4        	     1M 		hlt
                      	     2M 	
04:0000018E F4        	     1M 		hlt
                      	     2M 	
04:0000018F F4        	     1M 		hlt
                      	     2M 	
04:00000190 F4        	     1M 		hlt
                      	     2M 	
04:00000191 F4        	     1M 		hlt
                      	     2M 	
04:00000192 F4        	     1M 		hlt
                      	     2M 	
04:00000193 F4        	     1M 		hlt
                      	     2M 	
04:00000194 F4        	     1M 		hlt
                      	     2M 	
04:00000195 F4        	     1M 		hlt
                      	     2M 	
04:00000196 F4        	     1M 		hlt
                      	     2M 	
04:00000197 F4        	     1M 		hlt
                      	     2M 	
04:00000198 F4        	     1M 		hlt
                      	     2M 	
04:00000199 F4        	     1M 		hlt
                      	     2M 	
04:0000019A F4        	     1M 		hlt
                      	     2M 	
04:0000019B F4        	     1M 		hlt
                      	     2M 	
04:0000019C F4        	     1M 		hlt
                      	     2M 	
04:0000019D F4        	     1M 		hlt
                      	     2M 	
04:0000019E F4        	     1M 		hlt
                      	     2M 	
04:0000019F F4        	     1M 		hlt
                      	     2M 	
04:000001A0 F4        	     1M 		hlt
                      	     2M 	
04:000001A1 F4        	     1M 		hlt
                      	     2M 	
04:000001A2 F4        	     1M 		hlt
                      	     2M 	
04:000001A3 F4        	     1M 		hlt
                      	     2M 	
04:000001A4 F4        	     1M 		hlt
                      	     2M 	
04:000001A5 F4        	     1M 		hlt
                      	     2M 	
04:000001A6 F4        	     1M 		hlt
                      	     2M 	
04:000001A7 F4        	     1M 		hlt
                      	     2M 	
04:000001A8 F4        	     1M 		hlt
                      	     2M 	
04:000001A9 F4        	     1M 		hlt
                      	     2M 	
04:000001AA F4        	     1M 		hlt
                      	     2M 	
04:000001AB F4        	     1M 		hlt
                      	     2M 	
04:000001AC F4        	     1M 		hlt
                      	     2M 	
04:000001AD F4        	     1M 		hlt
                      	     2M 	
04:000001AE F4        	     1M 		hlt
                      	     2M 	
04:000001AF F4        	     1M 		hlt
                      	     2M 	
04:000001B0 F4        	     1M 		hlt
                      	     2M 	
04:000001B1 F4        	     1M 		hlt
                      	     2M 	
04:000001B2 F4        	     1M 		hlt
                      	     2M 	
04:000001B3 F4        	     1M 		hlt
                      	     2M 	
04:000001B4 F4        	     1M 		hlt
                      	     2M 	
04:000001B5 F4        	     1M 		hlt
                      	     2M 	
04:000001B6 F4        	     1M 		hlt
                      	     2M 	
04:000001B7 F4        	     1M 		hlt
                      	     2M 	
04:000001B8 F4        	     1M 		hlt
                      	     2M 	
04:000001B9 F4        	     1M 		hlt
                      	     2M 	
04:000001BA F4        	     1M 		hlt
                      	     2M 	
04:000001BB F4        	     1M 		hlt
                      	     2M 	
04:000001BC F4        	     1M 		hlt
                      	     2M 	
04:000001BD F4        	     1M 		hlt
                      	     2M 	
04:000001BE F4        	     1M 		hlt
                      	     2M 	
04:000001BF F4        	     1M 		hlt
                      	     2M 	
04:000001C0 F4        	     1M 		hlt
                      	     2M 	
04:000001C1 F4        	     1M 		hlt
                      	     2M 	
04:000001C2 F4        	     1M 		hlt
                      	     2M 	
04:000001C3 F4        	     1M 		hlt
                      	     2M 	
04:000001C4 F4        	     1M 		hlt
                      	     2M 	
04:000001C5 F4        	     1M 		hlt
                      	     2M 	
04:000001C6 F4        	     1M 		hlt
                      	     2M 	
04:000001C7 F4        	     1M 		hlt
                      	     2M 	
04:000001C8 F4        	     1M 		hlt
                      	     2M 	
04:000001C9 F4        	     1M 		hlt
                      	     2M 	
04:000001CA F4        	     1M 		hlt
                      	     2M 	
04:000001CB F4        	     1M 		hlt
                      	     2M 	
04:000001CC F4        	     1M 		hlt
                      	     2M 	
04:000001CD F4        	     1M 		hlt
                      	     2M 	
04:000001CE F4        	     1M 		hlt
                      	     2M 	
04:000001CF F4        	     1M 		hlt
                      	     2M 	
04:000001D0 F4        	     1M 		hlt
                      	     2M 	
04:000001D1 F4        	     1M 		hlt
                      	     2M 	
04:000001D2 F4        	     1M 		hlt
                      	     2M 	
04:000001D3 F4        	     1M 		hlt
                      	     2M 	
04:000001D4 F4        	     1M 		hlt
                      	     2M 	
04:000001D5 F4        	     1M 		hlt
                      	     2M 	
04:000001D6 F4        	     1M 		hlt
                      	     2M 	
04:000001D7 F4        	     1M 		hlt
                      	     2M 	
04:000001D8 F4        	     1M 		hlt
                      	     2M 	
04:000001D9 F4        	     1M 		hlt
                      	     2M 	
04:000001DA F4        	     1M 		hlt
                      	     2M 	
04:000001DB F4        	     1M 		hlt
                      	     2M 	
04:000001DC F4        	     1M 		hlt
                      	     2M 	
04:000001DD F4        	     1M 		hlt
                      	     2M 	
04:000001DE F4        	     1M 		hlt
                      	     2M 	
04:000001DF F4        	     1M 		hlt
                      	     2M 	
04:000001E0 F4        	     1M 		hlt
                      	     2M 	
04:000001E1 F4        	     1M 		hlt
                      	     2M 	
04:000001E2 F4        	     1M 		hlt
                      	     2M 	
04:000001E3 F4        	     1M 		hlt
                      	     2M 	
04:000001E4 F4        	     1M 		hlt
                      	     2M 	
04:000001E5 F4        	     1M 		hlt
                      	     2M 	
04:000001E6 F4        	     1M 		hlt
                      	     2M 	
04:000001E7 F4        	     1M 		hlt
                      	     2M 	
04:000001E8 F4        	     1M 		hlt
                      	     2M 	
04:000001E9 F4        	     1M 		hlt
                      	     2M 	
04:000001EA F4        	     1M 		hlt
                      	     2M 	
04:000001EB F4        	     1M 		hlt
                      	     2M 	
04:000001EC F4        	     1M 		hlt
                      	     2M 	
04:000001ED F4        	     1M 		hlt
                      	     2M 	
04:000001EE F4        	     1M 		hlt
                      	     2M 	
04:000001EF F4        	     1M 		hlt
                      	     2M 	
04:000001F0 F4        	     1M 		hlt
                      	     2M 	
04:000001F1 F4        	     1M 		hlt
                      	     2M 	
04:000001F2 F4        	     1M 		hlt
                      	     2M 	
04:000001F3 F4        	     1M 		hlt
                      	     2M 	
04:000001F4 F4        	     1M 		hlt
                      	     2M 	
04:000001F5 F4        	     1M 		hlt
                      	     2M 	
04:000001F6 F4        	     1M 		hlt
                      	     2M 	
04:000001F7 F4        	     1M 		hlt
                      	     2M 	
04:000001F8 F4        	     1M 		hlt
                      	     2M 	
04:000001F9 F4        	     1M 		hlt
                      	     2M 	
04:000001FA F4        	     1M 		hlt
                      	     2M 	
04:000001FB F4        	     1M 		hlt
                      	     2M 	
04:000001FC F4        	     1M 		hlt
                      	     2M 	
04:000001FD F4        	     1M 		hlt
                      	     2M 	
04:000001FE F4        	     1M 		hlt
                      	     2M 	
04:000001FF F4        	     1M 		hlt
                      	     2M 	
04:00000200 F4        	     1M 		hlt
                      	     2M 	
04:00000201 F4        	     1M 		hlt
                      	     2M 	
04:00000202 F4        	     1M 		hlt
                      	     2M 	
04:00000203 F4        	     1M 		hlt
                      	     2M 	
04:00000204 F4        	     1M 		hlt
                      	     2M 	
04:00000205 F4        	     1M 		hlt
                      	     2M 	
04:00000206 F4        	     1M 		hlt
                      	     2M 	
04:00000207 F4        	     1M 		hlt
                      	     2M 	
04:00000208 F4        	     1M 		hlt
                      	     2M 	
                      	    36M .endif
                      	    37M 
                      	    38M err111:
04:00000209 F4        	    39M 	hlt
                      	    40M 
                      	    41M # test negative offsets
04:0000020A 0F8249FF  	    42M jcok11:   jc   jz11
04:0000020E 0F8451FF  	    43M jzok11:   jz   jp11
04:00000212 0F8A59FF  	    44M jpok11:   jp   js11
04:00000216 0F8861FF  	    45M jsok11:   js   jna11
04:0000021A 0F8668FF  	    46M jnaok11:  jna  next111
                      	    47M 
                      	    48M 
                      	    49M jnc11:
04:0000021E B4D4      	    50M 	mov $PS_SF|PS_ZF|PS_AF|PS_PF,%ah
04:00000220 9E        	    51M 	sahf
04:00000221 B80000    	    52M 	mov $0,%ax
04:00000224 9E        	    53M 	sahf
04:00000225 0F83A400  	    54M 	jnc   jncok11 # 73 / 0F83   JNC  CF=0
04:00000229 F4        	    55M 	hlt
                      	    56M jnz11:
04:0000022A B495      	    57M 	mov $PS_SF|PS_AF|PS_PF|PS_CF,%ah
04:0000022C 9E        	    58M 	sahf
04:0000022D 0F85A000  	    59M 	jnz   jnzok11 # 75 / 0F85   JNZ  ZF=0
04:00000231 F4        	    60M 	hlt
                      	    61M jnp11:
04:00000232 B4D1      	    62M 	mov $PS_SF|PS_ZF|PS_AF|PS_CF,%ah
04:00000234 9E        	    63M 	sahf
04:00000235 0F8B9C00  	    64M 	jnp   jnpok11 # 7B / 0F8B   JNP  PF=0
04:00000239 F4        	    65M 	hlt
                      	    66M jns11:
04:0000023A B455      	    67M 	mov $PS_ZF|PS_AF|PS_PF|PS_CF,%ah
04:0000023C 9E        	    68M 	sahf
04:0000023D 0F899800  	    69M 	jns jnsok11 # 79 /  0F89  JNS  SF=0
04:00000241 F4        	    70M 	hlt
                      	    71M ja11:
04:00000242 B494      	    72M 	mov $PS_SF|PS_AF|PS_PF,%ah
04:00000244 9E        	    73M 	sahf
04:00000245 0F879400  	    74M 	ja    jaok11  # 77 / 0F87   JA   CF=0 && ZF=0
04:00000249 F4        	    75M 	hlt
                      	    76M next211:
04:0000024A E99400    	    77M 	jmp   jo11
                      	    78M 
                      	    79M .if 16==16
                      	    80M 	.rept 128
                      	    81M 		hlt
                      	    82M 	.endr
04:0000024D F4        	     1M 		hlt
                      	     2M 	
04:0000024E F4        	     1M 		hlt
                      	     2M 	
04:0000024F F4        	     1M 		hlt
                      	     2M 	
04:00000250 F4        	     1M 		hlt
                      	     2M 	
04:00000251 F4        	     1M 		hlt
                      	     2M 	
04:00000252 F4        	     1M 		hlt
                      	     2M 	
04:00000253 F4        	     1M 		hlt
                      	     2M 	
04:00000254 F4        	     1M 		hlt
                      	     2M 	
04:00000255 F4        	     1M 		hlt
                      	     2M 	
04:00000256 F4        	     1M 		hlt
                      	     2M 	
04:00000257 F4        	     1M 		hlt
                      	     2M 	
04:00000258 F4        	     1M 		hlt
                      	     2M 	
04:00000259 F4        	     1M 		hlt
                      	     2M 	
04:0000025A F4        	     1M 		hlt
                      	     2M 	
04:0000025B F4        	     1M 		hlt
                      	     2M 	
04:0000025C F4        	     1M 		hlt
                      	     2M 	
04:0000025D F4        	     1M 		hlt
                      	     2M 	
04:0000025E F4        	     1M 		hlt
                      	     2M 	
04:0000025F F4        	     1M 		hlt
                      	     2M 	
04:00000260 F4        	     1M 		hlt
                      	     2M 	
04:00000261 F4        	     1M 		hlt
                      	     2M 	
04:00000262 F4        	     1M 		hlt
                      	     2M 	
04:00000263 F4        	     1M 		hlt
                      	     2M 	
04:00000264 F4        	     1M 		hlt
                      	     2M 	
04:00000265 F4        	     1M 		hlt
                      	     2M 	
04:00000266 F4        	     1M 		hlt
                      	     2M 	
04:00000267 F4        	     1M 		hlt
                      	     2M 	
04:00000268 F4        	     1M 		hlt
                      	     2M 	
04:00000269 F4        	     1M 		hlt
                      	     2M 	
04:0000026A F4        	     1M 		hlt
                      	     2M 	
04:0000026B F4        	     1M 		hlt
                      	     2M 	
04:0000026C F4        	     1M 		hlt
                      	     2M 	
04:0000026D F4        	     1M 		hlt
                      	     2M 	
04:0000026E F4        	     1M 		hlt
                      	     2M 	
04:0000026F F4        	     1M 		hlt
                      	     2M 	
04:00000270 F4        	     1M 		hlt
                      	     2M 	
04:00000271 F4        	     1M 		hlt
                      	     2M 	
04:00000272 F4        	     1M 		hlt
                      	     2M 	
04:00000273 F4        	     1M 		hlt
                      	     2M 	
04:00000274 F4        	     1M 		hlt
                      	     2M 	
04:00000275 F4        	     1M 		hlt
                      	     2M 	
04:00000276 F4        	     1M 		hlt
                      	     2M 	
04:00000277 F4        	     1M 		hlt
                      	     2M 	
04:00000278 F4        	     1M 		hlt
                      	     2M 	
04:00000279 F4        	     1M 		hlt
                      	     2M 	
04:0000027A F4        	     1M 		hlt
                      	     2M 	
04:0000027B F4        	     1M 		hlt
                      	     2M 	
04:0000027C F4        	     1M 		hlt
                      	     2M 	
04:0000027D F4        	     1M 		hlt
                      	     2M 	
04:0000027E F4        	     1M 		hlt
                      	     2M 	
04:0000027F F4        	     1M 		hlt
                      	     2M 	
04:00000280 F4        	     1M 		hlt
                      	     2M 	
04:00000281 F4        	     1M 		hlt
                      	     2M 	
04:00000282 F4        	     1M 		hlt
                      	     2M 	
04:00000283 F4        	     1M 		hlt
                      	     2M 	
04:00000284 F4        	     1M 		hlt
                      	     2M 	
04:00000285 F4        	     1M 		hlt
                      	     2M 	
04:00000286 F4        	     1M 		hlt
                      	     2M 	
04:00000287 F4        	     1M 		hlt
                      	     2M 	
04:00000288 F4        	     1M 		hlt
                      	     2M 	
04:00000289 F4        	     1M 		hlt
                      	     2M 	
04:0000028A F4        	     1M 		hlt
                      	     2M 	
04:0000028B F4        	     1M 		hlt
                      	     2M 	
04:0000028C F4        	     1M 		hlt
                      	     2M 	
04:0000028D F4        	     1M 		hlt
                      	     2M 	
04:0000028E F4        	     1M 		hlt
                      	     2M 	
04:0000028F F4        	     1M 		hlt
                      	     2M 	
04:00000290 F4        	     1M 		hlt
                      	     2M 	
04:00000291 F4        	     1M 		hlt
                      	     2M 	
04:00000292 F4        	     1M 		hlt
                      	     2M 	
04:00000293 F4        	     1M 		hlt
                      	     2M 	
04:00000294 F4        	     1M 		hlt
                      	     2M 	
04:00000295 F4        	     1M 		hlt
                      	     2M 	
04:00000296 F4        	     1M 		hlt
                      	     2M 	
04:00000297 F4        	     1M 		hlt
                      	     2M 	
04:00000298 F4        	     1M 		hlt
                      	     2M 	
04:00000299 F4        	     1M 		hlt
                      	     2M 	
04:0000029A F4        	     1M 		hlt
                      	     2M 	
04:0000029B F4        	     1M 		hlt
                      	     2M 	
04:0000029C F4        	     1M 		hlt
                      	     2M 	
04:0000029D F4        	     1M 		hlt
                      	     2M 	
04:0000029E F4        	     1M 		hlt
                      	     2M 	
04:0000029F F4        	     1M 		hlt
                      	     2M 	
04:000002A0 F4        	     1M 		hlt
                      	     2M 	
04:000002A1 F4        	     1M 		hlt
                      	     2M 	
04:000002A2 F4        	     1M 		hlt
                      	     2M 	
04:000002A3 F4        	     1M 		hlt
                      	     2M 	
04:000002A4 F4        	     1M 		hlt
                      	     2M 	
04:000002A5 F4        	     1M 		hlt
                      	     2M 	
04:000002A6 F4        	     1M 		hlt
                      	     2M 	
04:000002A7 F4        	     1M 		hlt
                      	     2M 	
04:000002A8 F4        	     1M 		hlt
                      	     2M 	
04:000002A9 F4        	     1M 		hlt
                      	     2M 	
04:000002AA F4        	     1M 		hlt
                      	     2M 	
04:000002AB F4        	     1M 		hlt
                      	     2M 	
04:000002AC F4        	     1M 		hlt
                      	     2M 	
04:000002AD F4        	     1M 		hlt
                      	     2M 	
04:000002AE F4        	     1M 		hlt
                      	     2M 	
04:000002AF F4        	     1M 		hlt
                      	     2M 	
04:000002B0 F4        	     1M 		hlt
                      	     2M 	
04:000002B1 F4        	     1M 		hlt
                      	     2M 	
04:000002B2 F4        	     1M 		hlt
                      	     2M 	
04:000002B3 F4        	     1M 		hlt
                      	     2M 	
04:000002B4 F4        	     1M 		hlt
                      	     2M 	
04:000002B5 F4        	     1M 		hlt
                      	     2M 	
04:000002B6 F4        	     1M 		hlt
                      	     2M 	
04:000002B7 F4        	     1M 		hlt
                      	     2M 	
04:000002B8 F4        	     1M 		hlt
                      	     2M 	
04:000002B9 F4        	     1M 		hlt
                      	     2M 	
04:000002BA F4        	     1M 		hlt
                      	     2M 	
04:000002BB F4        	     1M 		hlt
                      	     2M 	
04:000002BC F4        	     1M 		hlt
                      	     2M 	
04:000002BD F4        	     1M 		hlt
                      	     2M 	
04:000002BE F4        	     1M 		hlt
                      	     2M 	
04:000002BF F4        	     1M 		hlt
                      	     2M 	
04:000002C0 F4        	     1M 		hlt
                      	     2M 	
04:000002C1 F4        	     1M 		hlt
                      	     2M 	
04:000002C2 F4        	     1M 		hlt
                      	     2M 	
04:000002C3 F4        	     1M 		hlt
                      	     2M 	
04:000002C4 F4        	     1M 		hlt
                      	     2M 	
04:000002C5 F4        	     1M 		hlt
                      	     2M 	
04:000002C6 F4        	     1M 		hlt
                      	     2M 	
04:000002C7 F4        	     1M 		hlt
                      	     2M 	
04:000002C8 F4        	     1M 		hlt
                      	     2M 	
04:000002C9 F4        	     1M 		hlt
                      	     2M 	
04:000002CA F4        	     1M 		hlt
                      	     2M 	
04:000002CB F4        	     1M 		hlt
                      	     2M 	
04:000002CC F4        	     1M 		hlt
                      	     2M 	
                      	    83M .endif
                      	    84M 
                      	    85M # test negative offsets
04:000002CD 0F8359FF  	    86M jncok11:  jnc  jnz11
04:000002D1 0F855DFF  	    87M jnzok11:  jnz  jnp11
04:000002D5 0F8B61FF  	    88M jnpok11:  jnp  jns11
04:000002D9 0F8965FF  	    89M jnsok11:  jns  ja11
04:000002DD 0F8769FF  	    90M jaok11:   ja   next211
                      	    91M 
                      	    92M jo11:
04:000002E1 B400      	    93M 	mov $0,%ah
04:000002E3 9E        	    94M 	sahf
04:000002E4 B040      	    95M 	mov $0b1000000,%al
04:000002E6 C0E001    	    96M 	shl $1,%al   	# OF = high-order bit of AL <> (CF), ZF=0,SF=1,OF=1
04:000002E9 0F81A700  	    97M 	jno err211
04:000002ED 0F80A400  	    98M 	jo jook11
04:000002F1 F4        	    99M 	hlt
                      	   100M jnl11:
04:000002F2 0F8C9E00  	   101M 	jl err211   	# 7C / 0F8C   JL   SF!=OF
04:000002F6 0F8D9F00  	   102M 	jnl jnlok11  	# 7D / 0F8D   JNL  SF=OF
04:000002FA F4        	   103M 	hlt
                      	   104M jnle11:
04:000002FB 0F8E9500  	   105M 	jle err211   	# 7E / 0F8E   JLE  ZF=1 || SF!=OF
04:000002FF 0F8F9A00  	   106M 	jnle jnleok11 # 7F / 0F8F   JNLE ZF=0 && SF=OF
04:00000303 F4        	   107M 	hlt
                      	   108M jl11:
04:00000304 B440      	   109M 	mov $PS_ZF,%ah
04:00000306 9E        	   110M 	sahf          # ZF=1,SF=0,OF=1
04:00000307 0F8C9600  	   111M 	jl jlok11   	# 7C / 0F8C   JL   SF!=OF
04:0000030B F4        	   112M 	hlt
                      	   113M jle11:
04:0000030C 0F8E9500  	   114M 	jle jleok11  	# 7E / 0F8E   JLE  ZF=1 || SF!=OF
04:00000310 F4        	   115M 	hlt
                      	   116M jcxz11:
                      	   117M .if 16==8
                      	   118M 	mov $1,%ecx
                      	   119M 	jcxz err211      	# E3   JCXZ  CX=0
                      	   120M 	mov $0x10000,%ecx
                      	   121M 	jcxz jcxzok11
                      	   122M jecxz11:
                      	   123M 	jecxz err211
                      	   124M 	mov $0,%ecx
                      	   125M 	jecxz jecxzok11 	# E3   JECXZ   ECX=0
                      	   126M jecxze11:
                      	   127M .endif
04:00000311 E99500    	   128M 	jmp exit11
                      	   129M 
                      	   130M .if 16==16
                      	   131M 	.rept 128
                      	   132M 		hlt
                      	   133M 	.endr
04:00000314 F4        	     1M 		hlt
                      	     2M 	
04:00000315 F4        	     1M 		hlt
                      	     2M 	
04:00000316 F4        	     1M 		hlt
                      	     2M 	
04:00000317 F4        	     1M 		hlt
                      	     2M 	
04:00000318 F4        	     1M 		hlt
                      	     2M 	
04:00000319 F4        	     1M 		hlt
                      	     2M 	
04:0000031A F4        	     1M 		hlt
                      	     2M 	
04:0000031B F4        	     1M 		hlt
                      	     2M 	
04:0000031C F4        	     1M 		hlt
                      	     2M 	
04:0000031D F4        	     1M 		hlt
                      	     2M 	
04:0000031E F4        	     1M 		hlt
                      	     2M 	
04:0000031F F4        	     1M 		hlt
                      	     2M 	
04:00000320 F4        	     1M 		hlt
                      	     2M 	
04:00000321 F4        	     1M 		hlt
                      	     2M 	
04:00000322 F4        	     1M 		hlt
                      	     2M 	
04:00000323 F4        	     1M 		hlt
                      	     2M 	
04:00000324 F4        	     1M 		hlt
                      	     2M 	
04:00000325 F4        	     1M 		hlt
                      	     2M 	
04:00000326 F4        	     1M 		hlt
                      	     2M 	
04:00000327 F4        	     1M 		hlt
                      	     2M 	
04:00000328 F4        	     1M 		hlt
                      	     2M 	
04:00000329 F4        	     1M 		hlt
                      	     2M 	
04:0000032A F4        	     1M 		hlt
                      	     2M 	
04:0000032B F4        	     1M 		hlt
                      	     2M 	
04:0000032C F4        	     1M 		hlt
                      	     2M 	
04:0000032D F4        	     1M 		hlt
                      	     2M 	
04:0000032E F4        	     1M 		hlt
                      	     2M 	
04:0000032F F4        	     1M 		hlt
                      	     2M 	
04:00000330 F4        	     1M 		hlt
                      	     2M 	
04:00000331 F4        	     1M 		hlt
                      	     2M 	
04:00000332 F4        	     1M 		hlt
                      	     2M 	
04:00000333 F4        	     1M 		hlt
                      	     2M 	
04:00000334 F4        	     1M 		hlt
                      	     2M 	
04:00000335 F4        	     1M 		hlt
                      	     2M 	
04:00000336 F4        	     1M 		hlt
                      	     2M 	
04:00000337 F4        	     1M 		hlt
                      	     2M 	
04:00000338 F4        	     1M 		hlt
                      	     2M 	
04:00000339 F4        	     1M 		hlt
                      	     2M 	
04:0000033A F4        	     1M 		hlt
                      	     2M 	
04:0000033B F4        	     1M 		hlt
                      	     2M 	
04:0000033C F4        	     1M 		hlt
                      	     2M 	
04:0000033D F4        	     1M 		hlt
                      	     2M 	
04:0000033E F4        	     1M 		hlt
                      	     2M 	
04:0000033F F4        	     1M 		hlt
                      	     2M 	
04:00000340 F4        	     1M 		hlt
                      	     2M 	
04:00000341 F4        	     1M 		hlt
                      	     2M 	
04:00000342 F4        	     1M 		hlt
                      	     2M 	
04:00000343 F4        	     1M 		hlt
                      	     2M 	
04:00000344 F4        	     1M 		hlt
                      	     2M 	
04:00000345 F4        	     1M 		hlt
                      	     2M 	
04:00000346 F4        	     1M 		hlt
                      	     2M 	
04:00000347 F4        	     1M 		hlt
                      	     2M 	
04:00000348 F4        	     1M 		hlt
                      	     2M 	
04:00000349 F4        	     1M 		hlt
                      	     2M 	
04:0000034A F4        	     1M 		hlt
                      	     2M 	
04:0000034B F4        	     1M 		hlt
                      	     2M 	
04:0000034C F4        	     1M 		hlt
                      	     2M 	
04:0000034D F4        	     1M 		hlt
                      	     2M 	
04:0000034E F4        	     1M 		hlt
                      	     2M 	
04:0000034F F4        	     1M 		hlt
                      	     2M 	
04:00000350 F4        	     1M 		hlt
                      	     2M 	
04:00000351 F4        	     1M 		hlt
                      	     2M 	
04:00000352 F4        	     1M 		hlt
                      	     2M 	
04:00000353 F4        	     1M 		hlt
                      	     2M 	
04:00000354 F4        	     1M 		hlt
                      	     2M 	
04:00000355 F4        	     1M 		hlt
                      	     2M 	
04:00000356 F4        	     1M 		hlt
                      	     2M 	
04:00000357 F4        	     1M 		hlt
                      	     2M 	
04:00000358 F4        	     1M 		hlt
                      	     2M 	
04:00000359 F4        	     1M 		hlt
                      	     2M 	
04:0000035A F4        	     1M 		hlt
                      	     2M 	
04:0000035B F4        	     1M 		hlt
                      	     2M 	
04:0000035C F4        	     1M 		hlt
                      	     2M 	
04:0000035D F4        	     1M 		hlt
                      	     2M 	
04:0000035E F4        	     1M 		hlt
                      	     2M 	
04:0000035F F4        	     1M 		hlt
                      	     2M 	
04:00000360 F4        	     1M 		hlt
                      	     2M 	
04:00000361 F4        	     1M 		hlt
                      	     2M 	
04:00000362 F4        	     1M 		hlt
                      	     2M 	
04:00000363 F4        	     1M 		hlt
                      	     2M 	
04:00000364 F4        	     1M 		hlt
                      	     2M 	
04:00000365 F4        	     1M 		hlt
                      	     2M 	
04:00000366 F4        	     1M 		hlt
                      	     2M 	
04:00000367 F4        	     1M 		hlt
                      	     2M 	
04:00000368 F4        	     1M 		hlt
                      	     2M 	
04:00000369 F4        	     1M 		hlt
                      	     2M 	
04:0000036A F4        	     1M 		hlt
                      	     2M 	
04:0000036B F4        	     1M 		hlt
                      	     2M 	
04:0000036C F4        	     1M 		hlt
                      	     2M 	
04:0000036D F4        	     1M 		hlt
                      	     2M 	
04:0000036E F4        	     1M 		hlt
                      	     2M 	
04:0000036F F4        	     1M 		hlt
                      	     2M 	
04:00000370 F4        	     1M 		hlt
                      	     2M 	
04:00000371 F4        	     1M 		hlt
                      	     2M 	
04:00000372 F4        	     1M 		hlt
                      	     2M 	
04:00000373 F4        	     1M 		hlt
                      	     2M 	
04:00000374 F4        	     1M 		hlt
                      	     2M 	
04:00000375 F4        	     1M 		hlt
                      	     2M 	
04:00000376 F4        	     1M 		hlt
                      	     2M 	
04:00000377 F4        	     1M 		hlt
                      	     2M 	
04:00000378 F4        	     1M 		hlt
                      	     2M 	
04:00000379 F4        	     1M 		hlt
                      	     2M 	
04:0000037A F4        	     1M 		hlt
                      	     2M 	
04:0000037B F4        	     1M 		hlt
                      	     2M 	
04:0000037C F4        	     1M 		hlt
                      	     2M 	
04:0000037D F4        	     1M 		hlt
                      	     2M 	
04:0000037E F4        	     1M 		hlt
                      	     2M 	
04:0000037F F4        	     1M 		hlt
                      	     2M 	
04:00000380 F4        	     1M 		hlt
                      	     2M 	
04:00000381 F4        	     1M 		hlt
                      	     2M 	
04:00000382 F4        	     1M 		hlt
                      	     2M 	
04:00000383 F4        	     1M 		hlt
                      	     2M 	
04:00000384 F4        	     1M 		hlt
                      	     2M 	
04:00000385 F4        	     1M 		hlt
                      	     2M 	
04:00000386 F4        	     1M 		hlt
                      	     2M 	
04:00000387 F4        	     1M 		hlt
                      	     2M 	
04:00000388 F4        	     1M 		hlt
                      	     2M 	
04:00000389 F4        	     1M 		hlt
                      	     2M 	
04:0000038A F4        	     1M 		hlt
                      	     2M 	
04:0000038B F4        	     1M 		hlt
                      	     2M 	
04:0000038C F4        	     1M 		hlt
                      	     2M 	
04:0000038D F4        	     1M 		hlt
                      	     2M 	
04:0000038E F4        	     1M 		hlt
                      	     2M 	
04:0000038F F4        	     1M 		hlt
                      	     2M 	
04:00000390 F4        	     1M 		hlt
                      	     2M 	
04:00000391 F4        	     1M 		hlt
                      	     2M 	
04:00000392 F4        	     1M 		hlt
                      	     2M 	
04:00000393 F4        	     1M 		hlt
                      	     2M 	
                      	   134M .endif
                      	   135M 
                      	   136M err211:
04:00000394 F4        	   137M 	hlt
                      	   138M 
                      	   139M # test negative offsets
04:00000395 0F8059FF  	   140M jook11:   jo   jnl11
04:00000399 0F8D5EFF  	   141M jnlok11:  jnl  jnle11
04:0000039D 0F8F63FF  	   142M jnleok11: jnle jl11
04:000003A1 0F8C67FF  	   143M jlok11:   jl   jle11
04:000003A5 0F8E68FF  	   144M jleok11:  jle  jcxz11
                      	   145M .if 16==8
                      	   146M jcxzok11:  jcxz  jecxz11
                      	   147M jecxzok11: jecxz jecxze11
                      	   148M .endif
                      	   149M 
                      	   150M exit11:
                      	   183: 
                      	   184: #
                      	   185: #   Loops
                      	   186: #
                      	   187: .include "loop_m.asm"

Source: "loop_m.asm"
                      	     1: #
                      	     2: #   Test of loop, loopz, loopnz
                      	     3: #   Use: EAX, ECX, Flags
                      	     4: #
                      	     5: 
                      	     6: .macro testLoop
                      	     7: 
                      	     8: 	mov $0x20000,%ecx
                      	     9: 	mov $0,%eax
                      	    10: loop16\@:
                      	    11: 	inc %eax
                      	    12: 	loopw loop16\@
                      	    13: 	cmp $0x10000,%eax
                      	    14: 	jne error
                      	    15: 	cmp $0x20000,%ecx
                      	    16: 	jne error
                      	    17: 
                      	    18: 	mov $0x20000,%ecx
                      	    19: 	mov $0,%eax
                      	    20: loop32\@:
                      	    21: 	inc %eax
                      	    22: 	loopl loop32\@
                      	    23: 	cmp $0x20000,%eax
                      	    24: 	jne error
                      	    25: 	cmp $0,%ecx
                      	    26: 	jne error
                      	    27: 
                      	    28: .endm
                      	    29: 
                      	    30: .macro testLoopZ
                      	    31: 
                      	    32: 	mov $0xFFFF,%cx
                      	    33: 	mov $0,%ax
                      	    34: loop16a\@:
                      	    35: 	inc %ax
                      	    36: 	cmp $0,%ah
                      	    37: 	loopzw loop16a\@
                      	    38: 	cmp $0x0100,%ax
                      	    39: 	jne error
                      	    40: 	cmp $0xFEFF,%cx
                      	    41: 	jne error
                      	    42: 
                      	    43: 	mov $0x00FF,%cx
                      	    44: 	mov $0,%ax
                      	    45: loop16b\@:
                      	    46: 	inc %ax
                      	    47: 	cmp $0,%ah
                      	    48: 	loopzw loop16b\@
                      	    49: 	cmp $0x00FF,%ax
                      	    50: 	jne error
                      	    51: 	cmp $0,%cx
                      	    52: 	jne error
                      	    53: 
                      	    54: 	mov $0x20000,%ecx
                      	    55: 	mov $0,%eax
                      	    56: loop32\@:
                      	    57: 	inc %eax
                      	    58: 	test $0x10000,%eax
                      	    59: 	loopzl loop32\@
                      	    60: 	cmp $0x10000,%eax
                      	    61: 	jne error
                      	    62: 	cmp $0x10000,%ecx
                      	    63: 	jne error
                      	    64: 
                      	    65: .endm
                      	    66: 
                      	    67: .macro testLoopNZ
                      	    68: 
                      	    69: 	mov $0xFFFF,%cx
                      	    70: 	mov $0,%ax
                      	    71: loop16a\@:
                      	    72: 	inc %ax
                      	    73: 	test $0xFF,%al
                      	    74: 	loopnzw loop16a\@
                      	    75: 	cmp $0x0100,%ax
                      	    76: 	jne error
                      	    77: 	cmp $0xFEFF,%cx
                      	    78: 	jne error
                      	    79: 
                      	    80: 	mov $0x00FF,%cx
                      	    81: 	mov $0,%ax
                      	    82: loop16b\@:
                      	    83: 	inc %ax
                      	    84: 	test $0xFF,%al
                      	    85: 	loopnzw loop16b\@
                      	    86: 	cmp $0x00FF,%ax
                      	    87: 	jne error
                      	    88: 	cmp $0,%cx
                      	    89: 	jne error
                      	    90: 
                      	    91: 	mov $0x10000,%ecx
                      	    92: 	mov $0,%eax
                      	    93: loop32\@:
                      	    94: 	inc %eax
                      	    95: 	test $0x0FFFF,%eax
                      	    96: 	loopnzl loop32\@
                      	    97: 	cmp $0x10000,%eax
                      	    98: 	jne error
                      	    99: 	cmp $0,%ecx
                      	   100: 	jne error
                      	   101: 
                      	   102: .endm

Source: "t386.asm"
                      	   188: #	testLoop
                      	   189: #	testLoopZ
                      	   190: #	testLoopNZ
                      	   191: 
                      	   192: #-------------------------------------------------------------------------------
                      	   193: 	POST $0x02
04:000003A9 B002      	     1M 	movb $0x02,%al
04:000003AB BA9001    	     2M 	movw $POST_PORT,%dx
04:000003AE EE        	     3M 	out %al,%dx
                      	   194: #-------------------------------------------------------------------------------
                      	   195: #
                      	   196: #   Quick tests of unsigned 32-bit multiplication and division
                      	   197: #   Thorough arithmetical and logical tests are done later
                      	   198: #
04:000003AF 66B8010000	   199: 	mov $0x80000001,%eax
04:000003B4 80
04:000003B5 66F7E8    	   200: 	imul %eax
04:000003B8 66B8112233	   201: 	mov $0x44332211,%eax
04:000003BD 44
04:000003BE 6689C3    	   202: 	mov %eax,%ebx
04:000003C1 66B9556677	   203: 	mov $0x88776655,%ecx
04:000003C6 88
04:000003C7 66F7E1    	   204: 	mul %ecx
04:000003CA 66F7F1    	   205: 	div %ecx
04:000003CD 6639D8    	   206: 	cmp %ebx,%eax
04:000003D0 0F856B14  	   207: 	jne error
                      	   208: 
                      	   209: .include "mov_m.asm"

Source: "mov_m.asm"
                      	     1: #
                      	     2: #   Tests MOV from segment registers in real mode
                      	     3: #
                      	     4: #   %1 the segment register to test
                      	     5: #
                      	     6: .macro testMovSegR_real arg1
                      	     7: 	.ifc \arg1, cs
                      	     8: 	mov $C_SEG_REAL,%dx
                      	     9: 	.else
                      	    10: 	mov $D1_SEG_REAL,%dx
                      	    11: 	.endif
                      	    12: 
                      	    13: 	# MOV reg to Sreg
                      	    14: 	.ifc \arg1, cs
                      	    15: 	realModeFaultTest EX_UD, "mov %dx", \arg1 # test for #UD
                      	    16: 	.else
                      	    17: 	mov %dx,%\arg1
                      	    18: 	.endif
                      	    19: 
                      	    20: 	# MOV Sreg to 16 bit reg
                      	    21: 	xor %ax,%ax
                      	    22: 	mov %\arg1,%ax
                      	    23: 	cmp %dx,%ax
                      	    24: 	jne error
                      	    25: 
                      	    26: 	# MOV Sreg to 32 bit reg
                      	    27: 	mov $-1,%eax
                      	    28: 	mov %\arg1,%eax
                      	    29: 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    30: 	# TODO: verify on real hw and check TEST_UNDEF
                      	    31: 	cmp %dx,%ax
                      	    32: 	jne error
                      	    33: 
                      	    34: 	# MOV Sreg to word mem
                      	    35: 	movw $0xbeef,0
                      	    36: 	mov %\arg1,0
                      	    37: 	cmp %dx,0
                      	    38: 	jne error
                      	    39: 
                      	    40: 	# MOV word mem to Sreg
                      	    41: 	.ifc \arg1, cs
                      	    42: 	realModeFaultTest EX_UD, "mov 0", \arg1 # test for #UD
                      	    43: 	.else
                      	    44: 	mov %ds,%cx	 	# save current DS in CX
                      	    45: 	xor %ax,%ax
                      	    46: 	mov %ax,%\arg1
                      	    47: 	.ifc \arg1, ds
                      	    48: 	mov %cx,%es
                      	    49: 	mov %es:0,%\arg1
                      	    50: 	.else
                      	    51: 	mov 0,%\arg1
                      	    52: 	.endif
                      	    53: 	mov %\arg1,%ax
                      	    54: 	cmp %dx,%ax
                      	    55: 	jne error
                      	    56: 	.endif
                      	    57: 
                      	    58: .endm
                      	    59: 
                      	    60: 
                      	    61: .macro testMovSegR_prot arg1
                      	    62: 	mov $-1,%edx
                      	    63: 	.ifc \arg1, cs
                      	    64: 	mov $C_SEG_PROT32,%dx
                      	    65: 	%else
                      	    66: 	mov $D1_SEG_PROT,%dx
                      	    67: 	%endif
                      	    68: 
                      	    69: 	# MOV reg to Sreg
                      	    70: 	.ifc \arg1, cs
                      	    71: 	loadProtModeStack
                      	    72: 	protModeFaultTest EX_UD, $0, "mov %dx", \arg1 	# #UD: attempt is made to load the CS register.
                      	    73: 	.else
                      	    74: 	mov %dx,%\arg1
                      	    75: 	.endif
                      	    76: 
                      	    77: 	# MOV Sreg to 16 bit reg
                      	    78: 	xor %ax,%ax
                      	    79: 	mov %\arg1,%ax
                      	    80: 	cmp %dx,%ax
                      	    81: 	jne error
                      	    82: 
                      	    83: 	# MOV Sreg to 32 bit reg
                      	    84: 	mov $-1,%eax
                      	    85: 	mov %\arg1,%eax
                      	    86: 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    87: 	# TODO: verify on real hw and check TEST_UNDEF
                      	    88: 	cmp %dx,%ax
                      	    89: 	jne error
                      	    90: 
                      	    91: 	# MOV Sreg to word mem
                      	    92: 	movl $-1,0
                      	    93: 	mov %\arg1,0
                      	    94: 	cmp %edx,0
                      	    95: 	jne error
                      	    96: 
                      	    97: 	# MOV word mem to Sreg
                      	    98: 	.ifc \arg1, cs
                      	    99: 	protModeFaultTest EX_UD, $0, "mov 0", \arg1 # test for #UD
                      	   100: 	.else
                      	   101: 	mov %ds,%cx 	# save current DS in CX
                      	   102: 	mov $DTEST_SEG_PROT,%ax
                      	   103: 	mov %ax,%\arg1
                      	   104: 	.ifc \arg1, ds
                      	   105: 	mov %cx,%es
                      	   106: 	mov %es:0,%\arg1
                      	   107: 	.else
                      	   108: 	mov 0,%\arg1
                      	   109: 	.endif
                      	   110: 	mov %\arg1,%ax
                      	   111: 	cmp %dx,%ax
                      	   112: 	jne error
                      	   113: 	.endif
                      	   114: 
                      	   115: 	loadProtModeStack
                      	   116: 	.ifc \arg1, ss
                      	   117: 	# #GP(0) If attempt is made to load SS register with NULL segment selector.
                      	   118: 	mov $NULL,%ax
                      	   119: 	protModeFaultTest EX_GP, $0, "mov %ax", \arg1
                      	   120: 	# #GP(selector) If the SS register is being loaded and the segment selector's RPL and the segment descriptor’s DPL are
                      	   121: 	mov $DPL1_SEG_PROT|1,%ax
                      	   122: 	protModeFaultTest EX_GP, $DPL1_SEG_PROT, "mov %ax" ,\arg1
                      	   123: 	# #GP(selector) If the SS register is being loaded and the segment pointed to is a non-writable data segment.
                      	   124: 	mov $RO_SEG_PROT,%ax
                      	   125: 	protModeFaultTest EX_GP, $RO_SEG_PROT, "mov %ax", \arg1
                      	   126: 	# #SS(selector) If the SS register is being loaded and the segment pointed to is marked not present.
                      	   127: 	mov $NP_SEG_PROT,%ax
                      	   128: 	protModeFaultTest EX_SS, $NP_SEG_PROT, "mov %ax", \arg1
                      	   129: 	.endif
                      	   130: 	.ifnc \arg1, cs
                      	   131: 	# #GP(selector) If segment selector index is outside descriptor table limits.
                      	   132: 	mov $0xFFF8,%ax
                      	   133: 	protModeFaultTest EX_GP, $0xfff8, "mov %ax", \arg1
                      	   134: 	.ifnc \arg1, ss
                      	   135: 	# #NP(selector) If the DS, ES, FS, or GS register is being loaded and the segment pointed to is marked not present.
                      	   136: 	mov $NP_SEG_PROT,%ax
                      	   137: 	protModeFaultTest EX_NP, $NP_SEG_PROT, "mov %ax", \arg1
                      	   138: 	# #GP(selector) If the DS, ES, FS, or GS register is being loaded and the segment pointed to is not a data or readable
                      	   139: 	mov $SYS_SEG_PROT,%ax
                      	   140: 	protModeFaultTest EX_GP, $SYS_SEG_PROT, "mov %ax", \arg1
                      	   141: 	# #GP(selector)
                      	   142: 	# If the DS, ES, FS, or GS register is being loaded and the segment pointed to is a data or nonconforming code segment
                      	   143: 	call switchToRing3 # CPL=3
                      	   144: 	mov $DTEST_SEG_PROT|3,%ax 	# RPL=3,DPL=0
                      	   145: 	protModeFaultTest EX_GP, $DTEST_SEG_PROT, "mov %ax", \arg1
                      	   146: 	call switchToRing0
                      	   147: 	.endif
                      	   148: 	.endif
                      	   149: 
                      	   150: .endm
                      	   151: 

Source: "t386.asm"
                      	   210: #-------------------------------------------------------------------------------
                      	   211: 	POST $0x03
04:000003D4 B003      	     1M 	movb $0x03,%al
04:000003D6 BA9001    	     2M 	movw $POST_PORT,%dx
04:000003D9 EE        	     3M 	out %al,%dx
                      	   212: #-------------------------------------------------------------------------------
                      	   213: #
                      	   214: #   Move segment registers in real mode
                      	   215: #
                      	   216: 	testMovSegR_real ss
                      	     1M 	.ifc ss, cs
                      	     2M 	mov $C_SEG_REAL,%dx
                      	     3M 	.else
04:000003DA C7C200C0  	     4M 	mov $D1_SEG_REAL,%dx
                      	     5M 	.endif
                      	     6M 
                      	     7M 	# MOV reg to Sreg
                      	     8M 	.ifc ss, cs
                      	     9M 	realModeFaultTest EX_UD, "mov %dx", ss # test for #UD
                      	    10M 	.else
04:000003DE 8ED2      	    11M 	mov %dx,%ss
                      	    12M 	.endif
                      	    13M 
                      	    14M 	# MOV Sreg to 16 bit reg
04:000003E0 31C0      	    15M 	xor %ax,%ax
04:000003E2 8CD0      	    16M 	mov %ss,%ax
04:000003E4 39D0      	    17M 	cmp %dx,%ax
04:000003E6 0F855514  	    18M 	jne error
                      	    19M 
                      	    20M 	# MOV Sreg to 32 bit reg
04:000003EA 66B8FFFFFF	    21M 	mov $-1,%eax
04:000003EF FF
04:000003F0 668CD0    	    22M 	mov %ss,%eax
                      	    23M 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    24M 	# TODO: verify on real hw and check TEST_UNDEF
04:000003F3 39D0      	    25M 	cmp %dx,%ax
04:000003F5 0F854614  	    26M 	jne error
                      	    27M 
                      	    28M 	# MOV Sreg to word mem
04:000003F9 C7060000EF	    29M 	movw $0xbeef,0
04:000003FE BE
04:000003FF 8C160000  	    30M 	mov %ss,0
04:00000403 39160000  	    31M 	cmp %dx,0
04:00000407 0F853414  	    32M 	jne error
                      	    33M 
                      	    34M 	# MOV word mem to Sreg
                      	    35M 	.ifc ss, cs
                      	    36M 	realModeFaultTest EX_UD, "mov 0", ss # test for #UD
                      	    37M 	.else
04:0000040B 8CD9      	    38M 	mov %ds,%cx	 	# save current DS in CX
04:0000040D 31C0      	    39M 	xor %ax,%ax
04:0000040F 8ED0      	    40M 	mov %ax,%ss
                      	    41M 	.ifc ss, ds
                      	    42M 	mov %cx,%es
                      	    43M 	mov %es:0,%ss
                      	    44M 	.else
04:00000411 8E160000  	    45M 	mov 0,%ss
                      	    46M 	.endif
04:00000415 8CD0      	    47M 	mov %ss,%ax
04:00000417 39D0      	    48M 	cmp %dx,%ax
04:00000419 0F852214  	    49M 	jne error
                      	    50M 	.endif
                      	    51M 
                      	   217: 	testMovSegR_real ds
                      	     1M 	.ifc ds, cs
                      	     2M 	mov $C_SEG_REAL,%dx
                      	     3M 	.else
04:0000041D C7C200C0  	     4M 	mov $D1_SEG_REAL,%dx
                      	     5M 	.endif
                      	     6M 
                      	     7M 	# MOV reg to Sreg
                      	     8M 	.ifc ds, cs
                      	     9M 	realModeFaultTest EX_UD, "mov %dx", ds # test for #UD
                      	    10M 	.else
04:00000421 8EDA      	    11M 	mov %dx,%ds
                      	    12M 	.endif
                      	    13M 
                      	    14M 	# MOV Sreg to 16 bit reg
04:00000423 31C0      	    15M 	xor %ax,%ax
04:00000425 8CD8      	    16M 	mov %ds,%ax
04:00000427 39D0      	    17M 	cmp %dx,%ax
04:00000429 0F851214  	    18M 	jne error
                      	    19M 
                      	    20M 	# MOV Sreg to 32 bit reg
04:0000042D 66B8FFFFFF	    21M 	mov $-1,%eax
04:00000432 FF
04:00000433 668CD8    	    22M 	mov %ds,%eax
                      	    23M 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    24M 	# TODO: verify on real hw and check TEST_UNDEF
04:00000436 39D0      	    25M 	cmp %dx,%ax
04:00000438 0F850314  	    26M 	jne error
                      	    27M 
                      	    28M 	# MOV Sreg to word mem
04:0000043C C7060000EF	    29M 	movw $0xbeef,0
04:00000441 BE
04:00000442 8C1E0000  	    30M 	mov %ds,0
04:00000446 39160000  	    31M 	cmp %dx,0
04:0000044A 0F85F113  	    32M 	jne error
                      	    33M 
                      	    34M 	# MOV word mem to Sreg
                      	    35M 	.ifc ds, cs
                      	    36M 	realModeFaultTest EX_UD, "mov 0", ds # test for #UD
                      	    37M 	.else
04:0000044E 8CD9      	    38M 	mov %ds,%cx	 	# save current DS in CX
04:00000450 31C0      	    39M 	xor %ax,%ax
04:00000452 8ED8      	    40M 	mov %ax,%ds
                      	    41M 	.ifc ds, ds
04:00000454 8EC1      	    42M 	mov %cx,%es
04:00000456 268E1E0000	    43M 	mov %es:0,%ds
                      	    44M 	.else
                      	    45M 	mov 0,%ds
                      	    46M 	.endif
04:0000045B 8CD8      	    47M 	mov %ds,%ax
04:0000045D 39D0      	    48M 	cmp %dx,%ax
04:0000045F 0F85DC13  	    49M 	jne error
                      	    50M 	.endif
                      	    51M 
                      	   218: 	testMovSegR_real es
                      	     1M 	.ifc es, cs
                      	     2M 	mov $C_SEG_REAL,%dx
                      	     3M 	.else
04:00000463 C7C200C0  	     4M 	mov $D1_SEG_REAL,%dx
                      	     5M 	.endif
                      	     6M 
                      	     7M 	# MOV reg to Sreg
                      	     8M 	.ifc es, cs
                      	     9M 	realModeFaultTest EX_UD, "mov %dx", es # test for #UD
                      	    10M 	.else
04:00000467 8EC2      	    11M 	mov %dx,%es
                      	    12M 	.endif
                      	    13M 
                      	    14M 	# MOV Sreg to 16 bit reg
04:00000469 31C0      	    15M 	xor %ax,%ax
04:0000046B 8CC0      	    16M 	mov %es,%ax
04:0000046D 39D0      	    17M 	cmp %dx,%ax
04:0000046F 0F85CC13  	    18M 	jne error
                      	    19M 
                      	    20M 	# MOV Sreg to 32 bit reg
04:00000473 66B8FFFFFF	    21M 	mov $-1,%eax
04:00000478 FF
04:00000479 668CC0    	    22M 	mov %es,%eax
                      	    23M 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    24M 	# TODO: verify on real hw and check TEST_UNDEF
04:0000047C 39D0      	    25M 	cmp %dx,%ax
04:0000047E 0F85BD13  	    26M 	jne error
                      	    27M 
                      	    28M 	# MOV Sreg to word mem
04:00000482 C7060000EF	    29M 	movw $0xbeef,0
04:00000487 BE
04:00000488 8C060000  	    30M 	mov %es,0
04:0000048C 39160000  	    31M 	cmp %dx,0
04:00000490 0F85AB13  	    32M 	jne error
                      	    33M 
                      	    34M 	# MOV word mem to Sreg
                      	    35M 	.ifc es, cs
                      	    36M 	realModeFaultTest EX_UD, "mov 0", es # test for #UD
                      	    37M 	.else
04:00000494 8CD9      	    38M 	mov %ds,%cx	 	# save current DS in CX
04:00000496 31C0      	    39M 	xor %ax,%ax
04:00000498 8EC0      	    40M 	mov %ax,%es
                      	    41M 	.ifc es, ds
                      	    42M 	mov %cx,%es
                      	    43M 	mov %es:0,%es
                      	    44M 	.else
04:0000049A 8E060000  	    45M 	mov 0,%es
                      	    46M 	.endif
04:0000049E 8CC0      	    47M 	mov %es,%ax
04:000004A0 39D0      	    48M 	cmp %dx,%ax
04:000004A2 0F859913  	    49M 	jne error
                      	    50M 	.endif
                      	    51M 
                      	   219: 	testMovSegR_real fs
                      	     1M 	.ifc fs, cs
                      	     2M 	mov $C_SEG_REAL,%dx
                      	     3M 	.else
04:000004A6 C7C200C0  	     4M 	mov $D1_SEG_REAL,%dx
                      	     5M 	.endif
                      	     6M 
                      	     7M 	# MOV reg to Sreg
                      	     8M 	.ifc fs, cs
                      	     9M 	realModeFaultTest EX_UD, "mov %dx", fs # test for #UD
                      	    10M 	.else
04:000004AA 8EE2      	    11M 	mov %dx,%fs
                      	    12M 	.endif
                      	    13M 
                      	    14M 	# MOV Sreg to 16 bit reg
04:000004AC 31C0      	    15M 	xor %ax,%ax
04:000004AE 8CE0      	    16M 	mov %fs,%ax
04:000004B0 39D0      	    17M 	cmp %dx,%ax
04:000004B2 0F858913  	    18M 	jne error
                      	    19M 
                      	    20M 	# MOV Sreg to 32 bit reg
04:000004B6 66B8FFFFFF	    21M 	mov $-1,%eax
04:000004BB FF
04:000004BC 668CE0    	    22M 	mov %fs,%eax
                      	    23M 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    24M 	# TODO: verify on real hw and check TEST_UNDEF
04:000004BF 39D0      	    25M 	cmp %dx,%ax
04:000004C1 0F857A13  	    26M 	jne error
                      	    27M 
                      	    28M 	# MOV Sreg to word mem
04:000004C5 C7060000EF	    29M 	movw $0xbeef,0
04:000004CA BE
04:000004CB 8C260000  	    30M 	mov %fs,0
04:000004CF 39160000  	    31M 	cmp %dx,0
04:000004D3 0F856813  	    32M 	jne error
                      	    33M 
                      	    34M 	# MOV word mem to Sreg
                      	    35M 	.ifc fs, cs
                      	    36M 	realModeFaultTest EX_UD, "mov 0", fs # test for #UD
                      	    37M 	.else
04:000004D7 8CD9      	    38M 	mov %ds,%cx	 	# save current DS in CX
04:000004D9 31C0      	    39M 	xor %ax,%ax
04:000004DB 8EE0      	    40M 	mov %ax,%fs
                      	    41M 	.ifc fs, ds
                      	    42M 	mov %cx,%es
                      	    43M 	mov %es:0,%fs
                      	    44M 	.else
04:000004DD 8E260000  	    45M 	mov 0,%fs
                      	    46M 	.endif
04:000004E1 8CE0      	    47M 	mov %fs,%ax
04:000004E3 39D0      	    48M 	cmp %dx,%ax
04:000004E5 0F855613  	    49M 	jne error
                      	    50M 	.endif
                      	    51M 
                      	   220: 	testMovSegR_real gs
                      	     1M 	.ifc gs, cs
                      	     2M 	mov $C_SEG_REAL,%dx
                      	     3M 	.else
04:000004E9 C7C200C0  	     4M 	mov $D1_SEG_REAL,%dx
                      	     5M 	.endif
                      	     6M 
                      	     7M 	# MOV reg to Sreg
                      	     8M 	.ifc gs, cs
                      	     9M 	realModeFaultTest EX_UD, "mov %dx", gs # test for #UD
                      	    10M 	.else
04:000004ED 8EEA      	    11M 	mov %dx,%gs
                      	    12M 	.endif
                      	    13M 
                      	    14M 	# MOV Sreg to 16 bit reg
04:000004EF 31C0      	    15M 	xor %ax,%ax
04:000004F1 8CE8      	    16M 	mov %gs,%ax
04:000004F3 39D0      	    17M 	cmp %dx,%ax
04:000004F5 0F854613  	    18M 	jne error
                      	    19M 
                      	    20M 	# MOV Sreg to 32 bit reg
04:000004F9 66B8FFFFFF	    21M 	mov $-1,%eax
04:000004FE FF
04:000004FF 668CE8    	    22M 	mov %gs,%eax
                      	    23M 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    24M 	# TODO: verify on real hw and check TEST_UNDEF
04:00000502 39D0      	    25M 	cmp %dx,%ax
04:00000504 0F853713  	    26M 	jne error
                      	    27M 
                      	    28M 	# MOV Sreg to word mem
04:00000508 C7060000EF	    29M 	movw $0xbeef,0
04:0000050D BE
04:0000050E 8C2E0000  	    30M 	mov %gs,0
04:00000512 39160000  	    31M 	cmp %dx,0
04:00000516 0F852513  	    32M 	jne error
                      	    33M 
                      	    34M 	# MOV word mem to Sreg
                      	    35M 	.ifc gs, cs
                      	    36M 	realModeFaultTest EX_UD, "mov 0", gs # test for #UD
                      	    37M 	.else
04:0000051A 8CD9      	    38M 	mov %ds,%cx	 	# save current DS in CX
04:0000051C 31C0      	    39M 	xor %ax,%ax
04:0000051E 8EE8      	    40M 	mov %ax,%gs
                      	    41M 	.ifc gs, ds
                      	    42M 	mov %cx,%es
                      	    43M 	mov %es:0,%gs
                      	    44M 	.else
04:00000520 8E2E0000  	    45M 	mov 0,%gs
                      	    46M 	.endif
04:00000524 8CE8      	    47M 	mov %gs,%ax
04:00000526 39D0      	    48M 	cmp %dx,%ax
04:00000528 0F851313  	    49M 	jne error
                      	    50M 	.endif
                      	    51M 
                      	   221: 	testMovSegR_real cs
                      	     1M 	.ifc cs, cs
04:0000052C BA0000    	     2M 	mov $C_SEG_REAL,%dx
                      	     3M 	.else
                      	     4M 	mov $D1_SEG_REAL,%dx
                      	     5M 	.endif
                      	     6M 
                      	     7M 	# MOV reg to Sreg
                      	     8M 	.ifc cs, cs
                      	     9M 	realModeFaultTest EX_UD, "mov %dx", cs # test for #UD
                      	     1M 	realModeExcInit EX_UD,continue25
04:0000052F B80090    	     1M 	mov $IDT_SEG_REAL,%ax
04:00000532 8ED8      	     2M 	mov %ax,%ds
04:00000534 C70618004D	     3M 	movw $continue25,EX_UD*4
04:00000539 05
04:0000053A C7061A0000	     4M 	movw $C_SEG_REAL,EX_UD*4+2
04:0000053F 00
04:00000540 B800C0    	     2M 	mov $S_SEG_REAL,%ax
04:00000543 8ED0      	     3M 	mov %ax,%ss
04:00000545 BCFC7F    	     4M 	mov $ESP_REAL,%sp
                      	     5M test25:
04:00000548 8ECA      	     6M 	mov %dx,%cs
04:0000054A E9F212    	     7M 	jmp error
                      	     8M continue25:
                      	     9M 	realModeExcCheck EX_UD,test25
04:0000054D 81FCF67F  	     1M 	cmp $ESP_REAL-6,%sp
04:00000551 0F85EA12  	     2M 	jne error
04:00000555 36833EF87F	     3M 	cmpw $C_SEG_REAL,%ss:ESP_REAL-4
04:0000055A 00
04:0000055B 0F85E012  	     4M 	jne error
04:0000055F 36813EF67F	     5M 	cmpw $test25,%ss:ESP_REAL-6
04:00000564 4805
04:00000566 0F85D512  	     6M 	jne error
04:0000056A B80000    	     7M 	mov $0,%ax
04:0000056D 8ED8      	     8M 	mov %ax,%ds
04:0000056F C70618003F	     9M 	movw $error,EX_UD*4
04:00000574 18
04:00000575 C7061A0000	    10M 	movw $C_SEG_REAL,EX_UD*4+2
04:0000057A 00
                      	    10M 	.else
                      	    11M 	mov %dx,%cs
                      	    12M 	.endif
                      	    13M 
                      	    14M 	# MOV Sreg to 16 bit reg
04:0000057B 31C0      	    15M 	xor %ax,%ax
04:0000057D 8CC8      	    16M 	mov %cs,%ax
04:0000057F 39D0      	    17M 	cmp %dx,%ax
04:00000581 0F85BA12  	    18M 	jne error
                      	    19M 
                      	    20M 	# MOV Sreg to 32 bit reg
04:00000585 66B8FFFFFF	    21M 	mov $-1,%eax
04:0000058A FF
04:0000058B 668CC8    	    22M 	mov %cs,%eax
                      	    23M 	# bits 31:16 are undefined for Pentium and earlier processors.
                      	    24M 	# TODO: verify on real hw and check TEST_UNDEF
04:0000058E 39D0      	    25M 	cmp %dx,%ax
04:00000590 0F85AB12  	    26M 	jne error
                      	    27M 
                      	    28M 	# MOV Sreg to word mem
04:00000594 C7060000EF	    29M 	movw $0xbeef,0
04:00000599 BE
04:0000059A 8C0E0000  	    30M 	mov %cs,0
04:0000059E 39160000  	    31M 	cmp %dx,0
04:000005A2 0F859912  	    32M 	jne error
                      	    33M 
                      	    34M 	# MOV word mem to Sreg
                      	    35M 	.ifc cs, cs
                      	    36M 	realModeFaultTest EX_UD, "mov 0", cs # test for #UD
                      	     1M 	realModeExcInit EX_UD,continue28
04:000005A6 B80090    	     1M 	mov $IDT_SEG_REAL,%ax
04:000005A9 8ED8      	     2M 	mov %ax,%ds
04:000005AB C7061800C6	     3M 	movw $continue28,EX_UD*4
04:000005B0 05
04:000005B1 C7061A0000	     4M 	movw $C_SEG_REAL,EX_UD*4+2
04:000005B6 00
04:000005B7 B800C0    	     2M 	mov $S_SEG_REAL,%ax
04:000005BA 8ED0      	     3M 	mov %ax,%ss
04:000005BC BCFC7F    	     4M 	mov $ESP_REAL,%sp
                      	     5M test28:
04:000005BF 8E0E0000  	     6M 	mov 0,%cs
04:000005C3 E97912    	     7M 	jmp error
                      	     8M continue28:
                      	     9M 	realModeExcCheck EX_UD,test28
04:000005C6 81FCF67F  	     1M 	cmp $ESP_REAL-6,%sp
04:000005CA 0F857112  	     2M 	jne error
04:000005CE 36833EF87F	     3M 	cmpw $C_SEG_REAL,%ss:ESP_REAL-4
04:000005D3 00
04:000005D4 0F856712  	     4M 	jne error
04:000005D8 36813EF67F	     5M 	cmpw $test28,%ss:ESP_REAL-6
04:000005DD BF05
04:000005DF 0F855C12  	     6M 	jne error
04:000005E3 B80000    	     7M 	mov $0,%ax
04:000005E6 8ED8      	     8M 	mov %ax,%ds
04:000005E8 C70618003F	     9M 	movw $error,EX_UD*4
04:000005ED 18
04:000005EE C7061A0000	    10M 	movw $C_SEG_REAL,EX_UD*4+2
04:000005F3 00
                      	    37M 	.else
                      	    38M 	mov %ds,%cx	 	# save current DS in CX
                      	    39M 	xor %ax,%ax
                      	    40M 	mov %ax,%cs
                      	    41M 	.ifc cs, ds
                      	    42M 	mov %cx,%es
                      	    43M 	mov %es:0,%cs
                      	    44M 	.else
                      	    45M 	mov 0,%cs
                      	    46M 	.endif
                      	    47M 	mov %cs,%ax
                      	    48M 	cmp %dx,%ax
                      	    49M 	jne error
                      	    50M 	.endif
                      	    51M 
                      	   222: 
                      	   223: 	advTestSegReal
                      	     1M 	advTestBase
                      	     1M 	.set TEST_BASE1,TEST_BASE1+0x1000
                      	     2M 	.set TEST_BASE2,TEST_BASE2+0x1000
                      	     2M 	.set D1_SEG_REAL,TEST_BASE1 >> 4
                      	     3M 	.set D2_SEG_REAL,TEST_BASE2 >> 4
04:000005F4 C7C200C1  	     4M 	mov $D1_SEG_REAL,%dx
04:000005F8 8EDA      	     5M 	mov %dx,%ds
04:000005FA C7C200C3  	     6M 	mov $D2_SEG_REAL,%dx
04:000005FE 8EC2      	     7M 	mov %dx,%es
                      	   224: 
                      	   225: .include "string_m.asm"

Source: "string_m.asm"
                      	     1: #
                      	     2: #   Tests store, compare, scan, and move string operands
                      	     3: #   %1 data size b=byte, w=word, d=dword
                      	     4: #   %2 direction 0=increment, 1=decrement
                      	     5: #   %3 addressing a16=16-bit, a32=32-bit
                      	     6: #   DS test segment 1
                      	     7: #   ES test segment 2
                      	     8: #
                      	     9: .macro testStringOps arg1,arg2,arg3
                      	    10: 
                      	    11: 	.set value,0x12345678
                      	    12: 	.if \arg1 = b
                      	    13: 		.set val_size,1
                      	    14: 		.set val_mask,0x000000ff
                      	    15: 	.endif
                      	    16: 	.if \arg1 = w
                      	    17: 		.set val_size,2
                      	    18: 		.set val_mask,0x0000ffff
                      	    19: 	.endif
                      	    20: 	.if \arg1 = d
                      	    21: 		.set val_size,4
                      	    22: 		.set val_mask,0xffffffff
                      	    23: 	.endif
                      	    24: 
                      	    25: 	.if \arg2 == 0
                      	    26: 		cld
                      	    27: 		.set off_value,0x0001ffff-(val_size-1)
                      	    28: 		.if \arg3 = 16
                      	    29: 			# 16-bit addressing
                      	    30: 			.set off_cmp,0x00010000
                      	    31: 		.else
                      	    32: 			# 32-bit addressing
                      	    33: 			.set off_cmp,0x00020000
                      	    34: 		.endif
                      	    35: 	.else
                      	    36: 		std
                      	    37: 		.set off_value,0x00010000
                      	    38: 		.if \arg3 = 16
                      	    39: 			# 16-bit addressing
                      	    40: 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    41: 		.else
                      	    42: 			# 32-bit addressing
                      	    43: 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    44: 		.endif
                      	    45: 	.endif
                      	    46: 
                      	    47: 	.if \arg3 = 16
                      	    48: 		.set off_mask,0x0000ffff
                      	    49: 	.else
                      	    50: 		.set off_mask,0xffffffff
                      	    51: 	.endif
                      	    52: 
                      	    53: 	# VERIFY string operands
                      	    54: 	.if \arg1 = b
                      	    55: 		mov $off_value,%edi
                      	    56: 		mov $off_value & off_mask,%ebx
                      	    57: 		mov $0,%al
                      	    58: 		mov %al,%es:(%ebx)
                      	    59: 		mov $value,%al
                      	    60: 		addr\arg3
                      	    61: 		stosb		 	# STORE EAX in ES:EDI
                      	    62: 		.if \arg3 = 16
                      	    63: 			addr32
                      	    64: 			cmp %al,%es:(%ebx)
                      	    65: 		.else
                      	    66: 			cmp %al,%es:(%ebx)
                      	    67: 		.endif
                      	    68: 		jne error
                      	    69: 		cmp $off_cmp,%edi
                      	    70: 		jne error
                      	    71: 
                      	    72: 		mov $off_value,%esi
                      	    73: 		mov $off_value,%edi
                      	    74: 		mov $off_value & off_mask,%ebx
                      	    75: 		mov %al,%ds:(%ebx)
                      	    76: 		mov %al,%es:(%ebx)
                      	    77: 		cmp $0,%al
                      	    78: 		je error
                      	    79: 		addr\arg3
                      	    80: 		cmpsb     # COMPARE ES:EDI with DS:ESI
                      	    81: 		jne error
                      	    82: 		cmp $off_cmp,%edi
                      	    83: 		jne error
                      	    84: 		cmp $off_cmp,%esi
                      	    85: 		jne error
                      	    86: 
                      	    87: 		mov $off_value,%edi
                      	    88: 		mov $value,%al
                      	    89: 		mov %al,%es:(%ebx)
                      	    90: 		cmp $0,%al
                      	    91: 		addr\arg3
                      	    92: 		scasb     # SCAN/COMPARE ES:EDI with EAX
                      	    93: 		jne error
                      	    94: 		cmp $off_cmp,%edi
                      	    95: 		jne error
                      	    96: 
                      	    97: 		mov $off_value,%esi
                      	    98: 		mov $off_value,%edi
                      	    99: 		mov $value,%al
                      	   100: 		mov %al,%ds:(%ebx)
                      	   101: 		mov $0,%al
                      	   102: 		mov %al,%es:(%ebx)
                      	   103: 		addr\arg3
                      	   104: 		movsb        # MOVE data from DS:ESI to ES:EDI
                      	   105: 		mov $value,%al
                      	   106: 		.if \arg3 = 16
                      	   107: 			addr32
                      	   108: 			cmp %al,%es:(%ebx)
                      	   109: 		.else
                      	   110: 			cmp %al,%es:(%ebx)
                      	   111: 		.endif
                      	   112: 		jne error
                      	   113: 		cmp $off_cmp,%edi
                      	   114: 		jne error
                      	   115: 		cmp $off_cmp,%esi
                      	   116: 		jne error
                      	   117: 
                      	   118: 		mov $off_value,%esi
                      	   119: 		mov $value,%al
                      	   120: 		mov %al,%es:(%ebx)
                      	   121: 		xor %eax,%eax
                      	   122: 		addr\arg3
                      	   123: 		lodsb       # LOAD data from DS:ESI into EAX
                      	   124: 		cmp $value & val_mask,%al
                      	   125: 		jne error
                      	   126: 		cmp $off_cmp,%esi
                      	   127: 		jne error
                      	   128: 	.endif
                      	   129: 
                      	   130: 	.if \arg1 = w
                      	   131: 		mov $off_value,%edi
                      	   132: 		mov $off_value & off_mask,%ebx
                      	   133: 		mov $0,%ax
                      	   134: 		mov %ax,%es:(%ebx)
                      	   135: 		mov $value,%ax
                      	   136: 		addr\arg3
                      	   137: 		stosw     # STORE EAX in ES:EDI
                      	   138: 		.if \arg3 = 16
                      	   139: 			addr32
                      	   140: 			cmp %ax,%es:(%ebx)
                      	   141: 		.else
                      	   142: 			cmp %ax,%es:(%ebx)
                      	   143: 		.endif
                      	   144: 		jne error
                      	   145: 		cmp $off_cmp,%edi
                      	   146: 		jne error
                      	   147: 
                      	   148: 		mov $off_value,%esi
                      	   149: 		mov $off_value,%edi
                      	   150: 		mov $off_value & off_mask,%ebx
                      	   151: 		mov %ax,%ds:(%ebx)
                      	   152: 		mov %ax,%es:(%ebx)
                      	   153: 		cmp $0,%ax
                      	   154: 		je error
                      	   155: 		addr\arg3
                      	   156: 		cmpsw     # COMPARE ES:EDI with DS:ESI
                      	   157: 		jne error
                      	   158: 		cmp $off_cmp,%edi
                      	   159: 		jne error
                      	   160: 		cmp $off_cmp,%esi
                      	   161: 		jne error
                      	   162: 
                      	   163: 		mov $off_value,%edi
                      	   164: 		mov $value,%ax
                      	   165: 		mov %ax,%es:(%ebx)
                      	   166: 		cmp $0,%ax
                      	   167: 		addr\arg3
                      	   168: 		scasw     # SCAN/COMPARE ES:EDI with EAX
                      	   169: 		jne error
                      	   170: 		cmp $off_cmp,%edi
                      	   171: 		jne error
                      	   172: 
                      	   173: 		mov $off_value,%esi
                      	   174: 		mov $off_value,%edi
                      	   175: 		mov $value,%ax
                      	   176: 		mov %ax,%ds:(%ebx)
                      	   177: 		mov $0,%ax
                      	   178: 		mov %ax,%es:(%ebx)
                      	   179: 		addr\arg3
                      	   180: 		movsw 					# MOVE data from DS:ESI to ES:EDI
                      	   181: 		mov $value,%ax
                      	   182: 		.if \arg3 = 16
                      	   183: 			addr32
                      	   184: 			cmp %ax,%es:(%ebx)
                      	   185: 		.else
                      	   186: 			cmp %ax,%es:(%ebx)
                      	   187: 		.endif
                      	   188: 		jne error
                      	   189: 		cmp $off_cmp,%edi
                      	   190: 		jne error
                      	   191: 		cmp $off_cmp,%esi
                      	   192: 		jne error
                      	   193: 
                      	   194: 		mov $off_value,%esi
                      	   195: 		mov $value,%ax
                      	   196: 		mov %ax,%es:(%ebx)
                      	   197: 		xor %eax,%eax
                      	   198: 		addr\arg3
                      	   199: 		lodsw       # LOAD data from DS:ESI into EAX
                      	   200: 		cmp $value & val_mask,%ax
                      	   201: 		jne error
                      	   202: 		cmp $off_cmp,%esi
                      	   203: 		jne error
                      	   204: 	.endif
                      	   205: 
                      	   206: 	.if \arg1 = d
                      	   207: 		mov $off_value,%edi
                      	   208: 		mov $off_value & off_mask,%ebx
                      	   209: 		mov $0,%eax
                      	   210: 		mov %eax,%es:(%ebx)
                      	   211: 		mov $value,%eax
                      	   212: 		addr\arg3
                      	   213: 		stosl     # STORE EAX in ES:EDI
                      	   214: 		.if \arg3 = 16
                      	   215: 			addr32
                      	   216: 			cmp %eax,%es:(%ebx)
                      	   217: 		.else
                      	   218: 			cmp %eax,%es:(%ebx)
                      	   219: 		.endif
                      	   220: 		jne error
                      	   221: 		cmp $off_cmp,%edi
                      	   222: 		jne error
                      	   223: 
                      	   224: 		mov $off_value,%esi
                      	   225: 		mov $off_value,%edi
                      	   226: 		mov $off_value & off_mask,%ebx
                      	   227: 		mov %eax,%ds:(%ebx)
                      	   228: 		mov %eax,%es:(%ebx)
                      	   229: 		cmp $0,%eax
                      	   230: 		je error
                      	   231: 		addr\arg3
                      	   232: 		cmpsl     # COMPARE ES:EDI with DS:ESI
                      	   233: 		jne error
                      	   234: 		cmp $off_cmp,%edi
                      	   235: 		jne error
                      	   236: 		cmp $off_cmp,%esi
                      	   237: 		jne error
                      	   238: 
                      	   239: 		mov $off_value,%edi
                      	   240: 		mov $value,%eax
                      	   241: 		mov %eax,%es:(%ebx)
                      	   242: 		cmp $0,%eax
                      	   243: 		addr\arg3
                      	   244: 		scasl     # SCAN/COMPARE ES:EDI with EAX
                      	   245: 		jne error
                      	   246: 		cmp $off_cmp,%edi
                      	   247: 		jne error
                      	   248: 
                      	   249: 		mov $off_value,%esi
                      	   250: 		mov $off_value,%edi
                      	   251: 		mov $value,%eax
                      	   252: 		mov %eax,%ds:(%ebx)
                      	   253: 		mov $0,%eax
                      	   254: 		mov %eax,%es:(%ebx)
                      	   255: 		addr\arg3
                      	   256: 		movsl        # MOVE data from DS:ESI to ES:EDI
                      	   257: 		mov $value,%eax
                      	   258: 		.if \arg3 = 16
                      	   259: 			addr32
                      	   260: 			cmp %eax,%es:(%ebx)
                      	   261: 		.else
                      	   262: 			cmp %eax,%es:(%ebx)
                      	   263: 		.endif
                      	   264: 		jne error
                      	   265: 		cmp $off_cmp,%edi
                      	   266: 		jne error
                      	   267: 		cmp $off_cmp,%esi
                      	   268: 		jne error
                      	   269: 
                      	   270: 		mov $off_value,%esi
                      	   271: 		mov $value,%eax
                      	   272: 		mov %eax,%es:(%ebx)
                      	   273: 		xor %eax,%eax
                      	   274: 		addr\arg3
                      	   275: 		lodsl       # LOAD data from DS:ESI into EAX
                      	   276: 		cmp $value & val_mask,%eax
                      	   277: 		jne error
                      	   278: 		cmp $off_cmp,%esi
                      	   279: 		jne error
                      	   280: 	.endif
                      	   281: 
                      	   282: .endm
                      	   283: 
                      	   284: #
                      	   285: #   Tests store, compare, scan, and move string operands with repetitions
                      	   286: #   %1 element size b=byte, w=word, d=dword
                      	   287: #   %2 direction 0=increment, 1=decrement
                      	   288: #   %3 addressing a16=16-bit, a32=32-bit
                      	   289: #   DS test segment 1
                      	   290: #   ES test segment 2
                      	   291: #
                      	   292: .macro testStringReps arg1,arg2,arg3
                      	   293: 
                      	   294: 	.set bytes,0x100
                      	   295: 
                      	   296: 	.if \arg1 = b
                      	   297: 		.set items,bytes
                      	   298: 	.endif
                      	   299: 	.if \arg1 = w
                      	   300: 		.set items,bytes/2
                      	   301: 	.endif
                      	   302: 	.if \arg1 = d
                      	   303: 		.set items,bytes/4
                      	   304: 	.endif
                      	   305: 
                      	   306: 	.if \arg2 == 0
                      	   307: 		cld
                      	   308: 		.set off_value,0x0001ff00
                      	   309: 		.if \arg3 = 16
                      	   310: 			# 16-bit addressing
                      	   311: 			.set off_cmp,0x00010000
                      	   312: 		.else
                      	   313: 			# 32-bit addressing
                      	   314: 			.set off_cmp,0x00020000
                      	   315: 		.endif
                      	   316: 	.else
                      	   317: 		std
                      	   318: 		.set off_value,0x000100ff
                      	   319: 		.if \arg3 = 16
                      	   320: 			# 16-bit addressing
                      	   321: 			.set off_cmp,0x0001ffff
                      	   322: 		.else
                      	   323: 			# 32-bit addressing
                      	   324: 			.set off_cmp,0x0000ffff
                      	   325: 		.endif
                      	   326: 	.endif
                      	   327: 
                      	   328: 	mov $0x12345678,%eax
                      	   329: 	mov $off_value,%esi
                      	   330: 	mov $off_value,%edi
                      	   331: 
                      	   332: 	# VERIFY REPs on memory buffers
                      	   333: 
                      	   334: 	# STORE buffers with pattern in EAX
                      	   335: 	mov $0x12345678,%eax
                      	   336: 	mov $off_value,%esi
                      	   337: 	mov $off_value,%edi
                      	   338: 	mov $items,%ecx
                      	   339: 	.if \arg1 = b
                      	   340: 		addr\arg3
                      	   341: 		rep
                      	   342: 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	   343: 	.endif
                      	   344: 	.if \arg1 = w
                      	   345: 		addr\arg3
                      	   346: 		rep
                      	   347: 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	   348: 	.endif
                      	   349: 	.if \arg1 = d
                      	   350: 		addr\arg3
                      	   351: 		rep
                      	   352: 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	   353: 	.endif
                      	   354: 	cmp $0,%ecx
                      	   355: 	jnz error           		# ECX must be 0
                      	   356: 	cmp $off_cmp,%edi
                      	   357: 	jnz error
                      	   358: 	mov $off_value,%edi  # reset EDI
                      	   359: 	# now switch ES:EDI with DS:ESI
                      	   360: 	mov %es,%dx
                      	   361: 	mov %ds,%cx
                      	   362: 	xchg %cx,%dx
                      	   363: 	mov %dx,%es
                      	   364: 	mov %cx,%ds
                      	   365: 	xchg %esi,%edi
                      	   366: 	# store again ES:EDI with pattern in EAX
                      	   367: 	mov $items,%ecx      	# reset ECX
                      	   368: 	.if \arg1 = b
                      	   369: 		addr\arg3
                      	   370: 		rep
                      	   371: 		stosb
                      	   372: 	.endif
                      	   373: 	.if \arg1 = w
                      	   374: 		addr\arg3
                      	   375: 		rep
                      	   376: 		stosw
                      	   377: 	.endif
                      	   378: 	.if \arg1 = d
                      	   379: 		addr\arg3
                      	   380: 		rep
                      	   381: 		stosl
                      	   382: 	.endif
                      	   383: 	mov $off_value,%edi  	# reset EDI
                      	   384: 
                      	   385: 	# COMPARE two buffers
                      	   386: 	mov $items,%ecx      # reset ECX
                      	   387: 	.if \arg1 = b
                      	   388: 		addr\arg3
                      	   389: 		repe
                      	   390: 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	   391: 	.endif
                      	   392: 	.if \arg1 = w
                      	   393: 		addr\arg3
                      	   394: 		repe
                      	   395: 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   396: 	.endif
                      	   397: 	.if \arg1 = d
                      	   398: 		addr\arg3
                      	   399: 		repe
                      	   400: 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   401: 	.endif
                      	   402: 	cmp $0,%ecx
                      	   403: 	jnz error           		# ECX must be 0
                      	   404: 	cmp $off_cmp,%esi
                      	   405: 	jne error
                      	   406: 	cmp $off_cmp,%edi
                      	   407: 	jne error
                      	   408: 	mov $off_value,%edi  # reset EDI
                      	   409: 	mov $off_value,%esi  # reset ESI
                      	   410: 
                      	   411: 	# SCAN buffer for pattern
                      	   412: 	mov $items,%ecx      # reset ECX
                      	   413: 	.if \arg1 = b
                      	   414: 		addr\arg3
                      	   415: 		repe
                      	   416: 		scasb         # SCAN first dword not equal to EAX
                      	   417: 	.endif
                      	   418: 	.if \arg1 = w
                      	   419: 		addr\arg3
                      	   420: 		repe
                      	   421: 		scasw         # SCAN first dword not equal to EAX
                      	   422: 	.endif
                      	   423: 	.if \arg1 = d
                      	   424: 		addr\arg3
                      	   425: 		repe
                      	   426: 		scasl         # SCAN first dword not equal to EAX
                      	   427: 	.endif
                      	   428: 	cmp $0,%ecx
                      	   429: 	jne error           		# ECX must be 0
                      	   430: 	cmp $off_cmp,%edi
                      	   431: 	jne error
                      	   432: 	mov $off_value,%edi  		# rewind EDI
                      	   433: 
                      	   434: 	# MOVE and COMPARE data between buffers
                      	   435: 	# first zero-fill ES:EDI so that we can compare the moved data later
                      	   436: 	mov $0,%eax
                      	   437: 	mov $items,%ecx      # reset ECX
                      	   438: 	.if \arg1 = b
                      	   439: 		addr\arg3
                      	   440: 		rep
                      	   441: 		stosb          # zero fill ES:EDI
                      	   442: 	.endif
                      	   443: 	.if \arg1 = w
                      	   444: 		addr\arg3
                      	   445: 		rep
                      	   446: 		stosw          # zero fill ES:EDI
                      	   447: 	.endif
                      	   448: 	.if \arg1 = d
                      	   449: 		addr\arg3
                      	   450: 		rep
                      	   451: 		stosl          # zero fill ES:EDI
                      	   452: 	.endif
                      	   453: 	mov $off_value,%edi  # reset EDI
                      	   454: 	mov $items,%ecx      # reset ECX
                      	   455: 	.if \arg1 = b
                      	   456: 		addr\arg3
                      	   457: 		rep
                      	   458: 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   459: 	.endif
                      	   460: 	.if \arg1 = w
                      	   461: 		addr\arg3
                      	   462: 		rep
                      	   463: 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   464: 	.endif
                      	   465: 	.if \arg1 = d
                      	   466: 		addr\arg3
                      	   467: 		rep
                      	   468: 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   469: 	.endif
                      	   470: 	cmp $0,%ecx
                      	   471: 	jne error           	# ECX must be 0
                      	   472: 	cmp $off_cmp,%esi
                      	   473: 	jne error
                      	   474: 	cmp $off_cmp,%edi
                      	   475: 	jne error
                      	   476: 	mov $items,%ecx      	# reset ECX
                      	   477: 	mov $off_value,%edi  	# reset EDI
                      	   478: 	mov $off_value,%esi  	# reset ESI
                      	   479: 	.if \arg1 = b
                      	   480: 		addr\arg3
                      	   481: 		repe
                      	   482: 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   483: 	.endif
                      	   484: 	.if \arg1 = w
                      	   485: 		addr\arg3
                      	   486: 		repe
                      	   487: 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   488: 	.endif
                      	   489: 	.if \arg1 = d
                      	   490: 		addr\arg3
                      	   491: 		repe
                      	   492: 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   493: 	.endif
                      	   494: 	cmp $0,%ecx
                      	   495: 	jne error           # ECX must be 0
                      	   496: 	cmp $off_cmp,%esi
                      	   497: 	jne error
                      	   498: 	cmp $off_cmp,%edi
                      	   499: 	jne error
                      	   500: .endm
                      	   501: 

Source: "t386.asm"
                      	   226: #-------------------------------------------------------------------------------
                      	   227: 	POST $0x04
04:00000600 B004      	     1M 	movb $0x04,%al
04:00000602 BA9001    	     2M 	movw $POST_PORT,%dx
04:00000605 EE        	     3M 	out %al,%dx
                      	   228: #-------------------------------------------------------------------------------
                      	   229: #
                      	   230: #   Test store, move, scan, and compare string data
                      	   231: #
                      	   232: .set b,0
                      	   233: .set w,1
                      	   234: .set d,2
                      	   235: 
                      	   236: 	testStringOps b,0,16
                      	     1M 
                      	     2M 	.set value,0x12345678
                      	     3M 	.if b = b
                      	     4M 		.set val_size,1
                      	     5M 		.set val_mask,0x000000ff
                      	     6M 	.endif
                      	     7M 	.if b = w
                      	     8M 		.set val_size,2
                      	     9M 		.set val_mask,0x0000ffff
                      	    10M 	.endif
                      	    11M 	.if b = d
                      	    12M 		.set val_size,4
                      	    13M 		.set val_mask,0xffffffff
                      	    14M 	.endif
                      	    15M 
                      	    16M 	.if 0 == 0
04:00000606 FC        	    17M 		cld
                      	    18M 		.set off_value,0x0001ffff-(val_size-1)
                      	    19M 		.if 16 = 16
                      	    20M 			# 16-bit addressing
                      	    21M 			.set off_cmp,0x00010000
                      	    22M 		.else
                      	    23M 			# 32-bit addressing
                      	    24M 			.set off_cmp,0x00020000
                      	    25M 		.endif
                      	    26M 	.else
                      	    27M 		std
                      	    28M 		.set off_value,0x00010000
                      	    29M 		.if 16 = 16
                      	    30M 			# 16-bit addressing
                      	    31M 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    32M 		.else
                      	    33M 			# 32-bit addressing
                      	    34M 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    35M 		.endif
                      	    36M 	.endif
                      	    37M 
                      	    38M 	.if 16 = 16
                      	    39M 		.set off_mask,0x0000ffff
                      	    40M 	.else
                      	    41M 		.set off_mask,0xffffffff
                      	    42M 	.endif
                      	    43M 
                      	    44M 	# VERIFY string operands
                      	    45M 	.if b = b
04:00000607 66BFFFFF01	    46M 		mov $off_value,%edi
04:0000060C 00
04:0000060D 66BBFFFF00	    47M 		mov $off_value & off_mask,%ebx
04:00000612 00
04:00000613 B000      	    48M 		mov $0,%al
04:00000615 268803    	    49M 		mov %al,%es:(%ebx)
04:00000618 C6C078    	    50M 		mov $value,%al
04:0000061B 67        	    51M 		addr16
04:0000061C AA        	    52M 		stosb		 	# STORE EAX in ES:EDI
                      	    53M 		.if 16 = 16
04:0000061D 67        	    54M 			addr32
04:0000061E 263803    	    55M 			cmp %al,%es:(%ebx)
                      	    56M 		.else
                      	    57M 			cmp %al,%es:(%ebx)
                      	    58M 		.endif
04:00000621 0F851A12  	    59M 		jne error
04:00000625 6681FF0000	    60M 		cmp $off_cmp,%edi
04:0000062A 0100
04:0000062C 0F850F12  	    61M 		jne error
                      	    62M 
04:00000630 66BEFFFF01	    63M 		mov $off_value,%esi
04:00000635 00
04:00000636 66BFFFFF01	    64M 		mov $off_value,%edi
04:0000063B 00
04:0000063C 66BBFFFF00	    65M 		mov $off_value & off_mask,%ebx
04:00000641 00
04:00000642 8803      	    66M 		mov %al,%ds:(%ebx)
04:00000644 268803    	    67M 		mov %al,%es:(%ebx)
04:00000647 3C00      	    68M 		cmp $0,%al
04:00000649 0F84F211  	    69M 		je error
04:0000064D 67        	    70M 		addr16
04:0000064E A6        	    71M 		cmpsb     # COMPARE ES:EDI with DS:ESI
04:0000064F 0F85EC11  	    72M 		jne error
04:00000653 6681FF0000	    73M 		cmp $off_cmp,%edi
04:00000658 0100
04:0000065A 0F85E111  	    74M 		jne error
04:0000065E 6681FE0000	    75M 		cmp $off_cmp,%esi
04:00000663 0100
04:00000665 0F85D611  	    76M 		jne error
                      	    77M 
04:00000669 66BFFFFF01	    78M 		mov $off_value,%edi
04:0000066E 00
04:0000066F C6C078    	    79M 		mov $value,%al
04:00000672 268803    	    80M 		mov %al,%es:(%ebx)
04:00000675 3C00      	    81M 		cmp $0,%al
04:00000677 67        	    82M 		addr16
04:00000678 AE        	    83M 		scasb     # SCAN/COMPARE ES:EDI with EAX
04:00000679 0F85C211  	    84M 		jne error
04:0000067D 6681FF0000	    85M 		cmp $off_cmp,%edi
04:00000682 0100
04:00000684 0F85B711  	    86M 		jne error
                      	    87M 
04:00000688 66BEFFFF01	    88M 		mov $off_value,%esi
04:0000068D 00
04:0000068E 66BFFFFF01	    89M 		mov $off_value,%edi
04:00000693 00
04:00000694 C6C078    	    90M 		mov $value,%al
04:00000697 8803      	    91M 		mov %al,%ds:(%ebx)
04:00000699 B000      	    92M 		mov $0,%al
04:0000069B 268803    	    93M 		mov %al,%es:(%ebx)
04:0000069E 67        	    94M 		addr16
04:0000069F A4        	    95M 		movsb        # MOVE data from DS:ESI to ES:EDI
04:000006A0 C6C078    	    96M 		mov $value,%al
                      	    97M 		.if 16 = 16
04:000006A3 67        	    98M 			addr32
04:000006A4 263803    	    99M 			cmp %al,%es:(%ebx)
                      	   100M 		.else
                      	   101M 			cmp %al,%es:(%ebx)
                      	   102M 		.endif
04:000006A7 0F859411  	   103M 		jne error
04:000006AB 6681FF0000	   104M 		cmp $off_cmp,%edi
04:000006B0 0100
04:000006B2 0F858911  	   105M 		jne error
04:000006B6 6681FE0000	   106M 		cmp $off_cmp,%esi
04:000006BB 0100
04:000006BD 0F857E11  	   107M 		jne error
                      	   108M 
04:000006C1 66BEFFFF01	   109M 		mov $off_value,%esi
04:000006C6 00
04:000006C7 C6C078    	   110M 		mov $value,%al
04:000006CA 268803    	   111M 		mov %al,%es:(%ebx)
04:000006CD 6631C0    	   112M 		xor %eax,%eax
04:000006D0 67        	   113M 		addr16
04:000006D1 AC        	   114M 		lodsb       # LOAD data from DS:ESI into EAX
04:000006D2 3C78      	   115M 		cmp $value & val_mask,%al
04:000006D4 0F856711  	   116M 		jne error
04:000006D8 6681FE0000	   117M 		cmp $off_cmp,%esi
04:000006DD 0100
04:000006DF 0F855C11  	   118M 		jne error
                      	   119M 	.endif
                      	   120M 
                      	   121M 	.if b = w
                      	   122M 		mov $off_value,%edi
                      	   123M 		mov $off_value & off_mask,%ebx
                      	   124M 		mov $0,%ax
                      	   125M 		mov %ax,%es:(%ebx)
                      	   126M 		mov $value,%ax
                      	   127M 		addr16
                      	   128M 		stosw     # STORE EAX in ES:EDI
                      	   129M 		.if 16 = 16
                      	   130M 			addr32
                      	   131M 			cmp %ax,%es:(%ebx)
                      	   132M 		.else
                      	   133M 			cmp %ax,%es:(%ebx)
                      	   134M 		.endif
                      	   135M 		jne error
                      	   136M 		cmp $off_cmp,%edi
                      	   137M 		jne error
                      	   138M 
                      	   139M 		mov $off_value,%esi
                      	   140M 		mov $off_value,%edi
                      	   141M 		mov $off_value & off_mask,%ebx
                      	   142M 		mov %ax,%ds:(%ebx)
                      	   143M 		mov %ax,%es:(%ebx)
                      	   144M 		cmp $0,%ax
                      	   145M 		je error
                      	   146M 		addr16
                      	   147M 		cmpsw     # COMPARE ES:EDI with DS:ESI
                      	   148M 		jne error
                      	   149M 		cmp $off_cmp,%edi
                      	   150M 		jne error
                      	   151M 		cmp $off_cmp,%esi
                      	   152M 		jne error
                      	   153M 
                      	   154M 		mov $off_value,%edi
                      	   155M 		mov $value,%ax
                      	   156M 		mov %ax,%es:(%ebx)
                      	   157M 		cmp $0,%ax
                      	   158M 		addr16
                      	   159M 		scasw     # SCAN/COMPARE ES:EDI with EAX
                      	   160M 		jne error
                      	   161M 		cmp $off_cmp,%edi
                      	   162M 		jne error
                      	   163M 
                      	   164M 		mov $off_value,%esi
                      	   165M 		mov $off_value,%edi
                      	   166M 		mov $value,%ax
                      	   167M 		mov %ax,%ds:(%ebx)
                      	   168M 		mov $0,%ax
                      	   169M 		mov %ax,%es:(%ebx)
                      	   170M 		addr16
                      	   171M 		movsw 					# MOVE data from DS:ESI to ES:EDI
                      	   172M 		mov $value,%ax
                      	   173M 		.if 16 = 16
                      	   174M 			addr32
                      	   175M 			cmp %ax,%es:(%ebx)
                      	   176M 		.else
                      	   177M 			cmp %ax,%es:(%ebx)
                      	   178M 		.endif
                      	   179M 		jne error
                      	   180M 		cmp $off_cmp,%edi
                      	   181M 		jne error
                      	   182M 		cmp $off_cmp,%esi
                      	   183M 		jne error
                      	   184M 
                      	   185M 		mov $off_value,%esi
                      	   186M 		mov $value,%ax
                      	   187M 		mov %ax,%es:(%ebx)
                      	   188M 		xor %eax,%eax
                      	   189M 		addr16
                      	   190M 		lodsw       # LOAD data from DS:ESI into EAX
                      	   191M 		cmp $value & val_mask,%ax
                      	   192M 		jne error
                      	   193M 		cmp $off_cmp,%esi
                      	   194M 		jne error
                      	   195M 	.endif
                      	   196M 
                      	   197M 	.if b = d
                      	   198M 		mov $off_value,%edi
                      	   199M 		mov $off_value & off_mask,%ebx
                      	   200M 		mov $0,%eax
                      	   201M 		mov %eax,%es:(%ebx)
                      	   202M 		mov $value,%eax
                      	   203M 		addr16
                      	   204M 		stosl     # STORE EAX in ES:EDI
                      	   205M 		.if 16 = 16
                      	   206M 			addr32
                      	   207M 			cmp %eax,%es:(%ebx)
                      	   208M 		.else
                      	   209M 			cmp %eax,%es:(%ebx)
                      	   210M 		.endif
                      	   211M 		jne error
                      	   212M 		cmp $off_cmp,%edi
                      	   213M 		jne error
                      	   214M 
                      	   215M 		mov $off_value,%esi
                      	   216M 		mov $off_value,%edi
                      	   217M 		mov $off_value & off_mask,%ebx
                      	   218M 		mov %eax,%ds:(%ebx)
                      	   219M 		mov %eax,%es:(%ebx)
                      	   220M 		cmp $0,%eax
                      	   221M 		je error
                      	   222M 		addr16
                      	   223M 		cmpsl     # COMPARE ES:EDI with DS:ESI
                      	   224M 		jne error
                      	   225M 		cmp $off_cmp,%edi
                      	   226M 		jne error
                      	   227M 		cmp $off_cmp,%esi
                      	   228M 		jne error
                      	   229M 
                      	   230M 		mov $off_value,%edi
                      	   231M 		mov $value,%eax
                      	   232M 		mov %eax,%es:(%ebx)
                      	   233M 		cmp $0,%eax
                      	   234M 		addr16
                      	   235M 		scasl     # SCAN/COMPARE ES:EDI with EAX
                      	   236M 		jne error
                      	   237M 		cmp $off_cmp,%edi
                      	   238M 		jne error
                      	   239M 
                      	   240M 		mov $off_value,%esi
                      	   241M 		mov $off_value,%edi
                      	   242M 		mov $value,%eax
                      	   243M 		mov %eax,%ds:(%ebx)
                      	   244M 		mov $0,%eax
                      	   245M 		mov %eax,%es:(%ebx)
                      	   246M 		addr16
                      	   247M 		movsl        # MOVE data from DS:ESI to ES:EDI
                      	   248M 		mov $value,%eax
                      	   249M 		.if 16 = 16
                      	   250M 			addr32
                      	   251M 			cmp %eax,%es:(%ebx)
                      	   252M 		.else
                      	   253M 			cmp %eax,%es:(%ebx)
                      	   254M 		.endif
                      	   255M 		jne error
                      	   256M 		cmp $off_cmp,%edi
                      	   257M 		jne error
                      	   258M 		cmp $off_cmp,%esi
                      	   259M 		jne error
                      	   260M 
                      	   261M 		mov $off_value,%esi
                      	   262M 		mov $value,%eax
                      	   263M 		mov %eax,%es:(%ebx)
                      	   264M 		xor %eax,%eax
                      	   265M 		addr16
                      	   266M 		lodsl       # LOAD data from DS:ESI into EAX
                      	   267M 		cmp $value & val_mask,%eax
                      	   268M 		jne error
                      	   269M 		cmp $off_cmp,%esi
                      	   270M 		jne error
                      	   271M 	.endif
                      	   272M 
                      	   237: 	testStringOps w,0,16
                      	     1M 
                      	     2M 	.set value,0x12345678
                      	     3M 	.if w = b
                      	     4M 		.set val_size,1
                      	     5M 		.set val_mask,0x000000ff
                      	     6M 	.endif
                      	     7M 	.if w = w
                      	     8M 		.set val_size,2
                      	     9M 		.set val_mask,0x0000ffff
                      	    10M 	.endif
                      	    11M 	.if w = d
                      	    12M 		.set val_size,4
                      	    13M 		.set val_mask,0xffffffff
                      	    14M 	.endif
                      	    15M 
                      	    16M 	.if 0 == 0
04:000006E3 FC        	    17M 		cld
                      	    18M 		.set off_value,0x0001ffff-(val_size-1)
                      	    19M 		.if 16 = 16
                      	    20M 			# 16-bit addressing
                      	    21M 			.set off_cmp,0x00010000
                      	    22M 		.else
                      	    23M 			# 32-bit addressing
                      	    24M 			.set off_cmp,0x00020000
                      	    25M 		.endif
                      	    26M 	.else
                      	    27M 		std
                      	    28M 		.set off_value,0x00010000
                      	    29M 		.if 16 = 16
                      	    30M 			# 16-bit addressing
                      	    31M 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    32M 		.else
                      	    33M 			# 32-bit addressing
                      	    34M 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    35M 		.endif
                      	    36M 	.endif
                      	    37M 
                      	    38M 	.if 16 = 16
                      	    39M 		.set off_mask,0x0000ffff
                      	    40M 	.else
                      	    41M 		.set off_mask,0xffffffff
                      	    42M 	.endif
                      	    43M 
                      	    44M 	# VERIFY string operands
                      	    45M 	.if w = b
                      	    46M 		mov $off_value,%edi
                      	    47M 		mov $off_value & off_mask,%ebx
                      	    48M 		mov $0,%al
                      	    49M 		mov %al,%es:(%ebx)
                      	    50M 		mov $value,%al
                      	    51M 		addr16
                      	    52M 		stosb		 	# STORE EAX in ES:EDI
                      	    53M 		.if 16 = 16
                      	    54M 			addr32
                      	    55M 			cmp %al,%es:(%ebx)
                      	    56M 		.else
                      	    57M 			cmp %al,%es:(%ebx)
                      	    58M 		.endif
                      	    59M 		jne error
                      	    60M 		cmp $off_cmp,%edi
                      	    61M 		jne error
                      	    62M 
                      	    63M 		mov $off_value,%esi
                      	    64M 		mov $off_value,%edi
                      	    65M 		mov $off_value & off_mask,%ebx
                      	    66M 		mov %al,%ds:(%ebx)
                      	    67M 		mov %al,%es:(%ebx)
                      	    68M 		cmp $0,%al
                      	    69M 		je error
                      	    70M 		addr16
                      	    71M 		cmpsb     # COMPARE ES:EDI with DS:ESI
                      	    72M 		jne error
                      	    73M 		cmp $off_cmp,%edi
                      	    74M 		jne error
                      	    75M 		cmp $off_cmp,%esi
                      	    76M 		jne error
                      	    77M 
                      	    78M 		mov $off_value,%edi
                      	    79M 		mov $value,%al
                      	    80M 		mov %al,%es:(%ebx)
                      	    81M 		cmp $0,%al
                      	    82M 		addr16
                      	    83M 		scasb     # SCAN/COMPARE ES:EDI with EAX
                      	    84M 		jne error
                      	    85M 		cmp $off_cmp,%edi
                      	    86M 		jne error
                      	    87M 
                      	    88M 		mov $off_value,%esi
                      	    89M 		mov $off_value,%edi
                      	    90M 		mov $value,%al
                      	    91M 		mov %al,%ds:(%ebx)
                      	    92M 		mov $0,%al
                      	    93M 		mov %al,%es:(%ebx)
                      	    94M 		addr16
                      	    95M 		movsb        # MOVE data from DS:ESI to ES:EDI
                      	    96M 		mov $value,%al
                      	    97M 		.if 16 = 16
                      	    98M 			addr32
                      	    99M 			cmp %al,%es:(%ebx)
                      	   100M 		.else
                      	   101M 			cmp %al,%es:(%ebx)
                      	   102M 		.endif
                      	   103M 		jne error
                      	   104M 		cmp $off_cmp,%edi
                      	   105M 		jne error
                      	   106M 		cmp $off_cmp,%esi
                      	   107M 		jne error
                      	   108M 
                      	   109M 		mov $off_value,%esi
                      	   110M 		mov $value,%al
                      	   111M 		mov %al,%es:(%ebx)
                      	   112M 		xor %eax,%eax
                      	   113M 		addr16
                      	   114M 		lodsb       # LOAD data from DS:ESI into EAX
                      	   115M 		cmp $value & val_mask,%al
                      	   116M 		jne error
                      	   117M 		cmp $off_cmp,%esi
                      	   118M 		jne error
                      	   119M 	.endif
                      	   120M 
                      	   121M 	.if w = w
04:000006E4 66BFFEFF01	   122M 		mov $off_value,%edi
04:000006E9 00
04:000006EA 66BBFEFF00	   123M 		mov $off_value & off_mask,%ebx
04:000006EF 00
04:000006F0 B80000    	   124M 		mov $0,%ax
04:000006F3 268903    	   125M 		mov %ax,%es:(%ebx)
04:000006F6 C7C07856  	   126M 		mov $value,%ax
04:000006FA 67        	   127M 		addr16
04:000006FB AB        	   128M 		stosw     # STORE EAX in ES:EDI
                      	   129M 		.if 16 = 16
04:000006FC 67        	   130M 			addr32
04:000006FD 263903    	   131M 			cmp %ax,%es:(%ebx)
                      	   132M 		.else
                      	   133M 			cmp %ax,%es:(%ebx)
                      	   134M 		.endif
04:00000700 0F853B11  	   135M 		jne error
04:00000704 6681FF0000	   136M 		cmp $off_cmp,%edi
04:00000709 0100
04:0000070B 0F853011  	   137M 		jne error
                      	   138M 
04:0000070F 66BEFEFF01	   139M 		mov $off_value,%esi
04:00000714 00
04:00000715 66BFFEFF01	   140M 		mov $off_value,%edi
04:0000071A 00
04:0000071B 66BBFEFF00	   141M 		mov $off_value & off_mask,%ebx
04:00000720 00
04:00000721 8903      	   142M 		mov %ax,%ds:(%ebx)
04:00000723 268903    	   143M 		mov %ax,%es:(%ebx)
04:00000726 83F800    	   144M 		cmp $0,%ax
04:00000729 0F841211  	   145M 		je error
04:0000072D 67        	   146M 		addr16
04:0000072E A7        	   147M 		cmpsw     # COMPARE ES:EDI with DS:ESI
04:0000072F 0F850C11  	   148M 		jne error
04:00000733 6681FF0000	   149M 		cmp $off_cmp,%edi
04:00000738 0100
04:0000073A 0F850111  	   150M 		jne error
04:0000073E 6681FE0000	   151M 		cmp $off_cmp,%esi
04:00000743 0100
04:00000745 0F85F610  	   152M 		jne error
                      	   153M 
04:00000749 66BFFEFF01	   154M 		mov $off_value,%edi
04:0000074E 00
04:0000074F C7C07856  	   155M 		mov $value,%ax
04:00000753 268903    	   156M 		mov %ax,%es:(%ebx)
04:00000756 83F800    	   157M 		cmp $0,%ax
04:00000759 67        	   158M 		addr16
04:0000075A AF        	   159M 		scasw     # SCAN/COMPARE ES:EDI with EAX
04:0000075B 0F85E010  	   160M 		jne error
04:0000075F 6681FF0000	   161M 		cmp $off_cmp,%edi
04:00000764 0100
04:00000766 0F85D510  	   162M 		jne error
                      	   163M 
04:0000076A 66BEFEFF01	   164M 		mov $off_value,%esi
04:0000076F 00
04:00000770 66BFFEFF01	   165M 		mov $off_value,%edi
04:00000775 00
04:00000776 C7C07856  	   166M 		mov $value,%ax
04:0000077A 8903      	   167M 		mov %ax,%ds:(%ebx)
04:0000077C B80000    	   168M 		mov $0,%ax
04:0000077F 268903    	   169M 		mov %ax,%es:(%ebx)
04:00000782 67        	   170M 		addr16
04:00000783 A5        	   171M 		movsw 					# MOVE data from DS:ESI to ES:EDI
04:00000784 C7C07856  	   172M 		mov $value,%ax
                      	   173M 		.if 16 = 16
04:00000788 67        	   174M 			addr32
04:00000789 263903    	   175M 			cmp %ax,%es:(%ebx)
                      	   176M 		.else
                      	   177M 			cmp %ax,%es:(%ebx)
                      	   178M 		.endif
04:0000078C 0F85AF10  	   179M 		jne error
04:00000790 6681FF0000	   180M 		cmp $off_cmp,%edi
04:00000795 0100
04:00000797 0F85A410  	   181M 		jne error
04:0000079B 6681FE0000	   182M 		cmp $off_cmp,%esi
04:000007A0 0100
04:000007A2 0F859910  	   183M 		jne error
                      	   184M 
04:000007A6 66BEFEFF01	   185M 		mov $off_value,%esi
04:000007AB 00
04:000007AC C7C07856  	   186M 		mov $value,%ax
04:000007B0 268903    	   187M 		mov %ax,%es:(%ebx)
04:000007B3 6631C0    	   188M 		xor %eax,%eax
04:000007B6 67        	   189M 		addr16
04:000007B7 AD        	   190M 		lodsw       # LOAD data from DS:ESI into EAX
04:000007B8 3D7856    	   191M 		cmp $value & val_mask,%ax
04:000007BB 0F858010  	   192M 		jne error
04:000007BF 6681FE0000	   193M 		cmp $off_cmp,%esi
04:000007C4 0100
04:000007C6 0F857510  	   194M 		jne error
                      	   195M 	.endif
                      	   196M 
                      	   197M 	.if w = d
                      	   198M 		mov $off_value,%edi
                      	   199M 		mov $off_value & off_mask,%ebx
                      	   200M 		mov $0,%eax
                      	   201M 		mov %eax,%es:(%ebx)
                      	   202M 		mov $value,%eax
                      	   203M 		addr16
                      	   204M 		stosl     # STORE EAX in ES:EDI
                      	   205M 		.if 16 = 16
                      	   206M 			addr32
                      	   207M 			cmp %eax,%es:(%ebx)
                      	   208M 		.else
                      	   209M 			cmp %eax,%es:(%ebx)
                      	   210M 		.endif
                      	   211M 		jne error
                      	   212M 		cmp $off_cmp,%edi
                      	   213M 		jne error
                      	   214M 
                      	   215M 		mov $off_value,%esi
                      	   216M 		mov $off_value,%edi
                      	   217M 		mov $off_value & off_mask,%ebx
                      	   218M 		mov %eax,%ds:(%ebx)
                      	   219M 		mov %eax,%es:(%ebx)
                      	   220M 		cmp $0,%eax
                      	   221M 		je error
                      	   222M 		addr16
                      	   223M 		cmpsl     # COMPARE ES:EDI with DS:ESI
                      	   224M 		jne error
                      	   225M 		cmp $off_cmp,%edi
                      	   226M 		jne error
                      	   227M 		cmp $off_cmp,%esi
                      	   228M 		jne error
                      	   229M 
                      	   230M 		mov $off_value,%edi
                      	   231M 		mov $value,%eax
                      	   232M 		mov %eax,%es:(%ebx)
                      	   233M 		cmp $0,%eax
                      	   234M 		addr16
                      	   235M 		scasl     # SCAN/COMPARE ES:EDI with EAX
                      	   236M 		jne error
                      	   237M 		cmp $off_cmp,%edi
                      	   238M 		jne error
                      	   239M 
                      	   240M 		mov $off_value,%esi
                      	   241M 		mov $off_value,%edi
                      	   242M 		mov $value,%eax
                      	   243M 		mov %eax,%ds:(%ebx)
                      	   244M 		mov $0,%eax
                      	   245M 		mov %eax,%es:(%ebx)
                      	   246M 		addr16
                      	   247M 		movsl        # MOVE data from DS:ESI to ES:EDI
                      	   248M 		mov $value,%eax
                      	   249M 		.if 16 = 16
                      	   250M 			addr32
                      	   251M 			cmp %eax,%es:(%ebx)
                      	   252M 		.else
                      	   253M 			cmp %eax,%es:(%ebx)
                      	   254M 		.endif
                      	   255M 		jne error
                      	   256M 		cmp $off_cmp,%edi
                      	   257M 		jne error
                      	   258M 		cmp $off_cmp,%esi
                      	   259M 		jne error
                      	   260M 
                      	   261M 		mov $off_value,%esi
                      	   262M 		mov $value,%eax
                      	   263M 		mov %eax,%es:(%ebx)
                      	   264M 		xor %eax,%eax
                      	   265M 		addr16
                      	   266M 		lodsl       # LOAD data from DS:ESI into EAX
                      	   267M 		cmp $value & val_mask,%eax
                      	   268M 		jne error
                      	   269M 		cmp $off_cmp,%esi
                      	   270M 		jne error
                      	   271M 	.endif
                      	   272M 
                      	   238: 	testStringOps d,0,16
                      	     1M 
                      	     2M 	.set value,0x12345678
                      	     3M 	.if d = b
                      	     4M 		.set val_size,1
                      	     5M 		.set val_mask,0x000000ff
                      	     6M 	.endif
                      	     7M 	.if d = w
                      	     8M 		.set val_size,2
                      	     9M 		.set val_mask,0x0000ffff
                      	    10M 	.endif
                      	    11M 	.if d = d
                      	    12M 		.set val_size,4
                      	    13M 		.set val_mask,0xffffffff
                      	    14M 	.endif
                      	    15M 
                      	    16M 	.if 0 == 0
04:000007CA FC        	    17M 		cld
                      	    18M 		.set off_value,0x0001ffff-(val_size-1)
                      	    19M 		.if 16 = 16
                      	    20M 			# 16-bit addressing
                      	    21M 			.set off_cmp,0x00010000
                      	    22M 		.else
                      	    23M 			# 32-bit addressing
                      	    24M 			.set off_cmp,0x00020000
                      	    25M 		.endif
                      	    26M 	.else
                      	    27M 		std
                      	    28M 		.set off_value,0x00010000
                      	    29M 		.if 16 = 16
                      	    30M 			# 16-bit addressing
                      	    31M 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    32M 		.else
                      	    33M 			# 32-bit addressing
                      	    34M 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    35M 		.endif
                      	    36M 	.endif
                      	    37M 
                      	    38M 	.if 16 = 16
                      	    39M 		.set off_mask,0x0000ffff
                      	    40M 	.else
                      	    41M 		.set off_mask,0xffffffff
                      	    42M 	.endif
                      	    43M 
                      	    44M 	# VERIFY string operands
                      	    45M 	.if d = b
                      	    46M 		mov $off_value,%edi
                      	    47M 		mov $off_value & off_mask,%ebx
                      	    48M 		mov $0,%al
                      	    49M 		mov %al,%es:(%ebx)
                      	    50M 		mov $value,%al
                      	    51M 		addr16
                      	    52M 		stosb		 	# STORE EAX in ES:EDI
                      	    53M 		.if 16 = 16
                      	    54M 			addr32
                      	    55M 			cmp %al,%es:(%ebx)
                      	    56M 		.else
                      	    57M 			cmp %al,%es:(%ebx)
                      	    58M 		.endif
                      	    59M 		jne error
                      	    60M 		cmp $off_cmp,%edi
                      	    61M 		jne error
                      	    62M 
                      	    63M 		mov $off_value,%esi
                      	    64M 		mov $off_value,%edi
                      	    65M 		mov $off_value & off_mask,%ebx
                      	    66M 		mov %al,%ds:(%ebx)
                      	    67M 		mov %al,%es:(%ebx)
                      	    68M 		cmp $0,%al
                      	    69M 		je error
                      	    70M 		addr16
                      	    71M 		cmpsb     # COMPARE ES:EDI with DS:ESI
                      	    72M 		jne error
                      	    73M 		cmp $off_cmp,%edi
                      	    74M 		jne error
                      	    75M 		cmp $off_cmp,%esi
                      	    76M 		jne error
                      	    77M 
                      	    78M 		mov $off_value,%edi
                      	    79M 		mov $value,%al
                      	    80M 		mov %al,%es:(%ebx)
                      	    81M 		cmp $0,%al
                      	    82M 		addr16
                      	    83M 		scasb     # SCAN/COMPARE ES:EDI with EAX
                      	    84M 		jne error
                      	    85M 		cmp $off_cmp,%edi
                      	    86M 		jne error
                      	    87M 
                      	    88M 		mov $off_value,%esi
                      	    89M 		mov $off_value,%edi
                      	    90M 		mov $value,%al
                      	    91M 		mov %al,%ds:(%ebx)
                      	    92M 		mov $0,%al
                      	    93M 		mov %al,%es:(%ebx)
                      	    94M 		addr16
                      	    95M 		movsb        # MOVE data from DS:ESI to ES:EDI
                      	    96M 		mov $value,%al
                      	    97M 		.if 16 = 16
                      	    98M 			addr32
                      	    99M 			cmp %al,%es:(%ebx)
                      	   100M 		.else
                      	   101M 			cmp %al,%es:(%ebx)
                      	   102M 		.endif
                      	   103M 		jne error
                      	   104M 		cmp $off_cmp,%edi
                      	   105M 		jne error
                      	   106M 		cmp $off_cmp,%esi
                      	   107M 		jne error
                      	   108M 
                      	   109M 		mov $off_value,%esi
                      	   110M 		mov $value,%al
                      	   111M 		mov %al,%es:(%ebx)
                      	   112M 		xor %eax,%eax
                      	   113M 		addr16
                      	   114M 		lodsb       # LOAD data from DS:ESI into EAX
                      	   115M 		cmp $value & val_mask,%al
                      	   116M 		jne error
                      	   117M 		cmp $off_cmp,%esi
                      	   118M 		jne error
                      	   119M 	.endif
                      	   120M 
                      	   121M 	.if d = w
                      	   122M 		mov $off_value,%edi
                      	   123M 		mov $off_value & off_mask,%ebx
                      	   124M 		mov $0,%ax
                      	   125M 		mov %ax,%es:(%ebx)
                      	   126M 		mov $value,%ax
                      	   127M 		addr16
                      	   128M 		stosw     # STORE EAX in ES:EDI
                      	   129M 		.if 16 = 16
                      	   130M 			addr32
                      	   131M 			cmp %ax,%es:(%ebx)
                      	   132M 		.else
                      	   133M 			cmp %ax,%es:(%ebx)
                      	   134M 		.endif
                      	   135M 		jne error
                      	   136M 		cmp $off_cmp,%edi
                      	   137M 		jne error
                      	   138M 
                      	   139M 		mov $off_value,%esi
                      	   140M 		mov $off_value,%edi
                      	   141M 		mov $off_value & off_mask,%ebx
                      	   142M 		mov %ax,%ds:(%ebx)
                      	   143M 		mov %ax,%es:(%ebx)
                      	   144M 		cmp $0,%ax
                      	   145M 		je error
                      	   146M 		addr16
                      	   147M 		cmpsw     # COMPARE ES:EDI with DS:ESI
                      	   148M 		jne error
                      	   149M 		cmp $off_cmp,%edi
                      	   150M 		jne error
                      	   151M 		cmp $off_cmp,%esi
                      	   152M 		jne error
                      	   153M 
                      	   154M 		mov $off_value,%edi
                      	   155M 		mov $value,%ax
                      	   156M 		mov %ax,%es:(%ebx)
                      	   157M 		cmp $0,%ax
                      	   158M 		addr16
                      	   159M 		scasw     # SCAN/COMPARE ES:EDI with EAX
                      	   160M 		jne error
                      	   161M 		cmp $off_cmp,%edi
                      	   162M 		jne error
                      	   163M 
                      	   164M 		mov $off_value,%esi
                      	   165M 		mov $off_value,%edi
                      	   166M 		mov $value,%ax
                      	   167M 		mov %ax,%ds:(%ebx)
                      	   168M 		mov $0,%ax
                      	   169M 		mov %ax,%es:(%ebx)
                      	   170M 		addr16
                      	   171M 		movsw 					# MOVE data from DS:ESI to ES:EDI
                      	   172M 		mov $value,%ax
                      	   173M 		.if 16 = 16
                      	   174M 			addr32
                      	   175M 			cmp %ax,%es:(%ebx)
                      	   176M 		.else
                      	   177M 			cmp %ax,%es:(%ebx)
                      	   178M 		.endif
                      	   179M 		jne error
                      	   180M 		cmp $off_cmp,%edi
                      	   181M 		jne error
                      	   182M 		cmp $off_cmp,%esi
                      	   183M 		jne error
                      	   184M 
                      	   185M 		mov $off_value,%esi
                      	   186M 		mov $value,%ax
                      	   187M 		mov %ax,%es:(%ebx)
                      	   188M 		xor %eax,%eax
                      	   189M 		addr16
                      	   190M 		lodsw       # LOAD data from DS:ESI into EAX
                      	   191M 		cmp $value & val_mask,%ax
                      	   192M 		jne error
                      	   193M 		cmp $off_cmp,%esi
                      	   194M 		jne error
                      	   195M 	.endif
                      	   196M 
                      	   197M 	.if d = d
04:000007CB 66BFFCFF01	   198M 		mov $off_value,%edi
04:000007D0 00
04:000007D1 66BBFCFF00	   199M 		mov $off_value & off_mask,%ebx
04:000007D6 00
04:000007D7 66B8000000	   200M 		mov $0,%eax
04:000007DC 00
04:000007DD 66268903  	   201M 		mov %eax,%es:(%ebx)
04:000007E1 66B8785634	   202M 		mov $value,%eax
04:000007E6 12
04:000007E7 67        	   203M 		addr16
04:000007E8 66AB      	   204M 		stosl     # STORE EAX in ES:EDI
                      	   205M 		.if 16 = 16
04:000007EA 67        	   206M 			addr32
04:000007EB 66263903  	   207M 			cmp %eax,%es:(%ebx)
                      	   208M 		.else
                      	   209M 			cmp %eax,%es:(%ebx)
                      	   210M 		.endif
04:000007EF 0F854C10  	   211M 		jne error
04:000007F3 6681FF0000	   212M 		cmp $off_cmp,%edi
04:000007F8 0100
04:000007FA 0F854110  	   213M 		jne error
                      	   214M 
04:000007FE 66BEFCFF01	   215M 		mov $off_value,%esi
04:00000803 00
04:00000804 66BFFCFF01	   216M 		mov $off_value,%edi
04:00000809 00
04:0000080A 66BBFCFF00	   217M 		mov $off_value & off_mask,%ebx
04:0000080F 00
04:00000810 668903    	   218M 		mov %eax,%ds:(%ebx)
04:00000813 66268903  	   219M 		mov %eax,%es:(%ebx)
04:00000817 6683F800  	   220M 		cmp $0,%eax
04:0000081B 0F842010  	   221M 		je error
04:0000081F 67        	   222M 		addr16
04:00000820 66A7      	   223M 		cmpsl     # COMPARE ES:EDI with DS:ESI
04:00000822 0F851910  	   224M 		jne error
04:00000826 6681FF0000	   225M 		cmp $off_cmp,%edi
04:0000082B 0100
04:0000082D 0F850E10  	   226M 		jne error
04:00000831 6681FE0000	   227M 		cmp $off_cmp,%esi
04:00000836 0100
04:00000838 0F850310  	   228M 		jne error
                      	   229M 
04:0000083C 66BFFCFF01	   230M 		mov $off_value,%edi
04:00000841 00
04:00000842 66B8785634	   231M 		mov $value,%eax
04:00000847 12
04:00000848 66268903  	   232M 		mov %eax,%es:(%ebx)
04:0000084C 6683F800  	   233M 		cmp $0,%eax
04:00000850 67        	   234M 		addr16
04:00000851 66AF      	   235M 		scasl     # SCAN/COMPARE ES:EDI with EAX
04:00000853 0F85E80F  	   236M 		jne error
04:00000857 6681FF0000	   237M 		cmp $off_cmp,%edi
04:0000085C 0100
04:0000085E 0F85DD0F  	   238M 		jne error
                      	   239M 
04:00000862 66BEFCFF01	   240M 		mov $off_value,%esi
04:00000867 00
04:00000868 66BFFCFF01	   241M 		mov $off_value,%edi
04:0000086D 00
04:0000086E 66B8785634	   242M 		mov $value,%eax
04:00000873 12
04:00000874 668903    	   243M 		mov %eax,%ds:(%ebx)
04:00000877 66B8000000	   244M 		mov $0,%eax
04:0000087C 00
04:0000087D 66268903  	   245M 		mov %eax,%es:(%ebx)
04:00000881 67        	   246M 		addr16
04:00000882 66A5      	   247M 		movsl        # MOVE data from DS:ESI to ES:EDI
04:00000884 66B8785634	   248M 		mov $value,%eax
04:00000889 12
                      	   249M 		.if 16 = 16
04:0000088A 67        	   250M 			addr32
04:0000088B 66263903  	   251M 			cmp %eax,%es:(%ebx)
                      	   252M 		.else
                      	   253M 			cmp %eax,%es:(%ebx)
                      	   254M 		.endif
04:0000088F 0F85AC0F  	   255M 		jne error
04:00000893 6681FF0000	   256M 		cmp $off_cmp,%edi
04:00000898 0100
04:0000089A 0F85A10F  	   257M 		jne error
04:0000089E 6681FE0000	   258M 		cmp $off_cmp,%esi
04:000008A3 0100
04:000008A5 0F85960F  	   259M 		jne error
                      	   260M 
04:000008A9 66BEFCFF01	   261M 		mov $off_value,%esi
04:000008AE 00
04:000008AF 66B8785634	   262M 		mov $value,%eax
04:000008B4 12
04:000008B5 66268903  	   263M 		mov %eax,%es:(%ebx)
04:000008B9 6631C0    	   264M 		xor %eax,%eax
04:000008BC 67        	   265M 		addr16
04:000008BD 66AD      	   266M 		lodsl       # LOAD data from DS:ESI into EAX
04:000008BF 663D785634	   267M 		cmp $value & val_mask,%eax
04:000008C4 12
04:000008C5 0F85760F  	   268M 		jne error
04:000008C9 6681FE0000	   269M 		cmp $off_cmp,%esi
04:000008CE 0100
04:000008D0 0F856B0F  	   270M 		jne error
                      	   271M 	.endif
                      	   272M 
                      	   239: 	testStringOps b,1,16
                      	     1M 
                      	     2M 	.set value,0x12345678
                      	     3M 	.if b = b
                      	     4M 		.set val_size,1
                      	     5M 		.set val_mask,0x000000ff
                      	     6M 	.endif
                      	     7M 	.if b = w
                      	     8M 		.set val_size,2
                      	     9M 		.set val_mask,0x0000ffff
                      	    10M 	.endif
                      	    11M 	.if b = d
                      	    12M 		.set val_size,4
                      	    13M 		.set val_mask,0xffffffff
                      	    14M 	.endif
                      	    15M 
                      	    16M 	.if 1 == 0
                      	    17M 		cld
                      	    18M 		.set off_value,0x0001ffff-(val_size-1)
                      	    19M 		.if 16 = 16
                      	    20M 			# 16-bit addressing
                      	    21M 			.set off_cmp,0x00010000
                      	    22M 		.else
                      	    23M 			# 32-bit addressing
                      	    24M 			.set off_cmp,0x00020000
                      	    25M 		.endif
                      	    26M 	.else
04:000008D4 FD        	    27M 		std
                      	    28M 		.set off_value,0x00010000
                      	    29M 		.if 16 = 16
                      	    30M 			# 16-bit addressing
                      	    31M 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    32M 		.else
                      	    33M 			# 32-bit addressing
                      	    34M 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    35M 		.endif
                      	    36M 	.endif
                      	    37M 
                      	    38M 	.if 16 = 16
                      	    39M 		.set off_mask,0x0000ffff
                      	    40M 	.else
                      	    41M 		.set off_mask,0xffffffff
                      	    42M 	.endif
                      	    43M 
                      	    44M 	# VERIFY string operands
                      	    45M 	.if b = b
04:000008D5 66BF000001	    46M 		mov $off_value,%edi
04:000008DA 00
04:000008DB 66BB000000	    47M 		mov $off_value & off_mask,%ebx
04:000008E0 00
04:000008E1 B000      	    48M 		mov $0,%al
04:000008E3 268803    	    49M 		mov %al,%es:(%ebx)
04:000008E6 C6C078    	    50M 		mov $value,%al
04:000008E9 67        	    51M 		addr16
04:000008EA AA        	    52M 		stosb		 	# STORE EAX in ES:EDI
                      	    53M 		.if 16 = 16
04:000008EB 67        	    54M 			addr32
04:000008EC 263803    	    55M 			cmp %al,%es:(%ebx)
                      	    56M 		.else
                      	    57M 			cmp %al,%es:(%ebx)
                      	    58M 		.endif
04:000008EF 0F854C0F  	    59M 		jne error
04:000008F3 6681FFFFFF	    60M 		cmp $off_cmp,%edi
04:000008F8 0100
04:000008FA 0F85410F  	    61M 		jne error
                      	    62M 
04:000008FE 66BE000001	    63M 		mov $off_value,%esi
04:00000903 00
04:00000904 66BF000001	    64M 		mov $off_value,%edi
04:00000909 00
04:0000090A 66BB000000	    65M 		mov $off_value & off_mask,%ebx
04:0000090F 00
04:00000910 8803      	    66M 		mov %al,%ds:(%ebx)
04:00000912 268803    	    67M 		mov %al,%es:(%ebx)
04:00000915 3C00      	    68M 		cmp $0,%al
04:00000917 0F84240F  	    69M 		je error
04:0000091B 67        	    70M 		addr16
04:0000091C A6        	    71M 		cmpsb     # COMPARE ES:EDI with DS:ESI
04:0000091D 0F851E0F  	    72M 		jne error
04:00000921 6681FFFFFF	    73M 		cmp $off_cmp,%edi
04:00000926 0100
04:00000928 0F85130F  	    74M 		jne error
04:0000092C 6681FEFFFF	    75M 		cmp $off_cmp,%esi
04:00000931 0100
04:00000933 0F85080F  	    76M 		jne error
                      	    77M 
04:00000937 66BF000001	    78M 		mov $off_value,%edi
04:0000093C 00
04:0000093D C6C078    	    79M 		mov $value,%al
04:00000940 268803    	    80M 		mov %al,%es:(%ebx)
04:00000943 3C00      	    81M 		cmp $0,%al
04:00000945 67        	    82M 		addr16
04:00000946 AE        	    83M 		scasb     # SCAN/COMPARE ES:EDI with EAX
04:00000947 0F85F40E  	    84M 		jne error
04:0000094B 6681FFFFFF	    85M 		cmp $off_cmp,%edi
04:00000950 0100
04:00000952 0F85E90E  	    86M 		jne error
                      	    87M 
04:00000956 66BE000001	    88M 		mov $off_value,%esi
04:0000095B 00
04:0000095C 66BF000001	    89M 		mov $off_value,%edi
04:00000961 00
04:00000962 C6C078    	    90M 		mov $value,%al
04:00000965 8803      	    91M 		mov %al,%ds:(%ebx)
04:00000967 B000      	    92M 		mov $0,%al
04:00000969 268803    	    93M 		mov %al,%es:(%ebx)
04:0000096C 67        	    94M 		addr16
04:0000096D A4        	    95M 		movsb        # MOVE data from DS:ESI to ES:EDI
04:0000096E C6C078    	    96M 		mov $value,%al
                      	    97M 		.if 16 = 16
04:00000971 67        	    98M 			addr32
04:00000972 263803    	    99M 			cmp %al,%es:(%ebx)
                      	   100M 		.else
                      	   101M 			cmp %al,%es:(%ebx)
                      	   102M 		.endif
04:00000975 0F85C60E  	   103M 		jne error
04:00000979 6681FFFFFF	   104M 		cmp $off_cmp,%edi
04:0000097E 0100
04:00000980 0F85BB0E  	   105M 		jne error
04:00000984 6681FEFFFF	   106M 		cmp $off_cmp,%esi
04:00000989 0100
04:0000098B 0F85B00E  	   107M 		jne error
                      	   108M 
04:0000098F 66BE000001	   109M 		mov $off_value,%esi
04:00000994 00
04:00000995 C6C078    	   110M 		mov $value,%al
04:00000998 268803    	   111M 		mov %al,%es:(%ebx)
04:0000099B 6631C0    	   112M 		xor %eax,%eax
04:0000099E 67        	   113M 		addr16
04:0000099F AC        	   114M 		lodsb       # LOAD data from DS:ESI into EAX
04:000009A0 3C78      	   115M 		cmp $value & val_mask,%al
04:000009A2 0F85990E  	   116M 		jne error
04:000009A6 6681FEFFFF	   117M 		cmp $off_cmp,%esi
04:000009AB 0100
04:000009AD 0F858E0E  	   118M 		jne error
                      	   119M 	.endif
                      	   120M 
                      	   121M 	.if b = w
                      	   122M 		mov $off_value,%edi
                      	   123M 		mov $off_value & off_mask,%ebx
                      	   124M 		mov $0,%ax
                      	   125M 		mov %ax,%es:(%ebx)
                      	   126M 		mov $value,%ax
                      	   127M 		addr16
                      	   128M 		stosw     # STORE EAX in ES:EDI
                      	   129M 		.if 16 = 16
                      	   130M 			addr32
                      	   131M 			cmp %ax,%es:(%ebx)
                      	   132M 		.else
                      	   133M 			cmp %ax,%es:(%ebx)
                      	   134M 		.endif
                      	   135M 		jne error
                      	   136M 		cmp $off_cmp,%edi
                      	   137M 		jne error
                      	   138M 
                      	   139M 		mov $off_value,%esi
                      	   140M 		mov $off_value,%edi
                      	   141M 		mov $off_value & off_mask,%ebx
                      	   142M 		mov %ax,%ds:(%ebx)
                      	   143M 		mov %ax,%es:(%ebx)
                      	   144M 		cmp $0,%ax
                      	   145M 		je error
                      	   146M 		addr16
                      	   147M 		cmpsw     # COMPARE ES:EDI with DS:ESI
                      	   148M 		jne error
                      	   149M 		cmp $off_cmp,%edi
                      	   150M 		jne error
                      	   151M 		cmp $off_cmp,%esi
                      	   152M 		jne error
                      	   153M 
                      	   154M 		mov $off_value,%edi
                      	   155M 		mov $value,%ax
                      	   156M 		mov %ax,%es:(%ebx)
                      	   157M 		cmp $0,%ax
                      	   158M 		addr16
                      	   159M 		scasw     # SCAN/COMPARE ES:EDI with EAX
                      	   160M 		jne error
                      	   161M 		cmp $off_cmp,%edi
                      	   162M 		jne error
                      	   163M 
                      	   164M 		mov $off_value,%esi
                      	   165M 		mov $off_value,%edi
                      	   166M 		mov $value,%ax
                      	   167M 		mov %ax,%ds:(%ebx)
                      	   168M 		mov $0,%ax
                      	   169M 		mov %ax,%es:(%ebx)
                      	   170M 		addr16
                      	   171M 		movsw 					# MOVE data from DS:ESI to ES:EDI
                      	   172M 		mov $value,%ax
                      	   173M 		.if 16 = 16
                      	   174M 			addr32
                      	   175M 			cmp %ax,%es:(%ebx)
                      	   176M 		.else
                      	   177M 			cmp %ax,%es:(%ebx)
                      	   178M 		.endif
                      	   179M 		jne error
                      	   180M 		cmp $off_cmp,%edi
                      	   181M 		jne error
                      	   182M 		cmp $off_cmp,%esi
                      	   183M 		jne error
                      	   184M 
                      	   185M 		mov $off_value,%esi
                      	   186M 		mov $value,%ax
                      	   187M 		mov %ax,%es:(%ebx)
                      	   188M 		xor %eax,%eax
                      	   189M 		addr16
                      	   190M 		lodsw       # LOAD data from DS:ESI into EAX
                      	   191M 		cmp $value & val_mask,%ax
                      	   192M 		jne error
                      	   193M 		cmp $off_cmp,%esi
                      	   194M 		jne error
                      	   195M 	.endif
                      	   196M 
                      	   197M 	.if b = d
                      	   198M 		mov $off_value,%edi
                      	   199M 		mov $off_value & off_mask,%ebx
                      	   200M 		mov $0,%eax
                      	   201M 		mov %eax,%es:(%ebx)
                      	   202M 		mov $value,%eax
                      	   203M 		addr16
                      	   204M 		stosl     # STORE EAX in ES:EDI
                      	   205M 		.if 16 = 16
                      	   206M 			addr32
                      	   207M 			cmp %eax,%es:(%ebx)
                      	   208M 		.else
                      	   209M 			cmp %eax,%es:(%ebx)
                      	   210M 		.endif
                      	   211M 		jne error
                      	   212M 		cmp $off_cmp,%edi
                      	   213M 		jne error
                      	   214M 
                      	   215M 		mov $off_value,%esi
                      	   216M 		mov $off_value,%edi
                      	   217M 		mov $off_value & off_mask,%ebx
                      	   218M 		mov %eax,%ds:(%ebx)
                      	   219M 		mov %eax,%es:(%ebx)
                      	   220M 		cmp $0,%eax
                      	   221M 		je error
                      	   222M 		addr16
                      	   223M 		cmpsl     # COMPARE ES:EDI with DS:ESI
                      	   224M 		jne error
                      	   225M 		cmp $off_cmp,%edi
                      	   226M 		jne error
                      	   227M 		cmp $off_cmp,%esi
                      	   228M 		jne error
                      	   229M 
                      	   230M 		mov $off_value,%edi
                      	   231M 		mov $value,%eax
                      	   232M 		mov %eax,%es:(%ebx)
                      	   233M 		cmp $0,%eax
                      	   234M 		addr16
                      	   235M 		scasl     # SCAN/COMPARE ES:EDI with EAX
                      	   236M 		jne error
                      	   237M 		cmp $off_cmp,%edi
                      	   238M 		jne error
                      	   239M 
                      	   240M 		mov $off_value,%esi
                      	   241M 		mov $off_value,%edi
                      	   242M 		mov $value,%eax
                      	   243M 		mov %eax,%ds:(%ebx)
                      	   244M 		mov $0,%eax
                      	   245M 		mov %eax,%es:(%ebx)
                      	   246M 		addr16
                      	   247M 		movsl        # MOVE data from DS:ESI to ES:EDI
                      	   248M 		mov $value,%eax
                      	   249M 		.if 16 = 16
                      	   250M 			addr32
                      	   251M 			cmp %eax,%es:(%ebx)
                      	   252M 		.else
                      	   253M 			cmp %eax,%es:(%ebx)
                      	   254M 		.endif
                      	   255M 		jne error
                      	   256M 		cmp $off_cmp,%edi
                      	   257M 		jne error
                      	   258M 		cmp $off_cmp,%esi
                      	   259M 		jne error
                      	   260M 
                      	   261M 		mov $off_value,%esi
                      	   262M 		mov $value,%eax
                      	   263M 		mov %eax,%es:(%ebx)
                      	   264M 		xor %eax,%eax
                      	   265M 		addr16
                      	   266M 		lodsl       # LOAD data from DS:ESI into EAX
                      	   267M 		cmp $value & val_mask,%eax
                      	   268M 		jne error
                      	   269M 		cmp $off_cmp,%esi
                      	   270M 		jne error
                      	   271M 	.endif
                      	   272M 
                      	   240: 	testStringOps w,1,16
                      	     1M 
                      	     2M 	.set value,0x12345678
                      	     3M 	.if w = b
                      	     4M 		.set val_size,1
                      	     5M 		.set val_mask,0x000000ff
                      	     6M 	.endif
                      	     7M 	.if w = w
                      	     8M 		.set val_size,2
                      	     9M 		.set val_mask,0x0000ffff
                      	    10M 	.endif
                      	    11M 	.if w = d
                      	    12M 		.set val_size,4
                      	    13M 		.set val_mask,0xffffffff
                      	    14M 	.endif
                      	    15M 
                      	    16M 	.if 1 == 0
                      	    17M 		cld
                      	    18M 		.set off_value,0x0001ffff-(val_size-1)
                      	    19M 		.if 16 = 16
                      	    20M 			# 16-bit addressing
                      	    21M 			.set off_cmp,0x00010000
                      	    22M 		.else
                      	    23M 			# 32-bit addressing
                      	    24M 			.set off_cmp,0x00020000
                      	    25M 		.endif
                      	    26M 	.else
04:000009B1 FD        	    27M 		std
                      	    28M 		.set off_value,0x00010000
                      	    29M 		.if 16 = 16
                      	    30M 			# 16-bit addressing
                      	    31M 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    32M 		.else
                      	    33M 			# 32-bit addressing
                      	    34M 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    35M 		.endif
                      	    36M 	.endif
                      	    37M 
                      	    38M 	.if 16 = 16
                      	    39M 		.set off_mask,0x0000ffff
                      	    40M 	.else
                      	    41M 		.set off_mask,0xffffffff
                      	    42M 	.endif
                      	    43M 
                      	    44M 	# VERIFY string operands
                      	    45M 	.if w = b
                      	    46M 		mov $off_value,%edi
                      	    47M 		mov $off_value & off_mask,%ebx
                      	    48M 		mov $0,%al
                      	    49M 		mov %al,%es:(%ebx)
                      	    50M 		mov $value,%al
                      	    51M 		addr16
                      	    52M 		stosb		 	# STORE EAX in ES:EDI
                      	    53M 		.if 16 = 16
                      	    54M 			addr32
                      	    55M 			cmp %al,%es:(%ebx)
                      	    56M 		.else
                      	    57M 			cmp %al,%es:(%ebx)
                      	    58M 		.endif
                      	    59M 		jne error
                      	    60M 		cmp $off_cmp,%edi
                      	    61M 		jne error
                      	    62M 
                      	    63M 		mov $off_value,%esi
                      	    64M 		mov $off_value,%edi
                      	    65M 		mov $off_value & off_mask,%ebx
                      	    66M 		mov %al,%ds:(%ebx)
                      	    67M 		mov %al,%es:(%ebx)
                      	    68M 		cmp $0,%al
                      	    69M 		je error
                      	    70M 		addr16
                      	    71M 		cmpsb     # COMPARE ES:EDI with DS:ESI
                      	    72M 		jne error
                      	    73M 		cmp $off_cmp,%edi
                      	    74M 		jne error
                      	    75M 		cmp $off_cmp,%esi
                      	    76M 		jne error
                      	    77M 
                      	    78M 		mov $off_value,%edi
                      	    79M 		mov $value,%al
                      	    80M 		mov %al,%es:(%ebx)
                      	    81M 		cmp $0,%al
                      	    82M 		addr16
                      	    83M 		scasb     # SCAN/COMPARE ES:EDI with EAX
                      	    84M 		jne error
                      	    85M 		cmp $off_cmp,%edi
                      	    86M 		jne error
                      	    87M 
                      	    88M 		mov $off_value,%esi
                      	    89M 		mov $off_value,%edi
                      	    90M 		mov $value,%al
                      	    91M 		mov %al,%ds:(%ebx)
                      	    92M 		mov $0,%al
                      	    93M 		mov %al,%es:(%ebx)
                      	    94M 		addr16
                      	    95M 		movsb        # MOVE data from DS:ESI to ES:EDI
                      	    96M 		mov $value,%al
                      	    97M 		.if 16 = 16
                      	    98M 			addr32
                      	    99M 			cmp %al,%es:(%ebx)
                      	   100M 		.else
                      	   101M 			cmp %al,%es:(%ebx)
                      	   102M 		.endif
                      	   103M 		jne error
                      	   104M 		cmp $off_cmp,%edi
                      	   105M 		jne error
                      	   106M 		cmp $off_cmp,%esi
                      	   107M 		jne error
                      	   108M 
                      	   109M 		mov $off_value,%esi
                      	   110M 		mov $value,%al
                      	   111M 		mov %al,%es:(%ebx)
                      	   112M 		xor %eax,%eax
                      	   113M 		addr16
                      	   114M 		lodsb       # LOAD data from DS:ESI into EAX
                      	   115M 		cmp $value & val_mask,%al
                      	   116M 		jne error
                      	   117M 		cmp $off_cmp,%esi
                      	   118M 		jne error
                      	   119M 	.endif
                      	   120M 
                      	   121M 	.if w = w
04:000009B2 66BF000001	   122M 		mov $off_value,%edi
04:000009B7 00
04:000009B8 66BB000000	   123M 		mov $off_value & off_mask,%ebx
04:000009BD 00
04:000009BE B80000    	   124M 		mov $0,%ax
04:000009C1 268903    	   125M 		mov %ax,%es:(%ebx)
04:000009C4 C7C07856  	   126M 		mov $value,%ax
04:000009C8 67        	   127M 		addr16
04:000009C9 AB        	   128M 		stosw     # STORE EAX in ES:EDI
                      	   129M 		.if 16 = 16
04:000009CA 67        	   130M 			addr32
04:000009CB 263903    	   131M 			cmp %ax,%es:(%ebx)
                      	   132M 		.else
                      	   133M 			cmp %ax,%es:(%ebx)
                      	   134M 		.endif
04:000009CE 0F856D0E  	   135M 		jne error
04:000009D2 6681FFFEFF	   136M 		cmp $off_cmp,%edi
04:000009D7 0100
04:000009D9 0F85620E  	   137M 		jne error
                      	   138M 
04:000009DD 66BE000001	   139M 		mov $off_value,%esi
04:000009E2 00
04:000009E3 66BF000001	   140M 		mov $off_value,%edi
04:000009E8 00
04:000009E9 66BB000000	   141M 		mov $off_value & off_mask,%ebx
04:000009EE 00
04:000009EF 8903      	   142M 		mov %ax,%ds:(%ebx)
04:000009F1 268903    	   143M 		mov %ax,%es:(%ebx)
04:000009F4 83F800    	   144M 		cmp $0,%ax
04:000009F7 0F84440E  	   145M 		je error
04:000009FB 67        	   146M 		addr16
04:000009FC A7        	   147M 		cmpsw     # COMPARE ES:EDI with DS:ESI
04:000009FD 0F853E0E  	   148M 		jne error
04:00000A01 6681FFFEFF	   149M 		cmp $off_cmp,%edi
04:00000A06 0100
04:00000A08 0F85330E  	   150M 		jne error
04:00000A0C 6681FEFEFF	   151M 		cmp $off_cmp,%esi
04:00000A11 0100
04:00000A13 0F85280E  	   152M 		jne error
                      	   153M 
04:00000A17 66BF000001	   154M 		mov $off_value,%edi
04:00000A1C 00
04:00000A1D C7C07856  	   155M 		mov $value,%ax
04:00000A21 268903    	   156M 		mov %ax,%es:(%ebx)
04:00000A24 83F800    	   157M 		cmp $0,%ax
04:00000A27 67        	   158M 		addr16
04:00000A28 AF        	   159M 		scasw     # SCAN/COMPARE ES:EDI with EAX
04:00000A29 0F85120E  	   160M 		jne error
04:00000A2D 6681FFFEFF	   161M 		cmp $off_cmp,%edi
04:00000A32 0100
04:00000A34 0F85070E  	   162M 		jne error
                      	   163M 
04:00000A38 66BE000001	   164M 		mov $off_value,%esi
04:00000A3D 00
04:00000A3E 66BF000001	   165M 		mov $off_value,%edi
04:00000A43 00
04:00000A44 C7C07856  	   166M 		mov $value,%ax
04:00000A48 8903      	   167M 		mov %ax,%ds:(%ebx)
04:00000A4A B80000    	   168M 		mov $0,%ax
04:00000A4D 268903    	   169M 		mov %ax,%es:(%ebx)
04:00000A50 67        	   170M 		addr16
04:00000A51 A5        	   171M 		movsw 					# MOVE data from DS:ESI to ES:EDI
04:00000A52 C7C07856  	   172M 		mov $value,%ax
                      	   173M 		.if 16 = 16
04:00000A56 67        	   174M 			addr32
04:00000A57 263903    	   175M 			cmp %ax,%es:(%ebx)
                      	   176M 		.else
                      	   177M 			cmp %ax,%es:(%ebx)
                      	   178M 		.endif
04:00000A5A 0F85E10D  	   179M 		jne error
04:00000A5E 6681FFFEFF	   180M 		cmp $off_cmp,%edi
04:00000A63 0100
04:00000A65 0F85D60D  	   181M 		jne error
04:00000A69 6681FEFEFF	   182M 		cmp $off_cmp,%esi
04:00000A6E 0100
04:00000A70 0F85CB0D  	   183M 		jne error
                      	   184M 
04:00000A74 66BE000001	   185M 		mov $off_value,%esi
04:00000A79 00
04:00000A7A C7C07856  	   186M 		mov $value,%ax
04:00000A7E 268903    	   187M 		mov %ax,%es:(%ebx)
04:00000A81 6631C0    	   188M 		xor %eax,%eax
04:00000A84 67        	   189M 		addr16
04:00000A85 AD        	   190M 		lodsw       # LOAD data from DS:ESI into EAX
04:00000A86 3D7856    	   191M 		cmp $value & val_mask,%ax
04:00000A89 0F85B20D  	   192M 		jne error
04:00000A8D 6681FEFEFF	   193M 		cmp $off_cmp,%esi
04:00000A92 0100
04:00000A94 0F85A70D  	   194M 		jne error
                      	   195M 	.endif
                      	   196M 
                      	   197M 	.if w = d
                      	   198M 		mov $off_value,%edi
                      	   199M 		mov $off_value & off_mask,%ebx
                      	   200M 		mov $0,%eax
                      	   201M 		mov %eax,%es:(%ebx)
                      	   202M 		mov $value,%eax
                      	   203M 		addr16
                      	   204M 		stosl     # STORE EAX in ES:EDI
                      	   205M 		.if 16 = 16
                      	   206M 			addr32
                      	   207M 			cmp %eax,%es:(%ebx)
                      	   208M 		.else
                      	   209M 			cmp %eax,%es:(%ebx)
                      	   210M 		.endif
                      	   211M 		jne error
                      	   212M 		cmp $off_cmp,%edi
                      	   213M 		jne error
                      	   214M 
                      	   215M 		mov $off_value,%esi
                      	   216M 		mov $off_value,%edi
                      	   217M 		mov $off_value & off_mask,%ebx
                      	   218M 		mov %eax,%ds:(%ebx)
                      	   219M 		mov %eax,%es:(%ebx)
                      	   220M 		cmp $0,%eax
                      	   221M 		je error
                      	   222M 		addr16
                      	   223M 		cmpsl     # COMPARE ES:EDI with DS:ESI
                      	   224M 		jne error
                      	   225M 		cmp $off_cmp,%edi
                      	   226M 		jne error
                      	   227M 		cmp $off_cmp,%esi
                      	   228M 		jne error
                      	   229M 
                      	   230M 		mov $off_value,%edi
                      	   231M 		mov $value,%eax
                      	   232M 		mov %eax,%es:(%ebx)
                      	   233M 		cmp $0,%eax
                      	   234M 		addr16
                      	   235M 		scasl     # SCAN/COMPARE ES:EDI with EAX
                      	   236M 		jne error
                      	   237M 		cmp $off_cmp,%edi
                      	   238M 		jne error
                      	   239M 
                      	   240M 		mov $off_value,%esi
                      	   241M 		mov $off_value,%edi
                      	   242M 		mov $value,%eax
                      	   243M 		mov %eax,%ds:(%ebx)
                      	   244M 		mov $0,%eax
                      	   245M 		mov %eax,%es:(%ebx)
                      	   246M 		addr16
                      	   247M 		movsl        # MOVE data from DS:ESI to ES:EDI
                      	   248M 		mov $value,%eax
                      	   249M 		.if 16 = 16
                      	   250M 			addr32
                      	   251M 			cmp %eax,%es:(%ebx)
                      	   252M 		.else
                      	   253M 			cmp %eax,%es:(%ebx)
                      	   254M 		.endif
                      	   255M 		jne error
                      	   256M 		cmp $off_cmp,%edi
                      	   257M 		jne error
                      	   258M 		cmp $off_cmp,%esi
                      	   259M 		jne error
                      	   260M 
                      	   261M 		mov $off_value,%esi
                      	   262M 		mov $value,%eax
                      	   263M 		mov %eax,%es:(%ebx)
                      	   264M 		xor %eax,%eax
                      	   265M 		addr16
                      	   266M 		lodsl       # LOAD data from DS:ESI into EAX
                      	   267M 		cmp $value & val_mask,%eax
                      	   268M 		jne error
                      	   269M 		cmp $off_cmp,%esi
                      	   270M 		jne error
                      	   271M 	.endif
                      	   272M 
                      	   241: 	testStringOps d,1,16
                      	     1M 
                      	     2M 	.set value,0x12345678
                      	     3M 	.if d = b
                      	     4M 		.set val_size,1
                      	     5M 		.set val_mask,0x000000ff
                      	     6M 	.endif
                      	     7M 	.if d = w
                      	     8M 		.set val_size,2
                      	     9M 		.set val_mask,0x0000ffff
                      	    10M 	.endif
                      	    11M 	.if d = d
                      	    12M 		.set val_size,4
                      	    13M 		.set val_mask,0xffffffff
                      	    14M 	.endif
                      	    15M 
                      	    16M 	.if 1 == 0
                      	    17M 		cld
                      	    18M 		.set off_value,0x0001ffff-(val_size-1)
                      	    19M 		.if 16 = 16
                      	    20M 			# 16-bit addressing
                      	    21M 			.set off_cmp,0x00010000
                      	    22M 		.else
                      	    23M 			# 32-bit addressing
                      	    24M 			.set off_cmp,0x00020000
                      	    25M 		.endif
                      	    26M 	.else
04:00000A98 FD        	    27M 		std
                      	    28M 		.set off_value,0x00010000
                      	    29M 		.if 16 = 16
                      	    30M 			# 16-bit addressing
                      	    31M 			.set off_cmp,0x0001ffff-(val_size-1)
                      	    32M 		.else
                      	    33M 			# 32-bit addressing
                      	    34M 			.set off_cmp,0x0000ffff-(val_size-1)
                      	    35M 		.endif
                      	    36M 	.endif
                      	    37M 
                      	    38M 	.if 16 = 16
                      	    39M 		.set off_mask,0x0000ffff
                      	    40M 	.else
                      	    41M 		.set off_mask,0xffffffff
                      	    42M 	.endif
                      	    43M 
                      	    44M 	# VERIFY string operands
                      	    45M 	.if d = b
                      	    46M 		mov $off_value,%edi
                      	    47M 		mov $off_value & off_mask,%ebx
                      	    48M 		mov $0,%al
                      	    49M 		mov %al,%es:(%ebx)
                      	    50M 		mov $value,%al
                      	    51M 		addr16
                      	    52M 		stosb		 	# STORE EAX in ES:EDI
                      	    53M 		.if 16 = 16
                      	    54M 			addr32
                      	    55M 			cmp %al,%es:(%ebx)
                      	    56M 		.else
                      	    57M 			cmp %al,%es:(%ebx)
                      	    58M 		.endif
                      	    59M 		jne error
                      	    60M 		cmp $off_cmp,%edi
                      	    61M 		jne error
                      	    62M 
                      	    63M 		mov $off_value,%esi
                      	    64M 		mov $off_value,%edi
                      	    65M 		mov $off_value & off_mask,%ebx
                      	    66M 		mov %al,%ds:(%ebx)
                      	    67M 		mov %al,%es:(%ebx)
                      	    68M 		cmp $0,%al
                      	    69M 		je error
                      	    70M 		addr16
                      	    71M 		cmpsb     # COMPARE ES:EDI with DS:ESI
                      	    72M 		jne error
                      	    73M 		cmp $off_cmp,%edi
                      	    74M 		jne error
                      	    75M 		cmp $off_cmp,%esi
                      	    76M 		jne error
                      	    77M 
                      	    78M 		mov $off_value,%edi
                      	    79M 		mov $value,%al
                      	    80M 		mov %al,%es:(%ebx)
                      	    81M 		cmp $0,%al
                      	    82M 		addr16
                      	    83M 		scasb     # SCAN/COMPARE ES:EDI with EAX
                      	    84M 		jne error
                      	    85M 		cmp $off_cmp,%edi
                      	    86M 		jne error
                      	    87M 
                      	    88M 		mov $off_value,%esi
                      	    89M 		mov $off_value,%edi
                      	    90M 		mov $value,%al
                      	    91M 		mov %al,%ds:(%ebx)
                      	    92M 		mov $0,%al
                      	    93M 		mov %al,%es:(%ebx)
                      	    94M 		addr16
                      	    95M 		movsb        # MOVE data from DS:ESI to ES:EDI
                      	    96M 		mov $value,%al
                      	    97M 		.if 16 = 16
                      	    98M 			addr32
                      	    99M 			cmp %al,%es:(%ebx)
                      	   100M 		.else
                      	   101M 			cmp %al,%es:(%ebx)
                      	   102M 		.endif
                      	   103M 		jne error
                      	   104M 		cmp $off_cmp,%edi
                      	   105M 		jne error
                      	   106M 		cmp $off_cmp,%esi
                      	   107M 		jne error
                      	   108M 
                      	   109M 		mov $off_value,%esi
                      	   110M 		mov $value,%al
                      	   111M 		mov %al,%es:(%ebx)
                      	   112M 		xor %eax,%eax
                      	   113M 		addr16
                      	   114M 		lodsb       # LOAD data from DS:ESI into EAX
                      	   115M 		cmp $value & val_mask,%al
                      	   116M 		jne error
                      	   117M 		cmp $off_cmp,%esi
                      	   118M 		jne error
                      	   119M 	.endif
                      	   120M 
                      	   121M 	.if d = w
                      	   122M 		mov $off_value,%edi
                      	   123M 		mov $off_value & off_mask,%ebx
                      	   124M 		mov $0,%ax
                      	   125M 		mov %ax,%es:(%ebx)
                      	   126M 		mov $value,%ax
                      	   127M 		addr16
                      	   128M 		stosw     # STORE EAX in ES:EDI
                      	   129M 		.if 16 = 16
                      	   130M 			addr32
                      	   131M 			cmp %ax,%es:(%ebx)
                      	   132M 		.else
                      	   133M 			cmp %ax,%es:(%ebx)
                      	   134M 		.endif
                      	   135M 		jne error
                      	   136M 		cmp $off_cmp,%edi
                      	   137M 		jne error
                      	   138M 
                      	   139M 		mov $off_value,%esi
                      	   140M 		mov $off_value,%edi
                      	   141M 		mov $off_value & off_mask,%ebx
                      	   142M 		mov %ax,%ds:(%ebx)
                      	   143M 		mov %ax,%es:(%ebx)
                      	   144M 		cmp $0,%ax
                      	   145M 		je error
                      	   146M 		addr16
                      	   147M 		cmpsw     # COMPARE ES:EDI with DS:ESI
                      	   148M 		jne error
                      	   149M 		cmp $off_cmp,%edi
                      	   150M 		jne error
                      	   151M 		cmp $off_cmp,%esi
                      	   152M 		jne error
                      	   153M 
                      	   154M 		mov $off_value,%edi
                      	   155M 		mov $value,%ax
                      	   156M 		mov %ax,%es:(%ebx)
                      	   157M 		cmp $0,%ax
                      	   158M 		addr16
                      	   159M 		scasw     # SCAN/COMPARE ES:EDI with EAX
                      	   160M 		jne error
                      	   161M 		cmp $off_cmp,%edi
                      	   162M 		jne error
                      	   163M 
                      	   164M 		mov $off_value,%esi
                      	   165M 		mov $off_value,%edi
                      	   166M 		mov $value,%ax
                      	   167M 		mov %ax,%ds:(%ebx)
                      	   168M 		mov $0,%ax
                      	   169M 		mov %ax,%es:(%ebx)
                      	   170M 		addr16
                      	   171M 		movsw 					# MOVE data from DS:ESI to ES:EDI
                      	   172M 		mov $value,%ax
                      	   173M 		.if 16 = 16
                      	   174M 			addr32
                      	   175M 			cmp %ax,%es:(%ebx)
                      	   176M 		.else
                      	   177M 			cmp %ax,%es:(%ebx)
                      	   178M 		.endif
                      	   179M 		jne error
                      	   180M 		cmp $off_cmp,%edi
                      	   181M 		jne error
                      	   182M 		cmp $off_cmp,%esi
                      	   183M 		jne error
                      	   184M 
                      	   185M 		mov $off_value,%esi
                      	   186M 		mov $value,%ax
                      	   187M 		mov %ax,%es:(%ebx)
                      	   188M 		xor %eax,%eax
                      	   189M 		addr16
                      	   190M 		lodsw       # LOAD data from DS:ESI into EAX
                      	   191M 		cmp $value & val_mask,%ax
                      	   192M 		jne error
                      	   193M 		cmp $off_cmp,%esi
                      	   194M 		jne error
                      	   195M 	.endif
                      	   196M 
                      	   197M 	.if d = d
04:00000A99 66BF000001	   198M 		mov $off_value,%edi
04:00000A9E 00
04:00000A9F 66BB000000	   199M 		mov $off_value & off_mask,%ebx
04:00000AA4 00
04:00000AA5 66B8000000	   200M 		mov $0,%eax
04:00000AAA 00
04:00000AAB 66268903  	   201M 		mov %eax,%es:(%ebx)
04:00000AAF 66B8785634	   202M 		mov $value,%eax
04:00000AB4 12
04:00000AB5 67        	   203M 		addr16
04:00000AB6 66AB      	   204M 		stosl     # STORE EAX in ES:EDI
                      	   205M 		.if 16 = 16
04:00000AB8 67        	   206M 			addr32
04:00000AB9 66263903  	   207M 			cmp %eax,%es:(%ebx)
                      	   208M 		.else
                      	   209M 			cmp %eax,%es:(%ebx)
                      	   210M 		.endif
04:00000ABD 0F857E0D  	   211M 		jne error
04:00000AC1 6681FFFCFF	   212M 		cmp $off_cmp,%edi
04:00000AC6 0100
04:00000AC8 0F85730D  	   213M 		jne error
                      	   214M 
04:00000ACC 66BE000001	   215M 		mov $off_value,%esi
04:00000AD1 00
04:00000AD2 66BF000001	   216M 		mov $off_value,%edi
04:00000AD7 00
04:00000AD8 66BB000000	   217M 		mov $off_value & off_mask,%ebx
04:00000ADD 00
04:00000ADE 668903    	   218M 		mov %eax,%ds:(%ebx)
04:00000AE1 66268903  	   219M 		mov %eax,%es:(%ebx)
04:00000AE5 6683F800  	   220M 		cmp $0,%eax
04:00000AE9 0F84520D  	   221M 		je error
04:00000AED 67        	   222M 		addr16
04:00000AEE 66A7      	   223M 		cmpsl     # COMPARE ES:EDI with DS:ESI
04:00000AF0 0F854B0D  	   224M 		jne error
04:00000AF4 6681FFFCFF	   225M 		cmp $off_cmp,%edi
04:00000AF9 0100
04:00000AFB 0F85400D  	   226M 		jne error
04:00000AFF 6681FEFCFF	   227M 		cmp $off_cmp,%esi
04:00000B04 0100
04:00000B06 0F85350D  	   228M 		jne error
                      	   229M 
04:00000B0A 66BF000001	   230M 		mov $off_value,%edi
04:00000B0F 00
04:00000B10 66B8785634	   231M 		mov $value,%eax
04:00000B15 12
04:00000B16 66268903  	   232M 		mov %eax,%es:(%ebx)
04:00000B1A 6683F800  	   233M 		cmp $0,%eax
04:00000B1E 67        	   234M 		addr16
04:00000B1F 66AF      	   235M 		scasl     # SCAN/COMPARE ES:EDI with EAX
04:00000B21 0F851A0D  	   236M 		jne error
04:00000B25 6681FFFCFF	   237M 		cmp $off_cmp,%edi
04:00000B2A 0100
04:00000B2C 0F850F0D  	   238M 		jne error
                      	   239M 
04:00000B30 66BE000001	   240M 		mov $off_value,%esi
04:00000B35 00
04:00000B36 66BF000001	   241M 		mov $off_value,%edi
04:00000B3B 00
04:00000B3C 66B8785634	   242M 		mov $value,%eax
04:00000B41 12
04:00000B42 668903    	   243M 		mov %eax,%ds:(%ebx)
04:00000B45 66B8000000	   244M 		mov $0,%eax
04:00000B4A 00
04:00000B4B 66268903  	   245M 		mov %eax,%es:(%ebx)
04:00000B4F 67        	   246M 		addr16
04:00000B50 66A5      	   247M 		movsl        # MOVE data from DS:ESI to ES:EDI
04:00000B52 66B8785634	   248M 		mov $value,%eax
04:00000B57 12
                      	   249M 		.if 16 = 16
04:00000B58 67        	   250M 			addr32
04:00000B59 66263903  	   251M 			cmp %eax,%es:(%ebx)
                      	   252M 		.else
                      	   253M 			cmp %eax,%es:(%ebx)
                      	   254M 		.endif
04:00000B5D 0F85DE0C  	   255M 		jne error
04:00000B61 6681FFFCFF	   256M 		cmp $off_cmp,%edi
04:00000B66 0100
04:00000B68 0F85D30C  	   257M 		jne error
04:00000B6C 6681FEFCFF	   258M 		cmp $off_cmp,%esi
04:00000B71 0100
04:00000B73 0F85C80C  	   259M 		jne error
                      	   260M 
04:00000B77 66BE000001	   261M 		mov $off_value,%esi
04:00000B7C 00
04:00000B7D 66B8785634	   262M 		mov $value,%eax
04:00000B82 12
04:00000B83 66268903  	   263M 		mov %eax,%es:(%ebx)
04:00000B87 6631C0    	   264M 		xor %eax,%eax
04:00000B8A 67        	   265M 		addr16
04:00000B8B 66AD      	   266M 		lodsl       # LOAD data from DS:ESI into EAX
04:00000B8D 663D785634	   267M 		cmp $value & val_mask,%eax
04:00000B92 12
04:00000B93 0F85A80C  	   268M 		jne error
04:00000B97 6681FEFCFF	   269M 		cmp $off_cmp,%esi
04:00000B9C 0100
04:00000B9E 0F859D0C  	   270M 		jne error
                      	   271M 	.endif
                      	   272M 
                      	   242: 	testStringReps b,0,16
                      	     1M 
                      	     2M 	.set bytes,0x100
                      	     3M 
                      	     4M 	.if b = b
                      	     5M 		.set items,bytes
                      	     6M 	.endif
                      	     7M 	.if b = w
                      	     8M 		.set items,bytes/2
                      	     9M 	.endif
                      	    10M 	.if b = d
                      	    11M 		.set items,bytes/4
                      	    12M 	.endif
                      	    13M 
                      	    14M 	.if 0 == 0
04:00000BA2 FC        	    15M 		cld
                      	    16M 		.set off_value,0x0001ff00
                      	    17M 		.if 16 = 16
                      	    18M 			# 16-bit addressing
                      	    19M 			.set off_cmp,0x00010000
                      	    20M 		.else
                      	    21M 			# 32-bit addressing
                      	    22M 			.set off_cmp,0x00020000
                      	    23M 		.endif
                      	    24M 	.else
                      	    25M 		std
                      	    26M 		.set off_value,0x000100ff
                      	    27M 		.if 16 = 16
                      	    28M 			# 16-bit addressing
                      	    29M 			.set off_cmp,0x0001ffff
                      	    30M 		.else
                      	    31M 			# 32-bit addressing
                      	    32M 			.set off_cmp,0x0000ffff
                      	    33M 		.endif
                      	    34M 	.endif
                      	    35M 
04:00000BA3 66B8785634	    36M 	mov $0x12345678,%eax
04:00000BA8 12
04:00000BA9 66BE00FF01	    37M 	mov $off_value,%esi
04:00000BAE 00
04:00000BAF 66BF00FF01	    38M 	mov $off_value,%edi
04:00000BB4 00
                      	    39M 
                      	    40M 	# VERIFY REPs on memory buffers
                      	    41M 
                      	    42M 	# STORE buffers with pattern in EAX
04:00000BB5 66B8785634	    43M 	mov $0x12345678,%eax
04:00000BBA 12
04:00000BBB 66BE00FF01	    44M 	mov $off_value,%esi
04:00000BC0 00
04:00000BC1 66BF00FF01	    45M 	mov $off_value,%edi
04:00000BC6 00
04:00000BC7 66B9000100	    46M 	mov $items,%ecx
04:00000BCC 00
                      	    47M 	.if b = b
04:00000BCD 67        	    48M 		addr16
04:00000BCE F3        	    49M 		rep
04:00000BCF AA        	    50M 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	    51M 	.endif
                      	    52M 	.if b = w
                      	    53M 		addr16
                      	    54M 		rep
                      	    55M 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	    56M 	.endif
                      	    57M 	.if b = d
                      	    58M 		addr16
                      	    59M 		rep
                      	    60M 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	    61M 	.endif
04:00000BD0 6683F900  	    62M 	cmp $0,%ecx
04:00000BD4 0F85670C  	    63M 	jnz error           		# ECX must be 0
04:00000BD8 6681FF0000	    64M 	cmp $off_cmp,%edi
04:00000BDD 0100
04:00000BDF 0F855C0C  	    65M 	jnz error
04:00000BE3 66BF00FF01	    66M 	mov $off_value,%edi  # reset EDI
04:00000BE8 00
                      	    67M 	# now switch ES:EDI with DS:ESI
04:00000BE9 8CC2      	    68M 	mov %es,%dx
04:00000BEB 8CD9      	    69M 	mov %ds,%cx
04:00000BED 87CA      	    70M 	xchg %cx,%dx
04:00000BEF 8EC2      	    71M 	mov %dx,%es
04:00000BF1 8ED9      	    72M 	mov %cx,%ds
04:00000BF3 6687F7    	    73M 	xchg %esi,%edi
                      	    74M 	# store again ES:EDI with pattern in EAX
04:00000BF6 66B9000100	    75M 	mov $items,%ecx      	# reset ECX
04:00000BFB 00
                      	    76M 	.if b = b
04:00000BFC 67        	    77M 		addr16
04:00000BFD F3        	    78M 		rep
04:00000BFE AA        	    79M 		stosb
                      	    80M 	.endif
                      	    81M 	.if b = w
                      	    82M 		addr16
                      	    83M 		rep
                      	    84M 		stosw
                      	    85M 	.endif
                      	    86M 	.if b = d
                      	    87M 		addr16
                      	    88M 		rep
                      	    89M 		stosl
                      	    90M 	.endif
04:00000BFF 66BF00FF01	    91M 	mov $off_value,%edi  	# reset EDI
04:00000C04 00
                      	    92M 
                      	    93M 	# COMPARE two buffers
04:00000C05 66B9000100	    94M 	mov $items,%ecx      # reset ECX
04:00000C0A 00
                      	    95M 	.if b = b
04:00000C0B 67        	    96M 		addr16
04:00000C0C F3        	    97M 		repe
04:00000C0D A6        	    98M 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	    99M 	.endif
                      	   100M 	.if b = w
                      	   101M 		addr16
                      	   102M 		repe
                      	   103M 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   104M 	.endif
                      	   105M 	.if b = d
                      	   106M 		addr16
                      	   107M 		repe
                      	   108M 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   109M 	.endif
04:00000C0E 6683F900  	   110M 	cmp $0,%ecx
04:00000C12 0F85290C  	   111M 	jnz error           		# ECX must be 0
04:00000C16 6681FE0000	   112M 	cmp $off_cmp,%esi
04:00000C1B 0100
04:00000C1D 0F851E0C  	   113M 	jne error
04:00000C21 6681FF0000	   114M 	cmp $off_cmp,%edi
04:00000C26 0100
04:00000C28 0F85130C  	   115M 	jne error
04:00000C2C 66BF00FF01	   116M 	mov $off_value,%edi  # reset EDI
04:00000C31 00
04:00000C32 66BE00FF01	   117M 	mov $off_value,%esi  # reset ESI
04:00000C37 00
                      	   118M 
                      	   119M 	# SCAN buffer for pattern
04:00000C38 66B9000100	   120M 	mov $items,%ecx      # reset ECX
04:00000C3D 00
                      	   121M 	.if b = b
04:00000C3E 67        	   122M 		addr16
04:00000C3F F3        	   123M 		repe
04:00000C40 AE        	   124M 		scasb         # SCAN first dword not equal to EAX
                      	   125M 	.endif
                      	   126M 	.if b = w
                      	   127M 		addr16
                      	   128M 		repe
                      	   129M 		scasw         # SCAN first dword not equal to EAX
                      	   130M 	.endif
                      	   131M 	.if b = d
                      	   132M 		addr16
                      	   133M 		repe
                      	   134M 		scasl         # SCAN first dword not equal to EAX
                      	   135M 	.endif
04:00000C41 6683F900  	   136M 	cmp $0,%ecx
04:00000C45 0F85F60B  	   137M 	jne error           		# ECX must be 0
04:00000C49 6681FF0000	   138M 	cmp $off_cmp,%edi
04:00000C4E 0100
04:00000C50 0F85EB0B  	   139M 	jne error
04:00000C54 66BF00FF01	   140M 	mov $off_value,%edi  		# rewind EDI
04:00000C59 00
                      	   141M 
                      	   142M 	# MOVE and COMPARE data between buffers
                      	   143M 	# first zero-fill ES:EDI so that we can compare the moved data later
04:00000C5A 66B8000000	   144M 	mov $0,%eax
04:00000C5F 00
04:00000C60 66B9000100	   145M 	mov $items,%ecx      # reset ECX
04:00000C65 00
                      	   146M 	.if b = b
04:00000C66 67        	   147M 		addr16
04:00000C67 F3        	   148M 		rep
04:00000C68 AA        	   149M 		stosb          # zero fill ES:EDI
                      	   150M 	.endif
                      	   151M 	.if b = w
                      	   152M 		addr16
                      	   153M 		rep
                      	   154M 		stosw          # zero fill ES:EDI
                      	   155M 	.endif
                      	   156M 	.if b = d
                      	   157M 		addr16
                      	   158M 		rep
                      	   159M 		stosl          # zero fill ES:EDI
                      	   160M 	.endif
04:00000C69 66BF00FF01	   161M 	mov $off_value,%edi  # reset EDI
04:00000C6E 00
04:00000C6F 66B9000100	   162M 	mov $items,%ecx      # reset ECX
04:00000C74 00
                      	   163M 	.if b = b
04:00000C75 67        	   164M 		addr16
04:00000C76 F3        	   165M 		rep
04:00000C77 A4        	   166M 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   167M 	.endif
                      	   168M 	.if b = w
                      	   169M 		addr16
                      	   170M 		rep
                      	   171M 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   172M 	.endif
                      	   173M 	.if b = d
                      	   174M 		addr16
                      	   175M 		rep
                      	   176M 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   177M 	.endif
04:00000C78 6683F900  	   178M 	cmp $0,%ecx
04:00000C7C 0F85BF0B  	   179M 	jne error           	# ECX must be 0
04:00000C80 6681FE0000	   180M 	cmp $off_cmp,%esi
04:00000C85 0100
04:00000C87 0F85B40B  	   181M 	jne error
04:00000C8B 6681FF0000	   182M 	cmp $off_cmp,%edi
04:00000C90 0100
04:00000C92 0F85A90B  	   183M 	jne error
04:00000C96 66B9000100	   184M 	mov $items,%ecx      	# reset ECX
04:00000C9B 00
04:00000C9C 66BF00FF01	   185M 	mov $off_value,%edi  	# reset EDI
04:00000CA1 00
04:00000CA2 66BE00FF01	   186M 	mov $off_value,%esi  	# reset ESI
04:00000CA7 00
                      	   187M 	.if b = b
04:00000CA8 67        	   188M 		addr16
04:00000CA9 F3        	   189M 		repe
04:00000CAA A6        	   190M 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   191M 	.endif
                      	   192M 	.if b = w
                      	   193M 		addr16
                      	   194M 		repe
                      	   195M 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   196M 	.endif
                      	   197M 	.if b = d
                      	   198M 		addr16
                      	   199M 		repe
                      	   200M 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   201M 	.endif
04:00000CAB 6683F900  	   202M 	cmp $0,%ecx
04:00000CAF 0F858C0B  	   203M 	jne error           # ECX must be 0
04:00000CB3 6681FE0000	   204M 	cmp $off_cmp,%esi
04:00000CB8 0100
04:00000CBA 0F85810B  	   205M 	jne error
04:00000CBE 6681FF0000	   206M 	cmp $off_cmp,%edi
04:00000CC3 0100
04:00000CC5 0F85760B  	   207M 	jne error
                      	   243: 	testStringReps w,0,16
                      	     1M 
                      	     2M 	.set bytes,0x100
                      	     3M 
                      	     4M 	.if w = b
                      	     5M 		.set items,bytes
                      	     6M 	.endif
                      	     7M 	.if w = w
                      	     8M 		.set items,bytes/2
                      	     9M 	.endif
                      	    10M 	.if w = d
                      	    11M 		.set items,bytes/4
                      	    12M 	.endif
                      	    13M 
                      	    14M 	.if 0 == 0
04:00000CC9 FC        	    15M 		cld
                      	    16M 		.set off_value,0x0001ff00
                      	    17M 		.if 16 = 16
                      	    18M 			# 16-bit addressing
                      	    19M 			.set off_cmp,0x00010000
                      	    20M 		.else
                      	    21M 			# 32-bit addressing
                      	    22M 			.set off_cmp,0x00020000
                      	    23M 		.endif
                      	    24M 	.else
                      	    25M 		std
                      	    26M 		.set off_value,0x000100ff
                      	    27M 		.if 16 = 16
                      	    28M 			# 16-bit addressing
                      	    29M 			.set off_cmp,0x0001ffff
                      	    30M 		.else
                      	    31M 			# 32-bit addressing
                      	    32M 			.set off_cmp,0x0000ffff
                      	    33M 		.endif
                      	    34M 	.endif
                      	    35M 
04:00000CCA 66B8785634	    36M 	mov $0x12345678,%eax
04:00000CCF 12
04:00000CD0 66BE00FF01	    37M 	mov $off_value,%esi
04:00000CD5 00
04:00000CD6 66BF00FF01	    38M 	mov $off_value,%edi
04:00000CDB 00
                      	    39M 
                      	    40M 	# VERIFY REPs on memory buffers
                      	    41M 
                      	    42M 	# STORE buffers with pattern in EAX
04:00000CDC 66B8785634	    43M 	mov $0x12345678,%eax
04:00000CE1 12
04:00000CE2 66BE00FF01	    44M 	mov $off_value,%esi
04:00000CE7 00
04:00000CE8 66BF00FF01	    45M 	mov $off_value,%edi
04:00000CED 00
04:00000CEE 66B9800000	    46M 	mov $items,%ecx
04:00000CF3 00
                      	    47M 	.if w = b
                      	    48M 		addr16
                      	    49M 		rep
                      	    50M 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	    51M 	.endif
                      	    52M 	.if w = w
04:00000CF4 67        	    53M 		addr16
04:00000CF5 F3        	    54M 		rep
04:00000CF6 AB        	    55M 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	    56M 	.endif
                      	    57M 	.if w = d
                      	    58M 		addr16
                      	    59M 		rep
                      	    60M 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	    61M 	.endif
04:00000CF7 6683F900  	    62M 	cmp $0,%ecx
04:00000CFB 0F85400B  	    63M 	jnz error           		# ECX must be 0
04:00000CFF 6681FF0000	    64M 	cmp $off_cmp,%edi
04:00000D04 0100
04:00000D06 0F85350B  	    65M 	jnz error
04:00000D0A 66BF00FF01	    66M 	mov $off_value,%edi  # reset EDI
04:00000D0F 00
                      	    67M 	# now switch ES:EDI with DS:ESI
04:00000D10 8CC2      	    68M 	mov %es,%dx
04:00000D12 8CD9      	    69M 	mov %ds,%cx
04:00000D14 87CA      	    70M 	xchg %cx,%dx
04:00000D16 8EC2      	    71M 	mov %dx,%es
04:00000D18 8ED9      	    72M 	mov %cx,%ds
04:00000D1A 6687F7    	    73M 	xchg %esi,%edi
                      	    74M 	# store again ES:EDI with pattern in EAX
04:00000D1D 66B9800000	    75M 	mov $items,%ecx      	# reset ECX
04:00000D22 00
                      	    76M 	.if w = b
                      	    77M 		addr16
                      	    78M 		rep
                      	    79M 		stosb
                      	    80M 	.endif
                      	    81M 	.if w = w
04:00000D23 67        	    82M 		addr16
04:00000D24 F3        	    83M 		rep
04:00000D25 AB        	    84M 		stosw
                      	    85M 	.endif
                      	    86M 	.if w = d
                      	    87M 		addr16
                      	    88M 		rep
                      	    89M 		stosl
                      	    90M 	.endif
04:00000D26 66BF00FF01	    91M 	mov $off_value,%edi  	# reset EDI
04:00000D2B 00
                      	    92M 
                      	    93M 	# COMPARE two buffers
04:00000D2C 66B9800000	    94M 	mov $items,%ecx      # reset ECX
04:00000D31 00
                      	    95M 	.if w = b
                      	    96M 		addr16
                      	    97M 		repe
                      	    98M 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	    99M 	.endif
                      	   100M 	.if w = w
04:00000D32 67        	   101M 		addr16
04:00000D33 F3        	   102M 		repe
04:00000D34 A7        	   103M 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   104M 	.endif
                      	   105M 	.if w = d
                      	   106M 		addr16
                      	   107M 		repe
                      	   108M 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   109M 	.endif
04:00000D35 6683F900  	   110M 	cmp $0,%ecx
04:00000D39 0F85020B  	   111M 	jnz error           		# ECX must be 0
04:00000D3D 6681FE0000	   112M 	cmp $off_cmp,%esi
04:00000D42 0100
04:00000D44 0F85F70A  	   113M 	jne error
04:00000D48 6681FF0000	   114M 	cmp $off_cmp,%edi
04:00000D4D 0100
04:00000D4F 0F85EC0A  	   115M 	jne error
04:00000D53 66BF00FF01	   116M 	mov $off_value,%edi  # reset EDI
04:00000D58 00
04:00000D59 66BE00FF01	   117M 	mov $off_value,%esi  # reset ESI
04:00000D5E 00
                      	   118M 
                      	   119M 	# SCAN buffer for pattern
04:00000D5F 66B9800000	   120M 	mov $items,%ecx      # reset ECX
04:00000D64 00
                      	   121M 	.if w = b
                      	   122M 		addr16
                      	   123M 		repe
                      	   124M 		scasb         # SCAN first dword not equal to EAX
                      	   125M 	.endif
                      	   126M 	.if w = w
04:00000D65 67        	   127M 		addr16
04:00000D66 F3        	   128M 		repe
04:00000D67 AF        	   129M 		scasw         # SCAN first dword not equal to EAX
                      	   130M 	.endif
                      	   131M 	.if w = d
                      	   132M 		addr16
                      	   133M 		repe
                      	   134M 		scasl         # SCAN first dword not equal to EAX
                      	   135M 	.endif
04:00000D68 6683F900  	   136M 	cmp $0,%ecx
04:00000D6C 0F85CF0A  	   137M 	jne error           		# ECX must be 0
04:00000D70 6681FF0000	   138M 	cmp $off_cmp,%edi
04:00000D75 0100
04:00000D77 0F85C40A  	   139M 	jne error
04:00000D7B 66BF00FF01	   140M 	mov $off_value,%edi  		# rewind EDI
04:00000D80 00
                      	   141M 
                      	   142M 	# MOVE and COMPARE data between buffers
                      	   143M 	# first zero-fill ES:EDI so that we can compare the moved data later
04:00000D81 66B8000000	   144M 	mov $0,%eax
04:00000D86 00
04:00000D87 66B9800000	   145M 	mov $items,%ecx      # reset ECX
04:00000D8C 00
                      	   146M 	.if w = b
                      	   147M 		addr16
                      	   148M 		rep
                      	   149M 		stosb          # zero fill ES:EDI
                      	   150M 	.endif
                      	   151M 	.if w = w
04:00000D8D 67        	   152M 		addr16
04:00000D8E F3        	   153M 		rep
04:00000D8F AB        	   154M 		stosw          # zero fill ES:EDI
                      	   155M 	.endif
                      	   156M 	.if w = d
                      	   157M 		addr16
                      	   158M 		rep
                      	   159M 		stosl          # zero fill ES:EDI
                      	   160M 	.endif
04:00000D90 66BF00FF01	   161M 	mov $off_value,%edi  # reset EDI
04:00000D95 00
04:00000D96 66B9800000	   162M 	mov $items,%ecx      # reset ECX
04:00000D9B 00
                      	   163M 	.if w = b
                      	   164M 		addr16
                      	   165M 		rep
                      	   166M 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   167M 	.endif
                      	   168M 	.if w = w
04:00000D9C 67        	   169M 		addr16
04:00000D9D F3        	   170M 		rep
04:00000D9E A5        	   171M 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   172M 	.endif
                      	   173M 	.if w = d
                      	   174M 		addr16
                      	   175M 		rep
                      	   176M 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   177M 	.endif
04:00000D9F 6683F900  	   178M 	cmp $0,%ecx
04:00000DA3 0F85980A  	   179M 	jne error           	# ECX must be 0
04:00000DA7 6681FE0000	   180M 	cmp $off_cmp,%esi
04:00000DAC 0100
04:00000DAE 0F858D0A  	   181M 	jne error
04:00000DB2 6681FF0000	   182M 	cmp $off_cmp,%edi
04:00000DB7 0100
04:00000DB9 0F85820A  	   183M 	jne error
04:00000DBD 66B9800000	   184M 	mov $items,%ecx      	# reset ECX
04:00000DC2 00
04:00000DC3 66BF00FF01	   185M 	mov $off_value,%edi  	# reset EDI
04:00000DC8 00
04:00000DC9 66BE00FF01	   186M 	mov $off_value,%esi  	# reset ESI
04:00000DCE 00
                      	   187M 	.if w = b
                      	   188M 		addr16
                      	   189M 		repe
                      	   190M 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   191M 	.endif
                      	   192M 	.if w = w
04:00000DCF 67        	   193M 		addr16
04:00000DD0 F3        	   194M 		repe
04:00000DD1 A7        	   195M 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   196M 	.endif
                      	   197M 	.if w = d
                      	   198M 		addr16
                      	   199M 		repe
                      	   200M 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   201M 	.endif
04:00000DD2 6683F900  	   202M 	cmp $0,%ecx
04:00000DD6 0F85650A  	   203M 	jne error           # ECX must be 0
04:00000DDA 6681FE0000	   204M 	cmp $off_cmp,%esi
04:00000DDF 0100
04:00000DE1 0F855A0A  	   205M 	jne error
04:00000DE5 6681FF0000	   206M 	cmp $off_cmp,%edi
04:00000DEA 0100
04:00000DEC 0F854F0A  	   207M 	jne error
                      	   244: 	testStringReps d,0,16
                      	     1M 
                      	     2M 	.set bytes,0x100
                      	     3M 
                      	     4M 	.if d = b
                      	     5M 		.set items,bytes
                      	     6M 	.endif
                      	     7M 	.if d = w
                      	     8M 		.set items,bytes/2
                      	     9M 	.endif
                      	    10M 	.if d = d
                      	    11M 		.set items,bytes/4
                      	    12M 	.endif
                      	    13M 
                      	    14M 	.if 0 == 0
04:00000DF0 FC        	    15M 		cld
                      	    16M 		.set off_value,0x0001ff00
                      	    17M 		.if 16 = 16
                      	    18M 			# 16-bit addressing
                      	    19M 			.set off_cmp,0x00010000
                      	    20M 		.else
                      	    21M 			# 32-bit addressing
                      	    22M 			.set off_cmp,0x00020000
                      	    23M 		.endif
                      	    24M 	.else
                      	    25M 		std
                      	    26M 		.set off_value,0x000100ff
                      	    27M 		.if 16 = 16
                      	    28M 			# 16-bit addressing
                      	    29M 			.set off_cmp,0x0001ffff
                      	    30M 		.else
                      	    31M 			# 32-bit addressing
                      	    32M 			.set off_cmp,0x0000ffff
                      	    33M 		.endif
                      	    34M 	.endif
                      	    35M 
04:00000DF1 66B8785634	    36M 	mov $0x12345678,%eax
04:00000DF6 12
04:00000DF7 66BE00FF01	    37M 	mov $off_value,%esi
04:00000DFC 00
04:00000DFD 66BF00FF01	    38M 	mov $off_value,%edi
04:00000E02 00
                      	    39M 
                      	    40M 	# VERIFY REPs on memory buffers
                      	    41M 
                      	    42M 	# STORE buffers with pattern in EAX
04:00000E03 66B8785634	    43M 	mov $0x12345678,%eax
04:00000E08 12
04:00000E09 66BE00FF01	    44M 	mov $off_value,%esi
04:00000E0E 00
04:00000E0F 66BF00FF01	    45M 	mov $off_value,%edi
04:00000E14 00
04:00000E15 66B9400000	    46M 	mov $items,%ecx
04:00000E1A 00
                      	    47M 	.if d = b
                      	    48M 		addr16
                      	    49M 		rep
                      	    50M 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	    51M 	.endif
                      	    52M 	.if d = w
                      	    53M 		addr16
                      	    54M 		rep
                      	    55M 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	    56M 	.endif
                      	    57M 	.if d = d
04:00000E1B 67        	    58M 		addr16
04:00000E1C F3        	    59M 		rep
04:00000E1D 66AB      	    60M 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	    61M 	.endif
04:00000E1F 6683F900  	    62M 	cmp $0,%ecx
04:00000E23 0F85180A  	    63M 	jnz error           		# ECX must be 0
04:00000E27 6681FF0000	    64M 	cmp $off_cmp,%edi
04:00000E2C 0100
04:00000E2E 0F850D0A  	    65M 	jnz error
04:00000E32 66BF00FF01	    66M 	mov $off_value,%edi  # reset EDI
04:00000E37 00
                      	    67M 	# now switch ES:EDI with DS:ESI
04:00000E38 8CC2      	    68M 	mov %es,%dx
04:00000E3A 8CD9      	    69M 	mov %ds,%cx
04:00000E3C 87CA      	    70M 	xchg %cx,%dx
04:00000E3E 8EC2      	    71M 	mov %dx,%es
04:00000E40 8ED9      	    72M 	mov %cx,%ds
04:00000E42 6687F7    	    73M 	xchg %esi,%edi
                      	    74M 	# store again ES:EDI with pattern in EAX
04:00000E45 66B9400000	    75M 	mov $items,%ecx      	# reset ECX
04:00000E4A 00
                      	    76M 	.if d = b
                      	    77M 		addr16
                      	    78M 		rep
                      	    79M 		stosb
                      	    80M 	.endif
                      	    81M 	.if d = w
                      	    82M 		addr16
                      	    83M 		rep
                      	    84M 		stosw
                      	    85M 	.endif
                      	    86M 	.if d = d
04:00000E4B 67        	    87M 		addr16
04:00000E4C F3        	    88M 		rep
04:00000E4D 66AB      	    89M 		stosl
                      	    90M 	.endif
04:00000E4F 66BF00FF01	    91M 	mov $off_value,%edi  	# reset EDI
04:00000E54 00
                      	    92M 
                      	    93M 	# COMPARE two buffers
04:00000E55 66B9400000	    94M 	mov $items,%ecx      # reset ECX
04:00000E5A 00
                      	    95M 	.if d = b
                      	    96M 		addr16
                      	    97M 		repe
                      	    98M 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	    99M 	.endif
                      	   100M 	.if d = w
                      	   101M 		addr16
                      	   102M 		repe
                      	   103M 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   104M 	.endif
                      	   105M 	.if d = d
04:00000E5B 67        	   106M 		addr16
04:00000E5C F3        	   107M 		repe
04:00000E5D 66A7      	   108M 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   109M 	.endif
04:00000E5F 6683F900  	   110M 	cmp $0,%ecx
04:00000E63 0F85D809  	   111M 	jnz error           		# ECX must be 0
04:00000E67 6681FE0000	   112M 	cmp $off_cmp,%esi
04:00000E6C 0100
04:00000E6E 0F85CD09  	   113M 	jne error
04:00000E72 6681FF0000	   114M 	cmp $off_cmp,%edi
04:00000E77 0100
04:00000E79 0F85C209  	   115M 	jne error
04:00000E7D 66BF00FF01	   116M 	mov $off_value,%edi  # reset EDI
04:00000E82 00
04:00000E83 66BE00FF01	   117M 	mov $off_value,%esi  # reset ESI
04:00000E88 00
                      	   118M 
                      	   119M 	# SCAN buffer for pattern
04:00000E89 66B9400000	   120M 	mov $items,%ecx      # reset ECX
04:00000E8E 00
                      	   121M 	.if d = b
                      	   122M 		addr16
                      	   123M 		repe
                      	   124M 		scasb         # SCAN first dword not equal to EAX
                      	   125M 	.endif
                      	   126M 	.if d = w
                      	   127M 		addr16
                      	   128M 		repe
                      	   129M 		scasw         # SCAN first dword not equal to EAX
                      	   130M 	.endif
                      	   131M 	.if d = d
04:00000E8F 67        	   132M 		addr16
04:00000E90 F3        	   133M 		repe
04:00000E91 66AF      	   134M 		scasl         # SCAN first dword not equal to EAX
                      	   135M 	.endif
04:00000E93 6683F900  	   136M 	cmp $0,%ecx
04:00000E97 0F85A409  	   137M 	jne error           		# ECX must be 0
04:00000E9B 6681FF0000	   138M 	cmp $off_cmp,%edi
04:00000EA0 0100
04:00000EA2 0F859909  	   139M 	jne error
04:00000EA6 66BF00FF01	   140M 	mov $off_value,%edi  		# rewind EDI
04:00000EAB 00
                      	   141M 
                      	   142M 	# MOVE and COMPARE data between buffers
                      	   143M 	# first zero-fill ES:EDI so that we can compare the moved data later
04:00000EAC 66B8000000	   144M 	mov $0,%eax
04:00000EB1 00
04:00000EB2 66B9400000	   145M 	mov $items,%ecx      # reset ECX
04:00000EB7 00
                      	   146M 	.if d = b
                      	   147M 		addr16
                      	   148M 		rep
                      	   149M 		stosb          # zero fill ES:EDI
                      	   150M 	.endif
                      	   151M 	.if d = w
                      	   152M 		addr16
                      	   153M 		rep
                      	   154M 		stosw          # zero fill ES:EDI
                      	   155M 	.endif
                      	   156M 	.if d = d
04:00000EB8 67        	   157M 		addr16
04:00000EB9 F3        	   158M 		rep
04:00000EBA 66AB      	   159M 		stosl          # zero fill ES:EDI
                      	   160M 	.endif
04:00000EBC 66BF00FF01	   161M 	mov $off_value,%edi  # reset EDI
04:00000EC1 00
04:00000EC2 66B9400000	   162M 	mov $items,%ecx      # reset ECX
04:00000EC7 00
                      	   163M 	.if d = b
                      	   164M 		addr16
                      	   165M 		rep
                      	   166M 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   167M 	.endif
                      	   168M 	.if d = w
                      	   169M 		addr16
                      	   170M 		rep
                      	   171M 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   172M 	.endif
                      	   173M 	.if d = d
04:00000EC8 67        	   174M 		addr16
04:00000EC9 F3        	   175M 		rep
04:00000ECA 66A5      	   176M 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   177M 	.endif
04:00000ECC 6683F900  	   178M 	cmp $0,%ecx
04:00000ED0 0F856B09  	   179M 	jne error           	# ECX must be 0
04:00000ED4 6681FE0000	   180M 	cmp $off_cmp,%esi
04:00000ED9 0100
04:00000EDB 0F856009  	   181M 	jne error
04:00000EDF 6681FF0000	   182M 	cmp $off_cmp,%edi
04:00000EE4 0100
04:00000EE6 0F855509  	   183M 	jne error
04:00000EEA 66B9400000	   184M 	mov $items,%ecx      	# reset ECX
04:00000EEF 00
04:00000EF0 66BF00FF01	   185M 	mov $off_value,%edi  	# reset EDI
04:00000EF5 00
04:00000EF6 66BE00FF01	   186M 	mov $off_value,%esi  	# reset ESI
04:00000EFB 00
                      	   187M 	.if d = b
                      	   188M 		addr16
                      	   189M 		repe
                      	   190M 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   191M 	.endif
                      	   192M 	.if d = w
                      	   193M 		addr16
                      	   194M 		repe
                      	   195M 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   196M 	.endif
                      	   197M 	.if d = d
04:00000EFC 67        	   198M 		addr16
04:00000EFD F3        	   199M 		repe
04:00000EFE 66A7      	   200M 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   201M 	.endif
04:00000F00 6683F900  	   202M 	cmp $0,%ecx
04:00000F04 0F853709  	   203M 	jne error           # ECX must be 0
04:00000F08 6681FE0000	   204M 	cmp $off_cmp,%esi
04:00000F0D 0100
04:00000F0F 0F852C09  	   205M 	jne error
04:00000F13 6681FF0000	   206M 	cmp $off_cmp,%edi
04:00000F18 0100
04:00000F1A 0F852109  	   207M 	jne error
                      	   245: 	testStringReps b,1,16
                      	     1M 
                      	     2M 	.set bytes,0x100
                      	     3M 
                      	     4M 	.if b = b
                      	     5M 		.set items,bytes
                      	     6M 	.endif
                      	     7M 	.if b = w
                      	     8M 		.set items,bytes/2
                      	     9M 	.endif
                      	    10M 	.if b = d
                      	    11M 		.set items,bytes/4
                      	    12M 	.endif
                      	    13M 
                      	    14M 	.if 1 == 0
                      	    15M 		cld
                      	    16M 		.set off_value,0x0001ff00
                      	    17M 		.if 16 = 16
                      	    18M 			# 16-bit addressing
                      	    19M 			.set off_cmp,0x00010000
                      	    20M 		.else
                      	    21M 			# 32-bit addressing
                      	    22M 			.set off_cmp,0x00020000
                      	    23M 		.endif
                      	    24M 	.else
04:00000F1E FD        	    25M 		std
                      	    26M 		.set off_value,0x000100ff
                      	    27M 		.if 16 = 16
                      	    28M 			# 16-bit addressing
                      	    29M 			.set off_cmp,0x0001ffff
                      	    30M 		.else
                      	    31M 			# 32-bit addressing
                      	    32M 			.set off_cmp,0x0000ffff
                      	    33M 		.endif
                      	    34M 	.endif
                      	    35M 
04:00000F1F 66B8785634	    36M 	mov $0x12345678,%eax
04:00000F24 12
04:00000F25 66BEFF0001	    37M 	mov $off_value,%esi
04:00000F2A 00
04:00000F2B 66BFFF0001	    38M 	mov $off_value,%edi
04:00000F30 00
                      	    39M 
                      	    40M 	# VERIFY REPs on memory buffers
                      	    41M 
                      	    42M 	# STORE buffers with pattern in EAX
04:00000F31 66B8785634	    43M 	mov $0x12345678,%eax
04:00000F36 12
04:00000F37 66BEFF0001	    44M 	mov $off_value,%esi
04:00000F3C 00
04:00000F3D 66BFFF0001	    45M 	mov $off_value,%edi
04:00000F42 00
04:00000F43 66B9000100	    46M 	mov $items,%ecx
04:00000F48 00
                      	    47M 	.if b = b
04:00000F49 67        	    48M 		addr16
04:00000F4A F3        	    49M 		rep
04:00000F4B AA        	    50M 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	    51M 	.endif
                      	    52M 	.if b = w
                      	    53M 		addr16
                      	    54M 		rep
                      	    55M 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	    56M 	.endif
                      	    57M 	.if b = d
                      	    58M 		addr16
                      	    59M 		rep
                      	    60M 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	    61M 	.endif
04:00000F4C 6683F900  	    62M 	cmp $0,%ecx
04:00000F50 0F85EB08  	    63M 	jnz error           		# ECX must be 0
04:00000F54 6681FFFFFF	    64M 	cmp $off_cmp,%edi
04:00000F59 0100
04:00000F5B 0F85E008  	    65M 	jnz error
04:00000F5F 66BFFF0001	    66M 	mov $off_value,%edi  # reset EDI
04:00000F64 00
                      	    67M 	# now switch ES:EDI with DS:ESI
04:00000F65 8CC2      	    68M 	mov %es,%dx
04:00000F67 8CD9      	    69M 	mov %ds,%cx
04:00000F69 87CA      	    70M 	xchg %cx,%dx
04:00000F6B 8EC2      	    71M 	mov %dx,%es
04:00000F6D 8ED9      	    72M 	mov %cx,%ds
04:00000F6F 6687F7    	    73M 	xchg %esi,%edi
                      	    74M 	# store again ES:EDI with pattern in EAX
04:00000F72 66B9000100	    75M 	mov $items,%ecx      	# reset ECX
04:00000F77 00
                      	    76M 	.if b = b
04:00000F78 67        	    77M 		addr16
04:00000F79 F3        	    78M 		rep
04:00000F7A AA        	    79M 		stosb
                      	    80M 	.endif
                      	    81M 	.if b = w
                      	    82M 		addr16
                      	    83M 		rep
                      	    84M 		stosw
                      	    85M 	.endif
                      	    86M 	.if b = d
                      	    87M 		addr16
                      	    88M 		rep
                      	    89M 		stosl
                      	    90M 	.endif
04:00000F7B 66BFFF0001	    91M 	mov $off_value,%edi  	# reset EDI
04:00000F80 00
                      	    92M 
                      	    93M 	# COMPARE two buffers
04:00000F81 66B9000100	    94M 	mov $items,%ecx      # reset ECX
04:00000F86 00
                      	    95M 	.if b = b
04:00000F87 67        	    96M 		addr16
04:00000F88 F3        	    97M 		repe
04:00000F89 A6        	    98M 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	    99M 	.endif
                      	   100M 	.if b = w
                      	   101M 		addr16
                      	   102M 		repe
                      	   103M 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   104M 	.endif
                      	   105M 	.if b = d
                      	   106M 		addr16
                      	   107M 		repe
                      	   108M 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   109M 	.endif
04:00000F8A 6683F900  	   110M 	cmp $0,%ecx
04:00000F8E 0F85AD08  	   111M 	jnz error           		# ECX must be 0
04:00000F92 6681FEFFFF	   112M 	cmp $off_cmp,%esi
04:00000F97 0100
04:00000F99 0F85A208  	   113M 	jne error
04:00000F9D 6681FFFFFF	   114M 	cmp $off_cmp,%edi
04:00000FA2 0100
04:00000FA4 0F859708  	   115M 	jne error
04:00000FA8 66BFFF0001	   116M 	mov $off_value,%edi  # reset EDI
04:00000FAD 00
04:00000FAE 66BEFF0001	   117M 	mov $off_value,%esi  # reset ESI
04:00000FB3 00
                      	   118M 
                      	   119M 	# SCAN buffer for pattern
04:00000FB4 66B9000100	   120M 	mov $items,%ecx      # reset ECX
04:00000FB9 00
                      	   121M 	.if b = b
04:00000FBA 67        	   122M 		addr16
04:00000FBB F3        	   123M 		repe
04:00000FBC AE        	   124M 		scasb         # SCAN first dword not equal to EAX
                      	   125M 	.endif
                      	   126M 	.if b = w
                      	   127M 		addr16
                      	   128M 		repe
                      	   129M 		scasw         # SCAN first dword not equal to EAX
                      	   130M 	.endif
                      	   131M 	.if b = d
                      	   132M 		addr16
                      	   133M 		repe
                      	   134M 		scasl         # SCAN first dword not equal to EAX
                      	   135M 	.endif
04:00000FBD 6683F900  	   136M 	cmp $0,%ecx
04:00000FC1 0F857A08  	   137M 	jne error           		# ECX must be 0
04:00000FC5 6681FFFFFF	   138M 	cmp $off_cmp,%edi
04:00000FCA 0100
04:00000FCC 0F856F08  	   139M 	jne error
04:00000FD0 66BFFF0001	   140M 	mov $off_value,%edi  		# rewind EDI
04:00000FD5 00
                      	   141M 
                      	   142M 	# MOVE and COMPARE data between buffers
                      	   143M 	# first zero-fill ES:EDI so that we can compare the moved data later
04:00000FD6 66B8000000	   144M 	mov $0,%eax
04:00000FDB 00
04:00000FDC 66B9000100	   145M 	mov $items,%ecx      # reset ECX
04:00000FE1 00
                      	   146M 	.if b = b
04:00000FE2 67        	   147M 		addr16
04:00000FE3 F3        	   148M 		rep
04:00000FE4 AA        	   149M 		stosb          # zero fill ES:EDI
                      	   150M 	.endif
                      	   151M 	.if b = w
                      	   152M 		addr16
                      	   153M 		rep
                      	   154M 		stosw          # zero fill ES:EDI
                      	   155M 	.endif
                      	   156M 	.if b = d
                      	   157M 		addr16
                      	   158M 		rep
                      	   159M 		stosl          # zero fill ES:EDI
                      	   160M 	.endif
04:00000FE5 66BFFF0001	   161M 	mov $off_value,%edi  # reset EDI
04:00000FEA 00
04:00000FEB 66B9000100	   162M 	mov $items,%ecx      # reset ECX
04:00000FF0 00
                      	   163M 	.if b = b
04:00000FF1 67        	   164M 		addr16
04:00000FF2 F3        	   165M 		rep
04:00000FF3 A4        	   166M 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   167M 	.endif
                      	   168M 	.if b = w
                      	   169M 		addr16
                      	   170M 		rep
                      	   171M 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   172M 	.endif
                      	   173M 	.if b = d
                      	   174M 		addr16
                      	   175M 		rep
                      	   176M 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   177M 	.endif
04:00000FF4 6683F900  	   178M 	cmp $0,%ecx
04:00000FF8 0F854308  	   179M 	jne error           	# ECX must be 0
04:00000FFC 6681FEFFFF	   180M 	cmp $off_cmp,%esi
04:00001001 0100
04:00001003 0F853808  	   181M 	jne error
04:00001007 6681FFFFFF	   182M 	cmp $off_cmp,%edi
04:0000100C 0100
04:0000100E 0F852D08  	   183M 	jne error
04:00001012 66B9000100	   184M 	mov $items,%ecx      	# reset ECX
04:00001017 00
04:00001018 66BFFF0001	   185M 	mov $off_value,%edi  	# reset EDI
04:0000101D 00
04:0000101E 66BEFF0001	   186M 	mov $off_value,%esi  	# reset ESI
04:00001023 00
                      	   187M 	.if b = b
04:00001024 67        	   188M 		addr16
04:00001025 F3        	   189M 		repe
04:00001026 A6        	   190M 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   191M 	.endif
                      	   192M 	.if b = w
                      	   193M 		addr16
                      	   194M 		repe
                      	   195M 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   196M 	.endif
                      	   197M 	.if b = d
                      	   198M 		addr16
                      	   199M 		repe
                      	   200M 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   201M 	.endif
04:00001027 6683F900  	   202M 	cmp $0,%ecx
04:0000102B 0F851008  	   203M 	jne error           # ECX must be 0
04:0000102F 6681FEFFFF	   204M 	cmp $off_cmp,%esi
04:00001034 0100
04:00001036 0F850508  	   205M 	jne error
04:0000103A 6681FFFFFF	   206M 	cmp $off_cmp,%edi
04:0000103F 0100
04:00001041 0F85FA07  	   207M 	jne error
                      	   246: 	testStringReps w,1,16
                      	     1M 
                      	     2M 	.set bytes,0x100
                      	     3M 
                      	     4M 	.if w = b
                      	     5M 		.set items,bytes
                      	     6M 	.endif
                      	     7M 	.if w = w
                      	     8M 		.set items,bytes/2
                      	     9M 	.endif
                      	    10M 	.if w = d
                      	    11M 		.set items,bytes/4
                      	    12M 	.endif
                      	    13M 
                      	    14M 	.if 1 == 0
                      	    15M 		cld
                      	    16M 		.set off_value,0x0001ff00
                      	    17M 		.if 16 = 16
                      	    18M 			# 16-bit addressing
                      	    19M 			.set off_cmp,0x00010000
                      	    20M 		.else
                      	    21M 			# 32-bit addressing
                      	    22M 			.set off_cmp,0x00020000
                      	    23M 		.endif
                      	    24M 	.else
04:00001045 FD        	    25M 		std
                      	    26M 		.set off_value,0x000100ff
                      	    27M 		.if 16 = 16
                      	    28M 			# 16-bit addressing
                      	    29M 			.set off_cmp,0x0001ffff
                      	    30M 		.else
                      	    31M 			# 32-bit addressing
                      	    32M 			.set off_cmp,0x0000ffff
                      	    33M 		.endif
                      	    34M 	.endif
                      	    35M 
04:00001046 66B8785634	    36M 	mov $0x12345678,%eax
04:0000104B 12
04:0000104C 66BEFF0001	    37M 	mov $off_value,%esi
04:00001051 00
04:00001052 66BFFF0001	    38M 	mov $off_value,%edi
04:00001057 00
                      	    39M 
                      	    40M 	# VERIFY REPs on memory buffers
                      	    41M 
                      	    42M 	# STORE buffers with pattern in EAX
04:00001058 66B8785634	    43M 	mov $0x12345678,%eax
04:0000105D 12
04:0000105E 66BEFF0001	    44M 	mov $off_value,%esi
04:00001063 00
04:00001064 66BFFF0001	    45M 	mov $off_value,%edi
04:00001069 00
04:0000106A 66B9800000	    46M 	mov $items,%ecx
04:0000106F 00
                      	    47M 	.if w = b
                      	    48M 		addr16
                      	    49M 		rep
                      	    50M 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	    51M 	.endif
                      	    52M 	.if w = w
04:00001070 67        	    53M 		addr16
04:00001071 F3        	    54M 		rep
04:00001072 AB        	    55M 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	    56M 	.endif
                      	    57M 	.if w = d
                      	    58M 		addr16
                      	    59M 		rep
                      	    60M 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	    61M 	.endif
04:00001073 6683F900  	    62M 	cmp $0,%ecx
04:00001077 0F85C407  	    63M 	jnz error           		# ECX must be 0
04:0000107B 6681FFFFFF	    64M 	cmp $off_cmp,%edi
04:00001080 0100
04:00001082 0F85B907  	    65M 	jnz error
04:00001086 66BFFF0001	    66M 	mov $off_value,%edi  # reset EDI
04:0000108B 00
                      	    67M 	# now switch ES:EDI with DS:ESI
04:0000108C 8CC2      	    68M 	mov %es,%dx
04:0000108E 8CD9      	    69M 	mov %ds,%cx
04:00001090 87CA      	    70M 	xchg %cx,%dx
04:00001092 8EC2      	    71M 	mov %dx,%es
04:00001094 8ED9      	    72M 	mov %cx,%ds
04:00001096 6687F7    	    73M 	xchg %esi,%edi
                      	    74M 	# store again ES:EDI with pattern in EAX
04:00001099 66B9800000	    75M 	mov $items,%ecx      	# reset ECX
04:0000109E 00
                      	    76M 	.if w = b
                      	    77M 		addr16
                      	    78M 		rep
                      	    79M 		stosb
                      	    80M 	.endif
                      	    81M 	.if w = w
04:0000109F 67        	    82M 		addr16
04:000010A0 F3        	    83M 		rep
04:000010A1 AB        	    84M 		stosw
                      	    85M 	.endif
                      	    86M 	.if w = d
                      	    87M 		addr16
                      	    88M 		rep
                      	    89M 		stosl
                      	    90M 	.endif
04:000010A2 66BFFF0001	    91M 	mov $off_value,%edi  	# reset EDI
04:000010A7 00
                      	    92M 
                      	    93M 	# COMPARE two buffers
04:000010A8 66B9800000	    94M 	mov $items,%ecx      # reset ECX
04:000010AD 00
                      	    95M 	.if w = b
                      	    96M 		addr16
                      	    97M 		repe
                      	    98M 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	    99M 	.endif
                      	   100M 	.if w = w
04:000010AE 67        	   101M 		addr16
04:000010AF F3        	   102M 		repe
04:000010B0 A7        	   103M 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   104M 	.endif
                      	   105M 	.if w = d
                      	   106M 		addr16
                      	   107M 		repe
                      	   108M 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   109M 	.endif
04:000010B1 6683F900  	   110M 	cmp $0,%ecx
04:000010B5 0F858607  	   111M 	jnz error           		# ECX must be 0
04:000010B9 6681FEFFFF	   112M 	cmp $off_cmp,%esi
04:000010BE 0100
04:000010C0 0F857B07  	   113M 	jne error
04:000010C4 6681FFFFFF	   114M 	cmp $off_cmp,%edi
04:000010C9 0100
04:000010CB 0F857007  	   115M 	jne error
04:000010CF 66BFFF0001	   116M 	mov $off_value,%edi  # reset EDI
04:000010D4 00
04:000010D5 66BEFF0001	   117M 	mov $off_value,%esi  # reset ESI
04:000010DA 00
                      	   118M 
                      	   119M 	# SCAN buffer for pattern
04:000010DB 66B9800000	   120M 	mov $items,%ecx      # reset ECX
04:000010E0 00
                      	   121M 	.if w = b
                      	   122M 		addr16
                      	   123M 		repe
                      	   124M 		scasb         # SCAN first dword not equal to EAX
                      	   125M 	.endif
                      	   126M 	.if w = w
04:000010E1 67        	   127M 		addr16
04:000010E2 F3        	   128M 		repe
04:000010E3 AF        	   129M 		scasw         # SCAN first dword not equal to EAX
                      	   130M 	.endif
                      	   131M 	.if w = d
                      	   132M 		addr16
                      	   133M 		repe
                      	   134M 		scasl         # SCAN first dword not equal to EAX
                      	   135M 	.endif
04:000010E4 6683F900  	   136M 	cmp $0,%ecx
04:000010E8 0F855307  	   137M 	jne error           		# ECX must be 0
04:000010EC 6681FFFFFF	   138M 	cmp $off_cmp,%edi
04:000010F1 0100
04:000010F3 0F854807  	   139M 	jne error
04:000010F7 66BFFF0001	   140M 	mov $off_value,%edi  		# rewind EDI
04:000010FC 00
                      	   141M 
                      	   142M 	# MOVE and COMPARE data between buffers
                      	   143M 	# first zero-fill ES:EDI so that we can compare the moved data later
04:000010FD 66B8000000	   144M 	mov $0,%eax
04:00001102 00
04:00001103 66B9800000	   145M 	mov $items,%ecx      # reset ECX
04:00001108 00
                      	   146M 	.if w = b
                      	   147M 		addr16
                      	   148M 		rep
                      	   149M 		stosb          # zero fill ES:EDI
                      	   150M 	.endif
                      	   151M 	.if w = w
04:00001109 67        	   152M 		addr16
04:0000110A F3        	   153M 		rep
04:0000110B AB        	   154M 		stosw          # zero fill ES:EDI
                      	   155M 	.endif
                      	   156M 	.if w = d
                      	   157M 		addr16
                      	   158M 		rep
                      	   159M 		stosl          # zero fill ES:EDI
                      	   160M 	.endif
04:0000110C 66BFFF0001	   161M 	mov $off_value,%edi  # reset EDI
04:00001111 00
04:00001112 66B9800000	   162M 	mov $items,%ecx      # reset ECX
04:00001117 00
                      	   163M 	.if w = b
                      	   164M 		addr16
                      	   165M 		rep
                      	   166M 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   167M 	.endif
                      	   168M 	.if w = w
04:00001118 67        	   169M 		addr16
04:00001119 F3        	   170M 		rep
04:0000111A A5        	   171M 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   172M 	.endif
                      	   173M 	.if w = d
                      	   174M 		addr16
                      	   175M 		rep
                      	   176M 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   177M 	.endif
04:0000111B 6683F900  	   178M 	cmp $0,%ecx
04:0000111F 0F851C07  	   179M 	jne error           	# ECX must be 0
04:00001123 6681FEFFFF	   180M 	cmp $off_cmp,%esi
04:00001128 0100
04:0000112A 0F851107  	   181M 	jne error
04:0000112E 6681FFFFFF	   182M 	cmp $off_cmp,%edi
04:00001133 0100
04:00001135 0F850607  	   183M 	jne error
04:00001139 66B9800000	   184M 	mov $items,%ecx      	# reset ECX
04:0000113E 00
04:0000113F 66BFFF0001	   185M 	mov $off_value,%edi  	# reset EDI
04:00001144 00
04:00001145 66BEFF0001	   186M 	mov $off_value,%esi  	# reset ESI
04:0000114A 00
                      	   187M 	.if w = b
                      	   188M 		addr16
                      	   189M 		repe
                      	   190M 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   191M 	.endif
                      	   192M 	.if w = w
04:0000114B 67        	   193M 		addr16
04:0000114C F3        	   194M 		repe
04:0000114D A7        	   195M 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   196M 	.endif
                      	   197M 	.if w = d
                      	   198M 		addr16
                      	   199M 		repe
                      	   200M 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   201M 	.endif
04:0000114E 6683F900  	   202M 	cmp $0,%ecx
04:00001152 0F85E906  	   203M 	jne error           # ECX must be 0
04:00001156 6681FEFFFF	   204M 	cmp $off_cmp,%esi
04:0000115B 0100
04:0000115D 0F85DE06  	   205M 	jne error
04:00001161 6681FFFFFF	   206M 	cmp $off_cmp,%edi
04:00001166 0100
04:00001168 0F85D306  	   207M 	jne error
                      	   247: 	testStringReps d,1,16
                      	     1M 
                      	     2M 	.set bytes,0x100
                      	     3M 
                      	     4M 	.if d = b
                      	     5M 		.set items,bytes
                      	     6M 	.endif
                      	     7M 	.if d = w
                      	     8M 		.set items,bytes/2
                      	     9M 	.endif
                      	    10M 	.if d = d
                      	    11M 		.set items,bytes/4
                      	    12M 	.endif
                      	    13M 
                      	    14M 	.if 1 == 0
                      	    15M 		cld
                      	    16M 		.set off_value,0x0001ff00
                      	    17M 		.if 16 = 16
                      	    18M 			# 16-bit addressing
                      	    19M 			.set off_cmp,0x00010000
                      	    20M 		.else
                      	    21M 			# 32-bit addressing
                      	    22M 			.set off_cmp,0x00020000
                      	    23M 		.endif
                      	    24M 	.else
04:0000116C FD        	    25M 		std
                      	    26M 		.set off_value,0x000100ff
                      	    27M 		.if 16 = 16
                      	    28M 			# 16-bit addressing
                      	    29M 			.set off_cmp,0x0001ffff
                      	    30M 		.else
                      	    31M 			# 32-bit addressing
                      	    32M 			.set off_cmp,0x0000ffff
                      	    33M 		.endif
                      	    34M 	.endif
                      	    35M 
04:0000116D 66B8785634	    36M 	mov $0x12345678,%eax
04:00001172 12
04:00001173 66BEFF0001	    37M 	mov $off_value,%esi
04:00001178 00
04:00001179 66BFFF0001	    38M 	mov $off_value,%edi
04:0000117E 00
                      	    39M 
                      	    40M 	# VERIFY REPs on memory buffers
                      	    41M 
                      	    42M 	# STORE buffers with pattern in EAX
04:0000117F 66B8785634	    43M 	mov $0x12345678,%eax
04:00001184 12
04:00001185 66BEFF0001	    44M 	mov $off_value,%esi
04:0000118A 00
04:0000118B 66BFFF0001	    45M 	mov $off_value,%edi
04:00001190 00
04:00001191 66B9400000	    46M 	mov $items,%ecx
04:00001196 00
                      	    47M 	.if d = b
                      	    48M 		addr16
                      	    49M 		rep
                      	    50M 		stosb    # store ECX items at ES:EDI with the value in EAX
                      	    51M 	.endif
                      	    52M 	.if d = w
                      	    53M 		addr16
                      	    54M 		rep
                      	    55M 		stosw    # store ECX items at ES:EDI with the value in EAX
                      	    56M 	.endif
                      	    57M 	.if d = d
04:00001197 67        	    58M 		addr16
04:00001198 F3        	    59M 		rep
04:00001199 66AB      	    60M 		stosl    # store ECX items at ES:EDI with the value in EAX
                      	    61M 	.endif
04:0000119B 6683F900  	    62M 	cmp $0,%ecx
04:0000119F 0F859C06  	    63M 	jnz error           		# ECX must be 0
04:000011A3 6681FFFFFF	    64M 	cmp $off_cmp,%edi
04:000011A8 0100
04:000011AA 0F859106  	    65M 	jnz error
04:000011AE 66BFFF0001	    66M 	mov $off_value,%edi  # reset EDI
04:000011B3 00
                      	    67M 	# now switch ES:EDI with DS:ESI
04:000011B4 8CC2      	    68M 	mov %es,%dx
04:000011B6 8CD9      	    69M 	mov %ds,%cx
04:000011B8 87CA      	    70M 	xchg %cx,%dx
04:000011BA 8EC2      	    71M 	mov %dx,%es
04:000011BC 8ED9      	    72M 	mov %cx,%ds
04:000011BE 6687F7    	    73M 	xchg %esi,%edi
                      	    74M 	# store again ES:EDI with pattern in EAX
04:000011C1 66B9400000	    75M 	mov $items,%ecx      	# reset ECX
04:000011C6 00
                      	    76M 	.if d = b
                      	    77M 		addr16
                      	    78M 		rep
                      	    79M 		stosb
                      	    80M 	.endif
                      	    81M 	.if d = w
                      	    82M 		addr16
                      	    83M 		rep
                      	    84M 		stosw
                      	    85M 	.endif
                      	    86M 	.if d = d
04:000011C7 67        	    87M 		addr16
04:000011C8 F3        	    88M 		rep
04:000011C9 66AB      	    89M 		stosl
                      	    90M 	.endif
04:000011CB 66BFFF0001	    91M 	mov $off_value,%edi  	# reset EDI
04:000011D0 00
                      	    92M 
                      	    93M 	# COMPARE two buffers
04:000011D1 66B9400000	    94M 	mov $items,%ecx      # reset ECX
04:000011D6 00
                      	    95M 	.if d = b
                      	    96M 		addr16
                      	    97M 		repe
                      	    98M 		cmpsb # find nonmatching items in ES:EDI and DS:ESI
                      	    99M 	.endif
                      	   100M 	.if d = w
                      	   101M 		addr16
                      	   102M 		repe
                      	   103M 		cmpsw # find nonmatching items in ES:EDI and DS:ESI
                      	   104M 	.endif
                      	   105M 	.if d = d
04:000011D7 67        	   106M 		addr16
04:000011D8 F3        	   107M 		repe
04:000011D9 66A7      	   108M 		cmpsl # find nonmatching items in ES:EDI and DS:ESI
                      	   109M 	.endif
04:000011DB 6683F900  	   110M 	cmp $0,%ecx
04:000011DF 0F855C06  	   111M 	jnz error           		# ECX must be 0
04:000011E3 6681FEFFFF	   112M 	cmp $off_cmp,%esi
04:000011E8 0100
04:000011EA 0F855106  	   113M 	jne error
04:000011EE 6681FFFFFF	   114M 	cmp $off_cmp,%edi
04:000011F3 0100
04:000011F5 0F854606  	   115M 	jne error
04:000011F9 66BFFF0001	   116M 	mov $off_value,%edi  # reset EDI
04:000011FE 00
04:000011FF 66BEFF0001	   117M 	mov $off_value,%esi  # reset ESI
04:00001204 00
                      	   118M 
                      	   119M 	# SCAN buffer for pattern
04:00001205 66B9400000	   120M 	mov $items,%ecx      # reset ECX
04:0000120A 00
                      	   121M 	.if d = b
                      	   122M 		addr16
                      	   123M 		repe
                      	   124M 		scasb         # SCAN first dword not equal to EAX
                      	   125M 	.endif
                      	   126M 	.if d = w
                      	   127M 		addr16
                      	   128M 		repe
                      	   129M 		scasw         # SCAN first dword not equal to EAX
                      	   130M 	.endif
                      	   131M 	.if d = d
04:0000120B 67        	   132M 		addr16
04:0000120C F3        	   133M 		repe
04:0000120D 66AF      	   134M 		scasl         # SCAN first dword not equal to EAX
                      	   135M 	.endif
04:0000120F 6683F900  	   136M 	cmp $0,%ecx
04:00001213 0F852806  	   137M 	jne error           		# ECX must be 0
04:00001217 6681FFFFFF	   138M 	cmp $off_cmp,%edi
04:0000121C 0100
04:0000121E 0F851D06  	   139M 	jne error
04:00001222 66BFFF0001	   140M 	mov $off_value,%edi  		# rewind EDI
04:00001227 00
                      	   141M 
                      	   142M 	# MOVE and COMPARE data between buffers
                      	   143M 	# first zero-fill ES:EDI so that we can compare the moved data later
04:00001228 66B8000000	   144M 	mov $0,%eax
04:0000122D 00
04:0000122E 66B9400000	   145M 	mov $items,%ecx      # reset ECX
04:00001233 00
                      	   146M 	.if d = b
                      	   147M 		addr16
                      	   148M 		rep
                      	   149M 		stosb          # zero fill ES:EDI
                      	   150M 	.endif
                      	   151M 	.if d = w
                      	   152M 		addr16
                      	   153M 		rep
                      	   154M 		stosw          # zero fill ES:EDI
                      	   155M 	.endif
                      	   156M 	.if d = d
04:00001234 67        	   157M 		addr16
04:00001235 F3        	   158M 		rep
04:00001236 66AB      	   159M 		stosl          # zero fill ES:EDI
                      	   160M 	.endif
04:00001238 66BFFF0001	   161M 	mov $off_value,%edi  # reset EDI
04:0000123D 00
04:0000123E 66B9400000	   162M 	mov $items,%ecx      # reset ECX
04:00001243 00
                      	   163M 	.if d = b
                      	   164M 		addr16
                      	   165M 		rep
                      	   166M 		movsb          # MOVE data from DS:ESI to ES:EDI
                      	   167M 	.endif
                      	   168M 	.if d = w
                      	   169M 		addr16
                      	   170M 		rep
                      	   171M 		movsw          # MOVE data from DS:ESI to ES:EDI
                      	   172M 	.endif
                      	   173M 	.if d = d
04:00001244 67        	   174M 		addr16
04:00001245 F3        	   175M 		rep
04:00001246 66A5      	   176M 		movsl          # MOVE data from DS:ESI to ES:EDI
                      	   177M 	.endif
04:00001248 6683F900  	   178M 	cmp $0,%ecx
04:0000124C 0F85EF05  	   179M 	jne error           	# ECX must be 0
04:00001250 6681FEFFFF	   180M 	cmp $off_cmp,%esi
04:00001255 0100
04:00001257 0F85E405  	   181M 	jne error
04:0000125B 6681FFFFFF	   182M 	cmp $off_cmp,%edi
04:00001260 0100
04:00001262 0F85D905  	   183M 	jne error
04:00001266 66B9400000	   184M 	mov $items,%ecx      	# reset ECX
04:0000126B 00
04:0000126C 66BFFF0001	   185M 	mov $off_value,%edi  	# reset EDI
04:00001271 00
04:00001272 66BEFF0001	   186M 	mov $off_value,%esi  	# reset ESI
04:00001277 00
                      	   187M 	.if d = b
                      	   188M 		addr16
                      	   189M 		repe
                      	   190M 		cmpsb  # COMPARE moved data in ES:EDI with DS:ESI
                      	   191M 	.endif
                      	   192M 	.if d = w
                      	   193M 		addr16
                      	   194M 		repe
                      	   195M 		cmpsw  # COMPARE moved data in ES:EDI with DS:ESI
                      	   196M 	.endif
                      	   197M 	.if d = d
04:00001278 67        	   198M 		addr16
04:00001279 F3        	   199M 		repe
04:0000127A 66A7      	   200M 		cmpsl  # COMPARE moved data in ES:EDI with DS:ESI
                      	   201M 	.endif
04:0000127C 6683F900  	   202M 	cmp $0,%ecx
04:00001280 0F85BB05  	   203M 	jne error           # ECX must be 0
04:00001284 6681FEFFFF	   204M 	cmp $off_cmp,%esi
04:00001289 0100
04:0000128B 0F85B005  	   205M 	jne error
04:0000128F 6681FFFFFF	   206M 	cmp $off_cmp,%edi
04:00001294 0100
04:00001296 0F85A505  	   207M 	jne error
                      	   248: 
                      	   249: 	advTestSegReal
                      	     1M 	advTestBase
                      	     1M 	.set TEST_BASE1,TEST_BASE1+0x1000
                      	     2M 	.set TEST_BASE2,TEST_BASE2+0x1000
                      	     2M 	.set D1_SEG_REAL,TEST_BASE1 >> 4
                      	     3M 	.set D2_SEG_REAL,TEST_BASE2 >> 4
04:0000129A C7C200C2  	     4M 	mov $D1_SEG_REAL,%dx
04:0000129E 8EDA      	     5M 	mov %dx,%ds
04:000012A0 C7C200C4  	     6M 	mov $D2_SEG_REAL,%dx
04:000012A4 8EC2      	     7M 	mov %dx,%es
                      	   250: 
                      	   251: .include "call_m.asm"

Source: "call_m.asm"
                      	     1: #
                      	     2: #   Tests Call near by displacement and register indirect
                      	     3: #   Stack must be initilized.
                      	     4: #   %1: stack pointer register
                      	     5: #   Uses: AX, EBX, Flags
                      	     6: #
                      	     7: .macro testCallNear arg1
                      	     8: 
                      	     9: 	.ifc \arg1, sp
                      	    10: 		mov %\arg1,%ax
                      	    11: rel16\@:
                      	    12: 		clc
                      	    13: 		data16
                      	    14: 		callw nearfn16\@
                      	    15: 		jnc error
                      	    16: 		jmp rel32\@
                      	    17: nearfn16\@:
                      	    18: 		sub $2,%ax
                      	    19: 		cmp %ax,%\arg1
                      	    20: 		jne error
                      	    21: 		add $2,%ax
                      	    22: 		stc
                      	    23: 		data16
                      	    24: 		ret
                      	    25: 		jmp error
                      	    26: 
                      	    27: rel32\@:
                      	    28: 		clc
                      	    29: 		data32
                      	    30: 		calll nearfn32\@
                      	    31: 		jnc error
                      	    32: 		jmp rm16\@
                      	    33: nearfn32\@:
                      	    34: 		sub $4,%ax
                      	    35: 		cmp %ax,%\arg1
                      	    36: 		jne error
                      	    37: 		add $4,%ax
                      	    38: 		stc
                      	    39: 		data32
                      	    40: 		ret
                      	    41: 		jmp error
                      	    42: 
                      	    43: rm16\@:
                      	    44: 		clc
                      	    45: 		mov $nearfn16\@,%bx
                      	    46: 		data16
                      	    47: 		call %bx
                      	    48: 		jnc error
                      	    49: rm32\@:
                      	    50: 		clc
                      	    51: 		mov $nearfn32\@,%ebx
                      	    52: 		data32
                      	    53: 		call %ebx
                      	    54: 		jnc error
                      	    55: 	.else
                      	    56: 		mov %\arg1,%eax
                      	    57: rel16\@:
                      	    58: 		clc
                      	    59: 		data16
                      	    60: 		callw nearfn16\@
                      	    61: 		jnc error
                      	    62: 		jmp rel32\@
                      	    63: nearfn16\@:
                      	    64: 		sub $2,%eax
                      	    65: 		cmp %eax,%\arg1
                      	    66: 		jne error
                      	    67: 		add $2,%eax
                      	    68: 		stc
                      	    69: 		data16
                      	    70: 		ret
                      	    71: 		jmp error
                      	    72: 
                      	    73: rel32\@:
                      	    74: 		clc
                      	    75: 		data32
                      	    76: 		calll nearfn32\@
                      	    77: 		jnc error
                      	    78: 		jmp rm16\@
                      	    79: nearfn32\@:
                      	    80: 		sub $4,%eax
                      	    81: 		cmp %eax,%\arg1
                      	    82: 		jne error
                      	    83: 		add $4,%eax
                      	    84: 		stc
                      	    85: 		data32
                      	    86: 		ret
                      	    87: 		jmp error
                      	    88: 
                      	    89: rm16\@:
                      	    90: 		clc
                      	    91: 		mov $nearfn16\@,%bx
                      	    92: 		data16
                      	    93: 		call %bx
                      	    94: 		jnc error
                      	    95: rm32\@:
                      	    96: 		clc
                      	    97: 		mov $nearfn32\@,%ebx
                      	    98: 		data32
                      	    99: 		call %ebx
                      	   100: 		jnc error
                      	   101: 	.endif
                      	   102: .endm
                      	   103: 
                      	   104: #
                      	   105: #   Tests Call far by immediate and memory pointers
                      	   106: #   Stack must be initilized
                      	   107: #   %1: code segment
                      	   108: #   Uses: AX, Flags, DS:SI as scratch memory
                      	   109: #
                      	   110: .macro testCallFar arg1
                      	   111: 	mov %sp,%ax
                      	   112: 
                      	   113: 	clc
                      	   114: 	data16
                      	   115: 	callw $\arg1,$farfn16\@
                      	   116: 	jnc error
                      	   117: 	jmp o32\@
                      	   118: farfn16\@:
                      	   119: 	sub $4,%ax
                      	   120: 	cmp %ax,%sp
                      	   121: 	jne error
                      	   122: 	add $4,%ax
                      	   123: 	stc
                      	   124: 	data16
                      	   125: 	retl
                      	   126: 	jmp error
                      	   127: 
                      	   128: o32\@:
                      	   129: 	clc
                      	   130: 	data32
                      	   131: 	calll $\arg1,$farfn32\@
                      	   132: 	jnc error
                      	   133: 	jmp m1616\@
                      	   134: farfn32\@:
                      	   135: 	sub $8,%ax
                      	   136: 	cmp %ax,%sp
                      	   137: 	jne error
                      	   138: 	add $8,%ax
                      	   139: 	stc
                      	   140: 	data32
                      	   141: 	retl
                      	   142: 	jmp error
                      	   143: 
                      	   144: m1616\@:
                      	   145: 	clc
                      	   146: 	movw $farfn16\@,(%si)
                      	   147: 	movw $\arg1,2(%si)
                      	   148: 	data16
                      	   149: 	calll (%si)
                      	   150: 	jnc error
                      	   151: m1632\@:
                      	   152: 	clc
                      	   153: 	movl $farfn32\@,(%si)
                      	   154: 	movw $\arg1,4(%si)
                      	   155: 	data32
                      	   156: 	calll (%si)
                      	   157: 	jnc error
                      	   158: exit\@:
                      	   159: .endm
                      	   160: 

Source: "t386.asm"
                      	   252: #-------------------------------------------------------------------------------
                      	   253: 	POST $0x05
04:000012A6 B005      	     1M 	movb $0x05,%al
04:000012A8 BA9001    	     2M 	movw $POST_PORT,%dx
04:000012AB EE        	     3M 	out %al,%dx
                      	   254: #-------------------------------------------------------------------------------
                      	   255: #
                      	   256: #   Calls in real mode
                      	   257: #
04:000012AC BE0000    	   258: 	mov $0,%si
                      	   259: 	testCallNear sp
                      	     1M 
                      	     2M 	.ifc sp, sp
04:000012AF 89E0      	     3M 		mov %sp,%ax
                      	     4M rel1651:
04:000012B1 F8        	     5M 		clc
04:000012B2 66        	     6M 		data16
04:000012B3 E80600    	     7M 		callw nearfn1651
04:000012B6 0F838505  	     8M 		jnc error
04:000012BA EB12      	     9M 		jmp rel3251
                      	    10M nearfn1651:
04:000012BC 83E802    	    11M 		sub $2,%ax
04:000012BF 39C4      	    12M 		cmp %ax,%sp
04:000012C1 0F857A05  	    13M 		jne error
04:000012C5 83C002    	    14M 		add $2,%ax
04:000012C8 F9        	    15M 		stc
04:000012C9 66        	    16M 		data16
04:000012CA C3        	    17M 		ret
04:000012CB E97105    	    18M 		jmp error
                      	    19M 
                      	    20M rel3251:
04:000012CE F8        	    21M 		clc
04:000012CF 66        	    22M 		data32
04:000012D0 66E80600  	    23M 		calll nearfn3251
04:000012D4 0F836705  	    24M 		jnc error
04:000012D8 EB12      	    25M 		jmp rm1651
                      	    26M nearfn3251:
04:000012DA 83E804    	    27M 		sub $4,%ax
04:000012DD 39C4      	    28M 		cmp %ax,%sp
04:000012DF 0F855C05  	    29M 		jne error
04:000012E3 83C004    	    30M 		add $4,%ax
04:000012E6 F9        	    31M 		stc
04:000012E7 66        	    32M 		data32
04:000012E8 C3        	    33M 		ret
04:000012E9 E95305    	    34M 		jmp error
                      	    35M 
                      	    36M rm1651:
04:000012EC F8        	    37M 		clc
04:000012ED BBBC12    	    38M 		mov $nearfn1651,%bx
04:000012F0 66        	    39M 		data16
04:000012F1 FFD3      	    40M 		call %bx
04:000012F3 0F834805  	    41M 		jnc error
                      	    42M rm3251:
04:000012F7 F8        	    43M 		clc
04:000012F8 66BBDA1200	    44M 		mov $nearfn3251,%ebx
04:000012FD 00
04:000012FE 66        	    45M 		data32
04:000012FF 66FFD3    	    46M 		call %ebx
04:00001302 0F833905  	    47M 		jnc error
                      	    48M 	.else
                      	    49M 		mov %sp,%eax
                      	    50M rel1651:
                      	    51M 		clc
                      	    52M 		data16
                      	    53M 		callw nearfn1651
                      	    54M 		jnc error
                      	    55M 		jmp rel3251
                      	    56M nearfn1651:
                      	    57M 		sub $2,%eax
                      	    58M 		cmp %eax,%sp
                      	    59M 		jne error
                      	    60M 		add $2,%eax
                      	    61M 		stc
                      	    62M 		data16
                      	    63M 		ret
                      	    64M 		jmp error
                      	    65M 
                      	    66M rel3251:
                      	    67M 		clc
                      	    68M 		data32
                      	    69M 		calll nearfn3251
                      	    70M 		jnc error
                      	    71M 		jmp rm1651
                      	    72M nearfn3251:
                      	    73M 		sub $4,%eax
                      	    74M 		cmp %eax,%sp
                      	    75M 		jne error
                      	    76M 		add $4,%eax
                      	    77M 		stc
                      	    78M 		data32
                      	    79M 		ret
                      	    80M 		jmp error
                      	    81M 
                      	    82M rm1651:
                      	    83M 		clc
                      	    84M 		mov $nearfn1651,%bx
                      	    85M 		data16
                      	    86M 		call %bx
                      	    87M 		jnc error
                      	    88M rm3251:
                      	    89M 		clc
                      	    90M 		mov $nearfn3251,%ebx
                      	    91M 		data32
                      	    92M 		call %ebx
                      	    93M 		jnc error
                      	    94M 	.endif
                      	   260: 	testCallFar C_SEG_REAL
04:00001306 89E0      	     1M 	mov %sp,%ax
                      	     2M 
04:00001308 F8        	     3M 	clc
04:00001309 66        	     4M 	data16
04:0000130A 9A00001513	     5M 	callw $C_SEG_REAL,$farfn1652
04:0000130F 0F832C05  	     6M 	jnc error
04:00001313 EB13      	     7M 	jmp o3252
                      	     8M farfn1652:
04:00001315 83E804    	     9M 	sub $4,%ax
04:00001318 39C4      	    10M 	cmp %ax,%sp
04:0000131A 0F852105  	    11M 	jne error
04:0000131E 83C004    	    12M 	add $4,%ax
04:00001321 F9        	    13M 	stc
04:00001322 66        	    14M 	data16
04:00001323 66C3      	    15M 	retl
04:00001325 E91705    	    16M 	jmp error
                      	    17M 
                      	    18M o3252:
04:00001328 F8        	    19M 	clc
04:00001329 66        	    20M 	data32
04:0000132A 669A000038	    21M 	calll $C_SEG_REAL,$farfn3252
04:0000132F 130000
04:00001332 0F830905  	    22M 	jnc error
04:00001336 EB13      	    23M 	jmp m161652
                      	    24M farfn3252:
04:00001338 83E808    	    25M 	sub $8,%ax
04:0000133B 39C4      	    26M 	cmp %ax,%sp
04:0000133D 0F85FE04  	    27M 	jne error
04:00001341 83C008    	    28M 	add $8,%ax
04:00001344 F9        	    29M 	stc
04:00001345 66        	    30M 	data32
04:00001346 66C3      	    31M 	retl
04:00001348 E9F404    	    32M 	jmp error
                      	    33M 
                      	    34M m161652:
04:0000134B F8        	    35M 	clc
04:0000134C C7041513  	    36M 	movw $farfn1652,(%si)
04:00001350 C744020000	    37M 	movw $C_SEG_REAL,2(%si)
04:00001355 66        	    38M 	data16
04:00001356 66FF14    	    39M 	calll (%si)
04:00001359 0F83E204  	    40M 	jnc error
                      	    41M m163252:
04:0000135D F8        	    42M 	clc
04:0000135E 66C7043813	    43M 	movl $farfn3252,(%si)
04:00001363 0000
04:00001365 C744040000	    44M 	movw $C_SEG_REAL,4(%si)
04:0000136A 66        	    45M 	data32
04:0000136B 66FF14    	    46M 	calll (%si)
04:0000136E 0F83CD04  	    47M 	jnc error
                      	    48M exit52:
                      	   261: 
                      	   262: 	advTestSegReal
                      	     1M 	advTestBase
                      	     1M 	.set TEST_BASE1,TEST_BASE1+0x1000
                      	     2M 	.set TEST_BASE2,TEST_BASE2+0x1000
                      	     2M 	.set D1_SEG_REAL,TEST_BASE1 >> 4
                      	     3M 	.set D2_SEG_REAL,TEST_BASE2 >> 4
04:00001372 C7C200C3  	     4M 	mov $D1_SEG_REAL,%dx
04:00001376 8EDA      	     5M 	mov %dx,%ds
04:00001378 C7C200C5  	     6M 	mov $D2_SEG_REAL,%dx
04:0000137C 8EC2      	     7M 	mov %dx,%es
                      	   263: 
                      	   264: 
                      	   265: .include "load_ptr_m.asm"

Source: "load_ptr_m.asm"
                      	     1: #
                      	     2: #   Tests LSS,LDS,LES,LFS,LGS in 16 and 32 bit mode
                      	     3: #   %1 segment register name, one of ss,ds,es,fs,gs
                      	     4: #   [ed:di] memory address to use for the pointer
                      	     5: #   Uses: nothing
                      	     6: #
                      	     7: 
                      	     8: .macro testLoadPtr arg1
                      	     9: 	mov %\arg1,%cx
                      	    10: 	mov %es,%dx
                      	    11: 
                      	    12: 	movw $0x1234,%es:(%di)
                      	    13: 	movw $0xabcd,%es:2(%di)
                      	    14: 	l\arg1 %es:(%di),%bx
                      	    15: 	mov %\arg1,%ax
                      	    16: 	cmp $0xabcd,%ax
                      	    17: 	jne error
                      	    18: 	cmp $0x1234,%bx
                      	    19: 	jne error
                      	    20: 
                      	    21: 	mov %dx,%es
                      	    22: 
                      	    23: 	movl $0x12345678,%es:(%di)
                      	    24: 	movw $0xbcde,%es:4(%di)
                      	    25: 	l\arg1 %es:(%di),%ebx
                      	    26: 	mov %\arg1,%ax
                      	    27: 	cmp $0xbcde,%ax
                      	    28: 	jne error
                      	    29: 	cmp $0x12345678,%ebx
                      	    30: 	jne error
                      	    31: 
                      	    32: 	mov %dx,%es
                      	    33: 	mov %cx,%\arg1
                      	    34: .endm
                      	    35: 

Source: "t386.asm"
                      	   266: #-------------------------------------------------------------------------------
                      	   267: 	POST $0x06
04:0000137E B006      	     1M 	movb $0x06,%al
04:00001380 BA9001    	     2M 	movw $POST_PORT,%dx
04:00001383 EE        	     3M 	out %al,%dx
                      	   268: #-------------------------------------------------------------------------------
                      	   269: #
                      	   270: #   Load full pointer in real mode
                      	   271: #
04:00001384 BF0000    	   272: 	mov $0,%di
                      	   273: 	testLoadPtr ss
04:00001387 8CD1      	     1M 	mov %ss,%cx
04:00001389 8CC2      	     2M 	mov %es,%dx
                      	     3M 
04:0000138B 26C7053412	     4M 	movw $0x1234,%es:(%di)
04:00001390 26C74502CD	     5M 	movw $0xabcd,%es:2(%di)
04:00001395 AB
04:00001396 260FB21D  	     6M 	lss %es:(%di),%bx
04:0000139A 8CD0      	     7M 	mov %ss,%ax
04:0000139C 3DCDAB    	     8M 	cmp $0xabcd,%ax
04:0000139F 0F859C04  	     9M 	jne error
04:000013A3 81FB3412  	    10M 	cmp $0x1234,%bx
04:000013A7 0F859404  	    11M 	jne error
                      	    12M 
04:000013AB 8EC2      	    13M 	mov %dx,%es
                      	    14M 
04:000013AD 6626C70578	    15M 	movl $0x12345678,%es:(%di)
04:000013B2 563412
04:000013B5 26C74504DE	    16M 	movw $0xbcde,%es:4(%di)
04:000013BA BC
04:000013BB 66260FB21D	    17M 	lss %es:(%di),%ebx
04:000013C0 8CD0      	    18M 	mov %ss,%ax
04:000013C2 3DDEBC    	    19M 	cmp $0xbcde,%ax
04:000013C5 0F857604  	    20M 	jne error
04:000013C9 6681FB7856	    21M 	cmp $0x12345678,%ebx
04:000013CE 3412
04:000013D0 0F856B04  	    22M 	jne error
                      	    23M 
04:000013D4 8EC2      	    24M 	mov %dx,%es
04:000013D6 8ED1      	    25M 	mov %cx,%ss
                      	   274: 	testLoadPtr ds
04:000013D8 8CD9      	     1M 	mov %ds,%cx
04:000013DA 8CC2      	     2M 	mov %es,%dx
                      	     3M 
04:000013DC 26C7053412	     4M 	movw $0x1234,%es:(%di)
04:000013E1 26C74502CD	     5M 	movw $0xabcd,%es:2(%di)
04:000013E6 AB
04:000013E7 26C51D    	     6M 	lds %es:(%di),%bx
04:000013EA 8CD8      	     7M 	mov %ds,%ax
04:000013EC 3DCDAB    	     8M 	cmp $0xabcd,%ax
04:000013EF 0F854C04  	     9M 	jne error
04:000013F3 81FB3412  	    10M 	cmp $0x1234,%bx
04:000013F7 0F854404  	    11M 	jne error
                      	    12M 
04:000013FB 8EC2      	    13M 	mov %dx,%es
                      	    14M 
04:000013FD 6626C70578	    15M 	movl $0x12345678,%es:(%di)
04:00001402 563412
04:00001405 26C74504DE	    16M 	movw $0xbcde,%es:4(%di)
04:0000140A BC
04:0000140B 6626C51D  	    17M 	lds %es:(%di),%ebx
04:0000140F 8CD8      	    18M 	mov %ds,%ax
04:00001411 3DDEBC    	    19M 	cmp $0xbcde,%ax
04:00001414 0F852704  	    20M 	jne error
04:00001418 6681FB7856	    21M 	cmp $0x12345678,%ebx
04:0000141D 3412
04:0000141F 0F851C04  	    22M 	jne error
                      	    23M 
04:00001423 8EC2      	    24M 	mov %dx,%es
04:00001425 8ED9      	    25M 	mov %cx,%ds
                      	   275: 	testLoadPtr es
04:00001427 8CC1      	     1M 	mov %es,%cx
04:00001429 8CC2      	     2M 	mov %es,%dx
                      	     3M 
04:0000142B 26C7053412	     4M 	movw $0x1234,%es:(%di)
04:00001430 26C74502CD	     5M 	movw $0xabcd,%es:2(%di)
04:00001435 AB
04:00001436 26C41D    	     6M 	les %es:(%di),%bx
04:00001439 8CC0      	     7M 	mov %es,%ax
04:0000143B 3DCDAB    	     8M 	cmp $0xabcd,%ax
04:0000143E 0F85FD03  	     9M 	jne error
04:00001442 81FB3412  	    10M 	cmp $0x1234,%bx
04:00001446 0F85F503  	    11M 	jne error
                      	    12M 
04:0000144A 8EC2      	    13M 	mov %dx,%es
                      	    14M 
04:0000144C 6626C70578	    15M 	movl $0x12345678,%es:(%di)
04:00001451 563412
04:00001454 26C74504DE	    16M 	movw $0xbcde,%es:4(%di)
04:00001459 BC
04:0000145A 6626C41D  	    17M 	les %es:(%di),%ebx
04:0000145E 8CC0      	    18M 	mov %es,%ax
04:00001460 3DDEBC    	    19M 	cmp $0xbcde,%ax
04:00001463 0F85D803  	    20M 	jne error
04:00001467 6681FB7856	    21M 	cmp $0x12345678,%ebx
04:0000146C 3412
04:0000146E 0F85CD03  	    22M 	jne error
                      	    23M 
04:00001472 8EC2      	    24M 	mov %dx,%es
04:00001474 8EC1      	    25M 	mov %cx,%es
                      	   276: 	testLoadPtr fs
04:00001476 8CE1      	     1M 	mov %fs,%cx
04:00001478 8CC2      	     2M 	mov %es,%dx
                      	     3M 
04:0000147A 26C7053412	     4M 	movw $0x1234,%es:(%di)
04:0000147F 26C74502CD	     5M 	movw $0xabcd,%es:2(%di)
04:00001484 AB
04:00001485 260FB41D  	     6M 	lfs %es:(%di),%bx
04:00001489 8CE0      	     7M 	mov %fs,%ax
04:0000148B 3DCDAB    	     8M 	cmp $0xabcd,%ax
04:0000148E 0F85AD03  	     9M 	jne error
04:00001492 81FB3412  	    10M 	cmp $0x1234,%bx
04:00001496 0F85A503  	    11M 	jne error
                      	    12M 
04:0000149A 8EC2      	    13M 	mov %dx,%es
                      	    14M 
04:0000149C 6626C70578	    15M 	movl $0x12345678,%es:(%di)
04:000014A1 563412
04:000014A4 26C74504DE	    16M 	movw $0xbcde,%es:4(%di)
04:000014A9 BC
04:000014AA 66260FB41D	    17M 	lfs %es:(%di),%ebx
04:000014AF 8CE0      	    18M 	mov %fs,%ax
04:000014B1 3DDEBC    	    19M 	cmp $0xbcde,%ax
04:000014B4 0F858703  	    20M 	jne error
04:000014B8 6681FB7856	    21M 	cmp $0x12345678,%ebx
04:000014BD 3412
04:000014BF 0F857C03  	    22M 	jne error
                      	    23M 
04:000014C3 8EC2      	    24M 	mov %dx,%es
04:000014C5 8EE1      	    25M 	mov %cx,%fs
                      	   277: 	testLoadPtr gs
04:000014C7 8CE9      	     1M 	mov %gs,%cx
04:000014C9 8CC2      	     2M 	mov %es,%dx
                      	     3M 
04:000014CB 26C7053412	     4M 	movw $0x1234,%es:(%di)
04:000014D0 26C74502CD	     5M 	movw $0xabcd,%es:2(%di)
04:000014D5 AB
04:000014D6 260FB51D  	     6M 	lgs %es:(%di),%bx
04:000014DA 8CE8      	     7M 	mov %gs,%ax
04:000014DC 3DCDAB    	     8M 	cmp $0xabcd,%ax
04:000014DF 0F855C03  	     9M 	jne error
04:000014E3 81FB3412  	    10M 	cmp $0x1234,%bx
04:000014E7 0F855403  	    11M 	jne error
                      	    12M 
04:000014EB 8EC2      	    13M 	mov %dx,%es
                      	    14M 
04:000014ED 6626C70578	    15M 	movl $0x12345678,%es:(%di)
04:000014F2 563412
04:000014F5 26C74504DE	    16M 	movw $0xbcde,%es:4(%di)
04:000014FA BC
04:000014FB 66260FB51D	    17M 	lgs %es:(%di),%ebx
04:00001500 8CE8      	    18M 	mov %gs,%ax
04:00001502 3DDEBC    	    19M 	cmp $0xbcde,%ax
04:00001505 0F853603  	    20M 	jne error
04:00001509 6681FB7856	    21M 	cmp $0x12345678,%ebx
04:0000150E 3412
04:00001510 0F852B03  	    22M 	jne error
                      	    23M 
04:00001514 8EC2      	    24M 	mov %dx,%es
04:00001516 8EE9      	    25M 	mov %cx,%gs
                      	   278: 
                      	   279: 	advTestSegReal
                      	     1M 	advTestBase
                      	     1M 	.set TEST_BASE1,TEST_BASE1+0x1000
                      	     2M 	.set TEST_BASE2,TEST_BASE2+0x1000
                      	     2M 	.set D1_SEG_REAL,TEST_BASE1 >> 4
                      	     3M 	.set D2_SEG_REAL,TEST_BASE2 >> 4
04:00001518 C7C200C4  	     4M 	mov $D1_SEG_REAL,%dx
04:0000151C 8EDA      	     5M 	mov %dx,%ds
04:0000151E C7C200C6  	     6M 	mov $D2_SEG_REAL,%dx
04:00001522 8EC2      	     7M 	mov %dx,%es
                      	   280: 
                      	   281: .include "lea_m.asm"

Source: "lea_m.asm"
                      	     1: #
                      	     2: #   Execs LEA op with 16-bit addressing and compares the result with given value
                      	     3: #   %1 address to calculate
                      	     4: #   %2 value to compare
                      	     5: #   Uses: flags.
                      	     6: #
                      	     7: .macro testLEA16 arg1,arg2
                      	     8: 	push %ax
                      	     9: 	lea \arg1,%ax
                      	    10: 	cmp \arg2,%ax
                      	    11: 	jne error
                      	    12: 	pop %ax
                      	    13: .endm
                      	    14: 
                      	    15: #
                      	    16: #   Execs LEA op with 32-bit addressing and compares the result with given value
                      	    17: #   %1 address to calculate
                      	    18: #   %2 value to compare
                      	    19: #   Uses: flags.
                      	    20: #
                      	    21: .macro testLEA32 arg1,arg2
                      	    22: 	push %eax
                      	    23: 	lea \arg1,%eax
                      	    24: 	cmp \arg2,%eax
                      	    25: 	jne error
                      	    26: 	pop %eax
                      	    27: .endm
                      	    28: 

Source: "t386.asm"
                      	   282: #.include "lea_p.asm"
                      	   283: postD:
                      	   284: 
                      	   285: #-------------------------------------------------------------------------------
                      	   286: 	POST $0x0D
04:00001524 B00D      	     1M 	movb $0x0D,%al
04:00001526 BA9001    	     2M 	movw $POST_PORT,%dx
04:00001529 EE        	     3M 	out %al,%dx
                      	   287: #-------------------------------------------------------------------------------
                      	   288: #
                      	   289: #   16-bit addressing modes (LEA)
                      	   290: #
04:0000152A B80100    	   291: 	mov $1,%ax
04:0000152D BB0200    	   292: 	mov $2,%bx
04:00001530 B90400    	   293: 	mov $4,%cx
04:00001533 BA0800    	   294: 	mov $8,%dx
04:00001536 BE1000    	   295: 	mov $0x10,%si
04:00001539 BF2000    	   296: 	mov $0x20,%di
                      	   297: 	testLEA16 0x4000, $0x4000
04:0000153C 50        	     1M 	push %ax
04:0000153D 8D060040  	     2M 	lea 0x4000,%ax
04:00001541 3D0040    	     3M 	cmp $0x4000,%ax
04:00001544 0F85F702  	     4M 	jne error
04:00001548 58        	     5M 	pop %ax
                      	   298: 	testLEA16 (%bx), $0x0002
04:00001549 50        	     1M 	push %ax
04:0000154A 8D07      	     2M 	lea (%bx),%ax
04:0000154C 83F802    	     3M 	cmp $0x0002,%ax
04:0000154F 0F85EC02  	     4M 	jne error
04:00001553 58        	     5M 	pop %ax
                      	   299: 	testLEA16 (%si), $0x0010
04:00001554 50        	     1M 	push %ax
04:00001555 8D04      	     2M 	lea (%si),%ax
04:00001557 83F810    	     3M 	cmp $0x0010,%ax
04:0000155A 0F85E102  	     4M 	jne error
04:0000155E 58        	     5M 	pop %ax
                      	   300: 	testLEA16 (%di), $0x0020
04:0000155F 50        	     1M 	push %ax
04:00001560 8D05      	     2M 	lea (%di),%ax
04:00001562 83F820    	     3M 	cmp $0x0020,%ax
04:00001565 0F85D602  	     4M 	jne error
04:00001569 58        	     5M 	pop %ax
                      	   301: 	testLEA16 0x40(%bx), $0x0042
04:0000156A 50        	     1M 	push %ax
04:0000156B 8D4740    	     2M 	lea 0x40(%bx),%ax
04:0000156E 83F842    	     3M 	cmp $0x0042,%ax
04:00001571 0F85CA02  	     4M 	jne error
04:00001575 58        	     5M 	pop %ax
                      	   302: 	testLEA16 0x40(%si), $0x0050
04:00001576 50        	     1M 	push %ax
04:00001577 8D4440    	     2M 	lea 0x40(%si),%ax
04:0000157A 83F850    	     3M 	cmp $0x0050,%ax
04:0000157D 0F85BE02  	     4M 	jne error
04:00001581 58        	     5M 	pop %ax
                      	   303: 	testLEA16 0x40(%di), $0x0060
04:00001582 50        	     1M 	push %ax
04:00001583 8D4540    	     2M 	lea 0x40(%di),%ax
04:00001586 83F860    	     3M 	cmp $0x0060,%ax
04:00001589 0F85B202  	     4M 	jne error
04:0000158D 58        	     5M 	pop %ax
                      	   304: 	testLEA16 0x4000(%bx), $0x4002
04:0000158E 50        	     1M 	push %ax
04:0000158F 8D870040  	     2M 	lea 0x4000(%bx),%ax
04:00001593 3D0240    	     3M 	cmp $0x4002,%ax
04:00001596 0F85A502  	     4M 	jne error
04:0000159A 58        	     5M 	pop %ax
                      	   305: 	testLEA16 0x4000(%si), $0x4010
04:0000159B 50        	     1M 	push %ax
04:0000159C 8D840040  	     2M 	lea 0x4000(%si),%ax
04:000015A0 3D1040    	     3M 	cmp $0x4010,%ax
04:000015A3 0F859802  	     4M 	jne error
04:000015A7 58        	     5M 	pop %ax
                      	   306: 	testLEA16 (%bx,%si), $0x0012
04:000015A8 50        	     1M 	push %ax
04:000015A9 8D00      	     2M 	lea (%bx,%si),%ax
04:000015AB 83F812    	     3M 	cmp $0x0012,%ax
04:000015AE 0F858D02  	     4M 	jne error
04:000015B2 58        	     5M 	pop %ax
                      	   307: 	testLEA16 (%bx,%di), $0x0022
04:000015B3 50        	     1M 	push %ax
04:000015B4 8D01      	     2M 	lea (%bx,%di),%ax
04:000015B6 83F822    	     3M 	cmp $0x0022,%ax
04:000015B9 0F858202  	     4M 	jne error
04:000015BD 58        	     5M 	pop %ax
                      	   308: 	testLEA16 0x40(%bx,%si), $0x0052
04:000015BE 50        	     1M 	push %ax
04:000015BF 8D4040    	     2M 	lea 0x40(%bx,%si),%ax
04:000015C2 83F852    	     3M 	cmp $0x0052,%ax
04:000015C5 0F857602  	     4M 	jne error
04:000015C9 58        	     5M 	pop %ax
                      	   309: 	testLEA16 0x40(%bx,%di), $0x0062
04:000015CA 50        	     1M 	push %ax
04:000015CB 8D4140    	     2M 	lea 0x40(%bx,%di),%ax
04:000015CE 83F862    	     3M 	cmp $0x0062,%ax
04:000015D1 0F856A02  	     4M 	jne error
04:000015D5 58        	     5M 	pop %ax
                      	   310: 	testLEA16 0x4000(%bx,%si), $0x4012
04:000015D6 50        	     1M 	push %ax
04:000015D7 8D800040  	     2M 	lea 0x4000(%bx,%si),%ax
04:000015DB 3D1240    	     3M 	cmp $0x4012,%ax
04:000015DE 0F855D02  	     4M 	jne error
04:000015E2 58        	     5M 	pop %ax
                      	   311: 	testLEA16 0x4000(%bx,%di), $0x4022
04:000015E3 50        	     1M 	push %ax
04:000015E4 8D810040  	     2M 	lea 0x4000(%bx,%di),%ax
04:000015E8 3D2240    	     3M 	cmp $0x4022,%ax
04:000015EB 0F855002  	     4M 	jne error
04:000015EF 58        	     5M 	pop %ax
                      	   312: 
                      	   313: 
                      	   314: #-------------------------------------------------------------------------------
                      	   315: 	POST $0xE0
04:000015F0 B0E0      	     1M 	movb $0xE0,%al
04:000015F2 BA9001    	     2M 	movw $POST_PORT,%dx
04:000015F5 EE        	     3M 	out %al,%dx
                      	   316: #-------------------------------------------------------------------------------
                      	   317: 
                      	   318: .shifts386FlagsTest:
                      	   319: 
                      	   320: 	# SHR al,cl - SHR ax,cl
                      	   321: 	# undefined flags:
                      	   322: 	#  CF when cl>7 (byte) or cl>15 (word):
                      	   323: 	#    if byte operand and cl=8 or cl=16 or cl=24 then CF=MSB(operand)
                      	   324: 	#    if word operand and cl=16 then CF=MSB(operand)
                      	   325: 	#  OF when cl>1: set according to result   *** rf386 calc's overflow cl>1
                      	   326: 	#  AF when cl>0: always 1
                      	   327: 	# shift count is modulo 32 so if cl=32 then result is equal to cl=0
                      	   328: 
                      	   329: 	testShiftBFlags shrb, $0x81, $1, $0, $(PS_CF|PS_AF|PS_OF)
04:000015F6 B80000    	     1M 	mov $0,%ax
04:000015F9 50        	     2M 	push %ax
04:000015FA 9D        	     3M 	popf
04:000015FB B4FF      	     4M 	mov $0xff,%ah
04:000015FD B081      	     5M 	mov $0x81,%al
04:000015FF B101      	     6M 	mov $1,%cl
04:00001601 D2E8      	     7M 	shrb %cl,%al
04:00001603 9C        	     8M 	pushf
04:00001604 58        	     9M 	pop %ax
04:00001605 25D508    	    10M 	and $PS_ARITH,%ax
04:00001608 3D1108    	    11M 	cmp $(PS_CF|PS_AF|PS_OF),%ax
04:0000160B 0F853002  	    12M 	jne error
                      	   330: 	testShiftBFlags shrb, $0x82, $2, $0, $(PS_CF|PS_AF|PS_OF)
04:0000160F B80000    	     1M 	mov $0,%ax
04:00001612 50        	     2M 	push %ax
04:00001613 9D        	     3M 	popf
04:00001614 B4FF      	     4M 	mov $0xff,%ah
04:00001616 B082      	     5M 	mov $0x82,%al
04:00001618 B102      	     6M 	mov $2,%cl
04:0000161A D2E8      	     7M 	shrb %cl,%al
04:0000161C 9C        	     8M 	pushf
04:0000161D 58        	     9M 	pop %ax
04:0000161E 25D508    	    10M 	and $PS_ARITH,%ax
04:00001621 3D1108    	    11M 	cmp $(PS_CF|PS_AF|PS_OF),%ax
04:00001624 0F851702  	    12M 	jne error
                      	   331: 	testShiftBFlags shrb, $0x80, $8, $0, $(PS_CF|PS_PF|PS_AF|PS_ZF|PS_OF)
04:00001628 B80000    	     1M 	mov $0,%ax
04:0000162B 50        	     2M 	push %ax
04:0000162C 9D        	     3M 	popf
04:0000162D B4FF      	     4M 	mov $0xff,%ah
04:0000162F B080      	     5M 	mov $0x80,%al
04:00001631 B108      	     6M 	mov $8,%cl
04:00001633 D2E8      	     7M 	shrb %cl,%al
04:00001635 9C        	     8M 	pushf
04:00001636 58        	     9M 	pop %ax
04:00001637 25D508    	    10M 	and $PS_ARITH,%ax
04:0000163A 3D5508    	    11M 	cmp $(PS_CF|PS_PF|PS_AF|PS_ZF|PS_OF),%ax
04:0000163D 0F85FE01  	    12M 	jne error
                      	   332: 	testShiftBFlags shrb, $0x00,   $8,  $PS_CF, $(PS_PF|PS_ZF)
04:00001641 B80100    	     1M 	mov $PS_CF,%ax
04:00001644 50        	     2M 	push %ax
04:00001645 9D        	     3M 	popf
04:00001646 B4FF      	     4M 	mov $0xff,%ah
04:00001648 B000      	     5M 	mov $0x00,%al
04:0000164A B108      	     6M 	mov $8,%cl
04:0000164C D2E8      	     7M 	shrb %cl,%al
04:0000164E 9C        	     8M 	pushf
04:0000164F 58        	     9M 	pop %ax
04:00001650 25D508    	    10M 	and $PS_ARITH,%ax
04:00001653 83F844    	    11M 	cmp $(PS_PF|PS_ZF),%ax
04:00001656 0F85E501  	    12M 	jne error
                      	   333: 	testShiftBFlags shrb, $0x80,   $16, $0,     $(PS_PF|PS_ZF|PS_OF)
04:0000165A B80000    	     1M 	mov $0,%ax
04:0000165D 50        	     2M 	push %ax
04:0000165E 9D        	     3M 	popf
04:0000165F B4FF      	     4M 	mov $0xff,%ah
04:00001661 B080      	     5M 	mov $0x80,%al
04:00001663 B110      	     6M 	mov $16,%cl
04:00001665 D2E8      	     7M 	shrb %cl,%al
04:00001667 9C        	     8M 	pushf
04:00001668 58        	     9M 	pop %ax
04:00001669 25D508    	    10M 	and $PS_ARITH,%ax
04:0000166C 3D4408    	    11M 	cmp $(PS_PF|PS_ZF|PS_OF),%ax
04:0000166F 0F85CC01  	    12M 	jne error
                      	   334: 	testShiftBFlags shrb, $0x00,   $16, $PS_CF, $(PS_PF|PS_ZF)
04:00001673 B80100    	     1M 	mov $PS_CF,%ax
04:00001676 50        	     2M 	push %ax
04:00001677 9D        	     3M 	popf
04:00001678 B4FF      	     4M 	mov $0xff,%ah
04:0000167A B000      	     5M 	mov $0x00,%al
04:0000167C B110      	     6M 	mov $16,%cl
04:0000167E D2E8      	     7M 	shrb %cl,%al
04:00001680 9C        	     8M 	pushf
04:00001681 58        	     9M 	pop %ax
04:00001682 25D508    	    10M 	and $PS_ARITH,%ax
04:00001685 83F844    	    11M 	cmp $(PS_PF|PS_ZF),%ax
04:00001688 0F85B301  	    12M 	jne error
                      	   335: 	testShiftBFlags shrb, $0x80,   $24, $0,     $(PS_PF|PS_ZF|PS_OF)
04:0000168C B80000    	     1M 	mov $0,%ax
04:0000168F 50        	     2M 	push %ax
04:00001690 9D        	     3M 	popf
04:00001691 B4FF      	     4M 	mov $0xff,%ah
04:00001693 B080      	     5M 	mov $0x80,%al
04:00001695 B118      	     6M 	mov $24,%cl
04:00001697 D2E8      	     7M 	shrb %cl,%al
04:00001699 9C        	     8M 	pushf
04:0000169A 58        	     9M 	pop %ax
04:0000169B 25D508    	    10M 	and $PS_ARITH,%ax
04:0000169E 3D4408    	    11M 	cmp $(PS_PF|PS_ZF|PS_OF),%ax
04:000016A1 0F859A01  	    12M 	jne error
                      	   336: 	testShiftBFlags shrb, $0x00,   $24, $PS_CF, $(PS_PF|PS_ZF)
04:000016A5 B80100    	     1M 	mov $PS_CF,%ax
04:000016A8 50        	     2M 	push %ax
04:000016A9 9D        	     3M 	popf
04:000016AA B4FF      	     4M 	mov $0xff,%ah
04:000016AC B000      	     5M 	mov $0x00,%al
04:000016AE B118      	     6M 	mov $24,%cl
04:000016B0 D2E8      	     7M 	shrb %cl,%al
04:000016B2 9C        	     8M 	pushf
04:000016B3 58        	     9M 	pop %ax
04:000016B4 25D508    	    10M 	and $PS_ARITH,%ax
04:000016B7 83F844    	    11M 	cmp $(PS_PF|PS_ZF),%ax
04:000016BA 0F858101  	    12M 	jne error
                      	   337: 	testShiftBFlags shrb, $0x80,   $32, $0,     $PS_SF
04:000016BE B80000    	     1M 	mov $0,%ax
04:000016C1 50        	     2M 	push %ax
04:000016C2 9D        	     3M 	popf
04:000016C3 B4FF      	     4M 	mov $0xff,%ah
04:000016C5 B080      	     5M 	mov $0x80,%al
04:000016C7 B120      	     6M 	mov $32,%cl
04:000016C9 D2E8      	     7M 	shrb %cl,%al
04:000016CB 9C        	     8M 	pushf
04:000016CC 58        	     9M 	pop %ax
04:000016CD 25D508    	    10M 	and $PS_ARITH,%ax
04:000016D0 3D8000    	    11M 	cmp $PS_SF,%ax
04:000016D3 0F856801  	    12M 	jne error
                      	   338: 	testShiftWFlags shrw, $0x8000, $16, $0,     $(PS_CF|PS_PF|PS_AF|PS_ZF|PS_OF)
04:000016D7 B80000    	     1M 	mov $0,%ax
04:000016DA 50        	     2M 	push %ax
04:000016DB 9D        	     3M 	popf
04:000016DC B80080    	     4M 	mov $0x8000,%ax
04:000016DF B110      	     5M 	mov $16,%cl
04:000016E1 D3E8      	     6M 	shrw %cl,%ax
04:000016E3 9C        	     7M 	pushf
04:000016E4 58        	     8M 	pop %ax
04:000016E5 25D508    	     9M 	and $PS_ARITH,%ax
04:000016E8 3D5508    	    10M 	cmp $(PS_CF|PS_PF|PS_AF|PS_ZF|PS_OF),%ax
04:000016EB 0F855001  	    11M 	jne error
                      	   339: 	testShiftWFlags shrw, $0x0000, $16, $PS_CF, $(PS_PF|PS_ZF)
04:000016EF B80100    	     1M 	mov $PS_CF,%ax
04:000016F2 50        	     2M 	push %ax
04:000016F3 9D        	     3M 	popf
04:000016F4 B80000    	     4M 	mov $0x0000,%ax
04:000016F7 B110      	     5M 	mov $16,%cl
04:000016F9 D3E8      	     6M 	shrw %cl,%ax
04:000016FB 9C        	     7M 	pushf
04:000016FC 58        	     8M 	pop %ax
04:000016FD 25D508    	     9M 	and $PS_ARITH,%ax
04:00001700 83F844    	    10M 	cmp $(PS_PF|PS_ZF),%ax
04:00001703 0F853801  	    11M 	jne error
                      	   340: 	testShiftWFlags shrw, $0x8000, $32, $0,     $PS_SF|PS_PF
04:00001707 B80000    	     1M 	mov $0,%ax
04:0000170A 50        	     2M 	push %ax
04:0000170B 9D        	     3M 	popf
04:0000170C B80080    	     4M 	mov $0x8000,%ax
04:0000170F B120      	     5M 	mov $32,%cl
04:00001711 D3E8      	     6M 	shrw %cl,%ax
04:00001713 9C        	     7M 	pushf
04:00001714 58        	     8M 	pop %ax
04:00001715 25D508    	     9M 	and $PS_ARITH,%ax
04:00001718 3D8400    	    10M 	cmp $PS_SF|PS_PF,%ax
04:0000171B 0F852001  	    11M 	jne error
                      	   341: 
                      	   342: 	# SHL al,cl - SHL ax,cl
                      	   343: 	# undefined flags:
                      	   344: 	#  CF when cl>7 (byte) or cl>15 (word):
                      	   345: 	#    if byte operand and cl=8 or cl=16 or cl=24 then CF=LSB(operand)
                      	   346: 	#    if word operand and cl=16 then CF=LSB(operand)
                      	   347: 	#  OF when cl>1: set according to result
                      	   348: 	#  AF when cl>0: always 1
                      	   349: 	# shift count is modulo 32 so if cl=32 then result is equal to cl=0
                      	   350: 
                      	   351: 	testShiftBFlags shlb, $0x81, $1,  $0,     $(PS_CF|PS_OF)
04:0000171F B80000    	     1M 	mov $0,%ax
04:00001722 50        	     2M 	push %ax
04:00001723 9D        	     3M 	popf
04:00001724 B4FF      	     4M 	mov $0xff,%ah
04:00001726 B081      	     5M 	mov $0x81,%al
04:00001728 B101      	     6M 	mov $1,%cl
04:0000172A D2E0      	     7M 	shlb %cl,%al
04:0000172C 9C        	     8M 	pushf
04:0000172D 58        	     9M 	pop %ax
04:0000172E 25D508    	    10M 	and $PS_ARITH,%ax
04:00001731 3D0108    	    11M 	cmp $(PS_CF|PS_OF),%ax
04:00001734 0F850701  	    12M 	jne error
                      	   352: 	testShiftBFlags shlb, $0x41, $2,  $0,     $(PS_CF|PS_OF)
04:00001738 B80000    	     1M 	mov $0,%ax
04:0000173B 50        	     2M 	push %ax
04:0000173C 9D        	     3M 	popf
04:0000173D B4FF      	     4M 	mov $0xff,%ah
04:0000173F B041      	     5M 	mov $0x41,%al
04:00001741 B102      	     6M 	mov $2,%cl
04:00001743 D2E0      	     7M 	shlb %cl,%al
04:00001745 9C        	     8M 	pushf
04:00001746 58        	     9M 	pop %ax
04:00001747 25D508    	    10M 	and $PS_ARITH,%ax
04:0000174A 3D0108    	    11M 	cmp $(PS_CF|PS_OF),%ax
04:0000174D 0F85EE00  	    12M 	jne error
                      	   353: 	testShiftBFlags shlb, $0x01, $8,  $0,     $(PS_CF|PS_PF|PS_ZF|PS_OF)
04:00001751 B80000    	     1M 	mov $0,%ax
04:00001754 50        	     2M 	push %ax
04:00001755 9D        	     3M 	popf
04:00001756 B4FF      	     4M 	mov $0xff,%ah
04:00001758 B001      	     5M 	mov $0x01,%al
04:0000175A B108      	     6M 	mov $8,%cl
04:0000175C D2E0      	     7M 	shlb %cl,%al
04:0000175E 9C        	     8M 	pushf
04:0000175F 58        	     9M 	pop %ax
04:00001760 25D508    	    10M 	and $PS_ARITH,%ax
04:00001763 3D4508    	    11M 	cmp $(PS_CF|PS_PF|PS_ZF|PS_OF),%ax
04:00001766 0F85D500  	    12M 	jne error
                      	   354: 	testShiftBFlags shlb, $0x00, $8,  $PS_CF, $(PS_PF|PS_ZF)
04:0000176A B80100    	     1M 	mov $PS_CF,%ax
04:0000176D 50        	     2M 	push %ax
04:0000176E 9D        	     3M 	popf
04:0000176F B4FF      	     4M 	mov $0xff,%ah
04:00001771 B000      	     5M 	mov $0x00,%al
04:00001773 B108      	     6M 	mov $8,%cl
04:00001775 D2E0      	     7M 	shlb %cl,%al
04:00001777 9C        	     8M 	pushf
04:00001778 58        	     9M 	pop %ax
04:00001779 25D508    	    10M 	and $PS_ARITH,%ax
04:0000177C 83F844    	    11M 	cmp $(PS_PF|PS_ZF),%ax
04:0000177F 0F85BC00  	    12M 	jne error
                      	   355: 	testShiftBFlags shlb, $0x01, $16, $0,     $(PS_CF|PS_PF|PS_ZF|PS_OF)
04:00001783 B80000    	     1M 	mov $0,%ax
04:00001786 50        	     2M 	push %ax
04:00001787 9D        	     3M 	popf
04:00001788 B4FF      	     4M 	mov $0xff,%ah
04:0000178A B001      	     5M 	mov $0x01,%al
04:0000178C B110      	     6M 	mov $16,%cl
04:0000178E D2E0      	     7M 	shlb %cl,%al
04:00001790 9C        	     8M 	pushf
04:00001791 58        	     9M 	pop %ax
04:00001792 25D508    	    10M 	and $PS_ARITH,%ax
04:00001795 3D4508    	    11M 	cmp $(PS_CF|PS_PF|PS_ZF|PS_OF),%ax
04:00001798 0F85A300  	    12M 	jne error
                      	   356: 	testShiftBFlags shlb, $0x00, $16, $PS_CF, $(PS_PF|PS_ZF)
04:0000179C B80100    	     1M 	mov $PS_CF,%ax
04:0000179F 50        	     2M 	push %ax
04:000017A0 9D        	     3M 	popf
04:000017A1 B4FF      	     4M 	mov $0xff,%ah
04:000017A3 B000      	     5M 	mov $0x00,%al
04:000017A5 B110      	     6M 	mov $16,%cl
04:000017A7 D2E0      	     7M 	shlb %cl,%al
04:000017A9 9C        	     8M 	pushf
04:000017AA 58        	     9M 	pop %ax
04:000017AB 25D508    	    10M 	and $PS_ARITH,%ax
04:000017AE 83F844    	    11M 	cmp $(PS_PF|PS_ZF),%ax
04:000017B1 0F858A00  	    12M 	jne error
                      	   357: 	testShiftBFlags shlb, $0x01, $24, $0,     $(PS_CF|PS_PF|PS_ZF|PS_OF)
04:000017B5 B80000    	     1M 	mov $0,%ax
04:000017B8 50        	     2M 	push %ax
04:000017B9 9D        	     3M 	popf
04:000017BA B4FF      	     4M 	mov $0xff,%ah
04:000017BC B001      	     5M 	mov $0x01,%al
04:000017BE B118      	     6M 	mov $24,%cl
04:000017C0 D2E0      	     7M 	shlb %cl,%al
04:000017C2 9C        	     8M 	pushf
04:000017C3 58        	     9M 	pop %ax
04:000017C4 25D508    	    10M 	and $PS_ARITH,%ax
04:000017C7 3D4508    	    11M 	cmp $(PS_CF|PS_PF|PS_ZF|PS_OF),%ax
04:000017CA 7573      	    12M 	jne error
                      	   358: 	testShiftBFlags shlb, $0x00, $24, $PS_CF, $(PS_PF|PS_ZF)
04:000017CC B80100    	     1M 	mov $PS_CF,%ax
04:000017CF 50        	     2M 	push %ax
04:000017D0 9D        	     3M 	popf
04:000017D1 B4FF      	     4M 	mov $0xff,%ah
04:000017D3 B000      	     5M 	mov $0x00,%al
04:000017D5 B118      	     6M 	mov $24,%cl
04:000017D7 D2E0      	     7M 	shlb %cl,%al
04:000017D9 9C        	     8M 	pushf
04:000017DA 58        	     9M 	pop %ax
04:000017DB 25D508    	    10M 	and $PS_ARITH,%ax
04:000017DE 83F844    	    11M 	cmp $(PS_PF|PS_ZF),%ax
04:000017E1 755C      	    12M 	jne error
                      	   359: 	testShiftBFlags shlb, $0x01, $32, $0,     $0
04:000017E3 B80000    	     1M 	mov $0,%ax
04:000017E6 50        	     2M 	push %ax
04:000017E7 9D        	     3M 	popf
04:000017E8 B4FF      	     4M 	mov $0xff,%ah
04:000017EA B001      	     5M 	mov $0x01,%al
04:000017EC B120      	     6M 	mov $32,%cl
04:000017EE D2E0      	     7M 	shlb %cl,%al
04:000017F0 9C        	     8M 	pushf
04:000017F1 58        	     9M 	pop %ax
04:000017F2 25D508    	    10M 	and $PS_ARITH,%ax
04:000017F5 83F800    	    11M 	cmp $0,%ax
04:000017F8 7545      	    12M 	jne error
                      	   360: 	testShiftWFlags shlw, $0x01, $16, $0,     $(PS_CF|PS_PF|PS_ZF|PS_OF)
04:000017FA B80000    	     1M 	mov $0,%ax
04:000017FD 50        	     2M 	push %ax
04:000017FE 9D        	     3M 	popf
04:000017FF B80100    	     4M 	mov $0x01,%ax
04:00001802 B110      	     5M 	mov $16,%cl
04:00001804 D3E0      	     6M 	shlw %cl,%ax
04:00001806 9C        	     7M 	pushf
04:00001807 58        	     8M 	pop %ax
04:00001808 25D508    	     9M 	and $PS_ARITH,%ax
04:0000180B 3D4508    	    10M 	cmp $(PS_CF|PS_PF|PS_ZF|PS_OF),%ax
04:0000180E 752F      	    11M 	jne error
                      	   361: 	testShiftWFlags shlw, $0x00, $16, $PS_CF, $(PS_PF|PS_ZF)
04:00001810 B80100    	     1M 	mov $PS_CF,%ax
04:00001813 50        	     2M 	push %ax
04:00001814 9D        	     3M 	popf
04:00001815 B80000    	     4M 	mov $0x00,%ax
04:00001818 B110      	     5M 	mov $16,%cl
04:0000181A D3E0      	     6M 	shlw %cl,%ax
04:0000181C 9C        	     7M 	pushf
04:0000181D 58        	     8M 	pop %ax
04:0000181E 25D508    	     9M 	and $PS_ARITH,%ax
04:00001821 83F844    	    10M 	cmp $(PS_PF|PS_ZF),%ax
04:00001824 7519      	    11M 	jne error
                      	   362: 	testShiftWFlags shlw, $0x01, $32, $0,     $0
04:00001826 B80000    	     1M 	mov $0,%ax
04:00001829 50        	     2M 	push %ax
04:0000182A 9D        	     3M 	popf
04:0000182B B80100    	     4M 	mov $0x01,%ax
04:0000182E B120      	     5M 	mov $32,%cl
04:00001830 D3E0      	     6M 	shlw %cl,%ax
04:00001832 9C        	     7M 	pushf
04:00001833 58        	     8M 	pop %ax
04:00001834 25D508    	     9M 	and $PS_ARITH,%ax
04:00001837 83F800    	    10M 	cmp $0,%ax
04:0000183A 7503      	    11M 	jne error
                      	   363: 
04:0000183C E9FEFF    	   364: 	jmp _bootrom
                      	   365: 
                      	   366: #	pushl $10
                      	   367: #	call _Fibonacci
                      	   368: 
                      	   369: #
                      	   370: # Default exception handler and error routine
                      	   371: #
                      	   372: DefaultExcHandler:
                      	   373: error:
                      	   374: # CLI and HLT are privileged instructions, don't use them in ring3
04:0000183F 8CC8      	   375: 	mov %cs,%ax
                      	   376: 
                      	   377: # when in real mode, the jnz will be decoded together with test as
                      	   378: # "test eax,0xfe750007" (66A9070075FE)
04:00001841 A90700    	   379: 	test $7,%ax     # 66 A9 07 00
04:00001844 75FE      	   380: .ring3: jnz .ring3 # 75 FE
04:00001846 FA        	   381: 	cli
04:00001847 F4        	   382: 	hlt
04:00001848 EBF5      	   383: 	jmp error
                      	   384: 
                      	   385: 
                      	   386: .rept 16
                      	   387: 	nop
                      	   388: .endr
04:0000184A 90        	     1R 	nop
04:0000184B 90        	     1R 	nop
04:0000184C 90        	     1R 	nop
04:0000184D 90        	     1R 	nop
04:0000184E 90        	     1R 	nop
04:0000184F 90        	     1R 	nop
04:00001850 90        	     1R 	nop
04:00001851 90        	     1R 	nop
04:00001852 90        	     1R 	nop
04:00001853 90        	     1R 	nop
04:00001854 90        	     1R 	nop
04:00001855 90        	     1R 	nop
04:00001856 90        	     1R 	nop
04:00001857 90        	     1R 	nop
04:00001858 90        	     1R 	nop
04:00001859 90        	     1R 	nop
                      	   389: 	
                      	   390: #	.type	_start,@function
                      	   391: #	.size	_start,$-_start
                      	   392: 
                      	   393: #.include "Fibonacci.asm"
                      	   394: #.include "serial.asm"
                      	   395: #.include "xmodem.asm"
                      	   396: #.include "bootrom.asm"
                      	   397: 
                      	   398: .global _disable_int
                      	   399: .global _restore_int
                      	   400: .extern _start_data
                      	   401: .extern _start_rodata
                      	   402: .extern _start_bss
                      	   403: 


Symbols by name:
.ring3                          04:00001844
.shifts386FlagsTest             04:000015F6
C_SEG_REAL                       S:00000000
D1_SEG_REAL                      S:0FFFC400
D2_SEG_REAL                      S:0FFFC600
DefaultExcHandler               04:0000183F
ESP_REAL                         S:00007FFC
EXT_NONE                         S:00000000
EX_UD                            S:00000006
IDT_SEG_REAL                     S:00009000
POST_PORT                        S:00000190
PS_AF                            S:00000010
PS_ARITH                         S:000008D5
PS_CF                            S:00000001
PS_OF                            S:00000800
PS_PF                            S:00000004
PS_SF                            S:00000080
PS_ZF                            S:00000040
S_SEG_REAL                       S:0000C000
TEST_BASE                        S:FFFC0000
TEST_BASE1                       S:FFFC4000
TEST_BASE2                       S:FFFC6000
_Fibonacci                      external EXP
_bootrom                        external EXP
_disable_int                    external EXP
_restore_int                    external EXP
_start                          04:00000000
_start1                         04:0000005B
_start_bss                      external EXP
_start_data                     external EXP
_start_rodata                   external EXP
aloop7                          04:00000076
b                                S:00000000
bytes                            S:00000100
continue25                      04:0000054D
continue28                      04:000005C6
d                                S:00000002
err110                          04:000000C7
err111                          04:00000209
err210                          04:0000013C
err211                          04:00000394
error                           04:0000183F
exit10                          04:0000014B
exit11                          04:000003A9
exit52                          04:00001372
farfn1652                       04:00001315
farfn3252                       04:00001338
header                          04:00000002
idt_addr                        03:00000000
items                            S:00000040
ja10                            04:000000EE
ja11                            04:00000242
jaok10                          04:000000FE
jaok11                          04:000002DD
jcok10                          04:000000C8
jcok11                          04:0000020A
jcxz10                          04:00000120
jcxz11                          04:00000311
jcxzok10                        04:00000147
jecxz10                         04:00000130
jecxze10                        04:0000013A
jecxzok10                       04:00000149
jl10                            04:00000117
jl11                            04:00000304
jle10                           04:0000011D
jle11                           04:0000030C
jleok10                         04:00000145
jleok11                         04:000003A5
jlok10                          04:00000143
jlok11                          04:000003A1
jna10                           04:000000BE
jna11                           04:0000017B
jnaok10                         04:000000D0
jnaok11                         04:0000021A
jnc10                           04:000000D2
jnc11                           04:0000021E
jncok10                         04:000000F6
jncok11                         04:000002CD
jnl10                           04:0000010D
jnl11                           04:000002F2
jnle10                          04:00000112
jnle11                          04:000002FB
jnleok10                        04:00000141
jnleok11                        04:0000039D
jnlok10                         04:0000013F
jnlok11                         04:00000399
jnp10                           04:000000E2
jnp11                           04:00000232
jnpok10                         04:000000FA
jnpok11                         04:000002D5
jns10                           04:000000E8
jns11                           04:0000023A
jnsok10                         04:000000FC
jnsok11                         04:000002D9
jnz10                           04:000000DC
jnz11                           04:0000022A
jnzok10                         04:000000F8
jnzok11                         04:000002D1
jo10                            04:00000100
jo11                            04:000002E1
jook10                          04:0000013D
jook11                          04:00000395
jp10                            04:000000AE
jp11                            04:00000163
jpok10                          04:000000CC
jpok11                          04:00000212
js10                            04:000000B6
js11                            04:0000016F
jsok10                          04:000000CE
jsok11                          04:00000216
jz10                            04:000000A6
jz11                            04:00000157
jzok10                          04:000000CA
jzok11                          04:0000020E
m161652                         04:0000134B
m163252                         04:0000135D
nearfn1651                      04:000012BC
nearfn3251                      04:000012DA
next110                         04:000000C5
next111                         04:00000186
next210                         04:000000F4
next211                         04:0000024A
o3252                           04:00001328
off_cmp                          S:0001FFFF
off_mask                         S:0000FFFF
off_value                        S:000100FF
postD                           04:00001524
realmd_mask                      S:0000FFFF
rel1651                         04:000012B1
rel3251                         04:000012CE
rm1651                          04:000012EC
rm3251                          04:000012F7
rodata_seg                       S:0FFFA000
start_rodata                     S:FFFA0000
test25                          04:00000548
test28                          04:000005BF
val_mask                         S:FFFFFFFF
val_size                         S:00000004
value                            S:12345678
w                                S:00000001

Symbols by value:
FFFA0000 start_rodata
FFFC0000 TEST_BASE
FFFC4000 TEST_BASE1
FFFC6000 TEST_BASE2
FFFFFFFF val_mask
00000000 EXT_NONE
00000000 C_SEG_REAL
00000000 _start
00000000 b
00000000 idt_addr
00000001 PS_CF
00000001 w
00000002 header
00000002 d
00000004 PS_PF
00000004 val_size
00000006 EX_UD
00000010 PS_AF
00000040 items
00000040 PS_ZF
0000005B _start1
00000076 aloop7
00000080 PS_SF
000000A6 jz10
000000AE jp10
000000B6 js10
000000BE jna10
000000C5 next110
000000C7 err110
000000C8 jcok10
000000CA jzok10
000000CC jpok10
000000CE jsok10
000000D0 jnaok10
000000D2 jnc10
000000DC jnz10
000000E2 jnp10
000000E8 jns10
000000EE ja10
000000F4 next210
000000F6 jncok10
000000F8 jnzok10
000000FA jnpok10
000000FC jnsok10
000000FE jaok10
00000100 jo10
00000100 bytes
0000010D jnl10
00000112 jnle10
00000117 jl10
0000011D jle10
00000120 jcxz10
00000130 jecxz10
0000013A jecxze10
0000013C err210
0000013D jook10
0000013F jnlok10
00000141 jnleok10
00000143 jlok10
00000145 jleok10
00000147 jcxzok10
00000149 jecxzok10
0000014B exit10
00000157 jz11
00000163 jp11
0000016F js11
0000017B jna11
00000186 next111
00000190 POST_PORT
00000209 err111
0000020A jcok11
0000020E jzok11
00000212 jpok11
00000216 jsok11
0000021A jnaok11
0000021E jnc11
0000022A jnz11
00000232 jnp11
0000023A jns11
00000242 ja11
0000024A next211
000002CD jncok11
000002D1 jnzok11
000002D5 jnpok11
000002D9 jnsok11
000002DD jaok11
000002E1 jo11
000002F2 jnl11
000002FB jnle11
00000304 jl11
0000030C jle11
00000311 jcxz11
00000394 err211
00000395 jook11
00000399 jnlok11
0000039D jnleok11
000003A1 jlok11
000003A5 jleok11
000003A9 exit11
00000548 test25
0000054D continue25
000005BF test28
000005C6 continue28
00000800 PS_OF
000008D5 PS_ARITH
000012B1 rel1651
000012BC nearfn1651
000012CE rel3251
000012DA nearfn3251
000012EC rm1651
000012F7 rm3251
00001315 farfn1652
00001328 o3252
00001338 farfn3252
0000134B m161652
0000135D m163252
00001372 exit52
00001524 postD
000015F6 .shifts386FlagsTest
0000183F DefaultExcHandler
0000183F error
00001844 .ring3
00007FFC ESP_REAL
00009000 IDT_SEG_REAL
0000C000 S_SEG_REAL
0000FFFF realmd_mask
0000FFFF off_mask
000100FF off_value
0001FFFF off_cmp
0FFFA000 rodata_seg
0FFFC400 D1_SEG_REAL
0FFFC600 D2_SEG_REAL
12345678 value
